(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102755,       2710]
NotebookOptionsPosition[     98526,       2605]
NotebookOutlinePosition[     98891,       2621]
CellTagsIndexPosition[     98848,       2618]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "@", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6967799929645143`*^9, 3.6967800136887193`*^9}, {
  3.702990496169712*^9, 3.7029904966695366`*^9}, {3.703423449406228*^9, 
  3.7034234602388105`*^9}},ExpressionUUID->"148e6e94-360f-40f5-8cb7-\
5d267bc278b3"],

Cell[BoxData[
 RowBox[{"<<", "\"\<Definitions/IO.wl\>\""}]], "Input",
 CellChangeTimes->{{3.703508142154978*^9, 
  3.703508148529917*^9}},ExpressionUUID->"4566e237-19ba-40ed-b56a-\
12762223c782"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EqTeukolskyRadial", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"c", " ", "x"}], ")"}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"s", " ", "x"}]}], ")"}], "2"], 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "2"]}]], "+", "s", "-", 
       RowBox[{"2", " ", "c", " ", "s", " ", "x"}], "+", "A"}], ")"}], " ", 
     RowBox[{"S", "[", "x", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anzatzS", "=", 
   RowBox[{"{", 
    RowBox[{"S", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"c", " ", "x"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"1", "+", "x"}], "2"], ")"}], "km"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"1", "-", "x"}], "2"], ")"}], "kp"], 
        RowBox[{"F", "[", "x", "]"}]}]}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6967797210173645`*^9, 3.6967797291239347`*^9}, {
   3.6968352601354513`*^9, 3.6968352609734707`*^9}, {3.6968359459876957`*^9, 
   3.6968359462565413`*^9}, 3.6968929083728704`*^9, 3.6968929781398625`*^9, {
   3.696893206258213*^9, 3.696893232706349*^9}, {3.6968933208878603`*^9, 
   3.696893321044141*^9}, {3.6968934313397865`*^9, 3.6968934340588083`*^9}, {
   3.696893545355935*^9, 3.69689365022659*^9}, 3.6968970752478943`*^9, {
   3.6968971053372793`*^9, 3.69689711947798*^9}, 
   3.696971320279205*^9},ExpressionUUID->"97f9b131-065b-4c40-96f6-\
cccd3bf352cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ruleSSjoin", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"y_","z_"},
        "InactiveSum",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "+", 
       TemplateBox[{"w_","z_"},
        "InactiveSum",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
      TemplateBox[{RowBox[{"Collect", "[", 
          RowBox[{
            RowBox[{"Simplify", "[", 
              RowBox[{"y", "+", "w"}], "]"}], ",", 
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{"1", "+", "x"}], ")"}], "n1_"]}], "]"}],"z"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderscriptBox[
           StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
     RowBox[{
      RowBox[{"w_", " ", 
       TemplateBox[{"y_","z_"},
        "InactiveSum",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
      TemplateBox[{RowBox[{"Collect", "[", 
          RowBox[{
            RowBox[{"Simplify", "[", 
              RowBox[{"y", " ", "w"}], "]"}], ",", 
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{"1", "+", "x"}], ")"}], "n1_"]}], "]"}],"z"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderscriptBox[
           StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleSSseparate", "=", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{RowBox[{"(", 
         RowBox[{"y_", "+", "w_"}], ")"}],"z_"},
      "InactiveSum",
      DisplayFunction->(RowBox[{
         UnderscriptBox[
          StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
     RowBox[{
      TemplateBox[{"y","z"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderscriptBox[
           StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      TemplateBox[{"w","z"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderscriptBox[
           StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleF", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"w_.", " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", "n_", ")"}],
          Derivative],
         MultilineFunction->None], "[", "x", "]"}]}], "\[RuleDelayed]", 
      TemplateBox[{RowBox[{"w", " ", 
          RowBox[{"a", "[", "p", "]"}], " ", 
          RowBox[{
            SubscriptBox["\[PartialD]", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"x", ",", "n"}], "}"}]}]], 
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{"1", "+", "x"}], ")"}], "p"]}]}],"p","n","\[Infinity]"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderoverscriptBox[
           StyleBox["\[Sum]", "Inactive"], 
           RowBox[{#2, "=", #3}], #4], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", 
            RowBox[{"{", 
              RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], ",", 
     RowBox[{
      RowBox[{"w_.", " ", 
       RowBox[{"F", "[", "x", "]"}]}], "\[RuleDelayed]", 
      TemplateBox[{RowBox[{"w", " ", 
          RowBox[{"a", "[", "p", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{"1", "+", "x"}], ")"}], "p"]}],"p","0","\[Infinity]"},
       "InactiveSum",
       DisplayFunction->(RowBox[{
          UnderoverscriptBox[
           StyleBox["\[Sum]", "Inactive"], 
           RowBox[{#2, "=", #3}], #4], #}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
          RowBox[{#, ",", 
            RowBox[{"{", 
              RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleRemoveM", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["s", "n_."], " ", 
       SuperscriptBox["m", "k_."]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["s", 
         RowBox[{"n", "-", "k"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["kp", "2"], "-", 
           SuperscriptBox["km", "2"]}], ")"}], "k"]}], "/;", 
       RowBox[{
        RowBox[{"OddQ", "[", "k", "]"}], "&&", 
        RowBox[{"n", "\[GreaterEqual]", "k"}]}]}]}], ",", 
     RowBox[{
      SuperscriptBox["m", "n_"], "\[RuleDelayed]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["kp", "2"], "+", 
             SuperscriptBox["km", "2"]}], ")"}]}], "-", 
          SuperscriptBox["s", "2"]}], ")"}], 
        RowBox[{"n", "/", "2"}]], "/;", 
       RowBox[{"EvenQ", "[", "n", "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ruleShift", "[", "z_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{RowBox[{
         SuperscriptBox["z", "v_"], " ", 
         RowBox[{"a", "[", "p_", "]"}], " ", "b_."}],"p_","i_","\[Infinity]"},
      "InactiveSum",
      DisplayFunction->(RowBox[{
         UnderoverscriptBox[
          StyleBox["\[Sum]", "Inactive"], 
          RowBox[{#2, "=", #3}], #4], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
         RowBox[{#, ",", 
           RowBox[{"{", 
             RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
     "\[RuleDelayed]", 
     TemplateBox[{RowBox[{
         SuperscriptBox["z", "p"], " ", 
         RowBox[{"a", "[", 
           RowBox[{
             RowBox[{"2", " ", "p"}], "-", "v"}], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{"b", "/.", "\[VeryThinSpace]", 
             RowBox[{"{", 
               RowBox[{"p", "\[Rule]", 
                 RowBox[{
                   RowBox[{"2", " ", "p"}], "-", "v"}]}], "}"}]}], ")"}]}],
       "p",RowBox[{"i", "-", "p", "+", "v"}],"\[Infinity]"},
      "InactiveSum",
      DisplayFunction->(RowBox[{
         UnderoverscriptBox[
          StyleBox["\[Sum]", "Inactive"], 
          RowBox[{#2, "=", #3}], #4], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
         RowBox[{#, ",", 
           RowBox[{"{", 
             RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.696772456703853*^9, 3.6967725106797543`*^9}, {
   3.6967731076586494`*^9, 3.6967731362622223`*^9}, {3.696773408364984*^9, 
   3.696773445281452*^9}, {3.696773525767545*^9, 3.696773611760913*^9}, {
   3.6967737500330296`*^9, 3.6967738010897884`*^9}, {3.696774041247012*^9, 
   3.6967740477231855`*^9}, {3.696774113370859*^9, 3.696774117481798*^9}, {
   3.696774493904036*^9, 3.696774499861883*^9}, {3.6967784624630194`*^9, 
   3.6967784814424906`*^9}, {3.69677859919416*^9, 3.6967786872494354`*^9}, {
   3.6967787516377735`*^9, 3.696778762844594*^9}, {3.6967787995071383`*^9, 
   3.6967788973183956`*^9}, {3.6967789604714036`*^9, 
   3.6967789743654013`*^9}, {3.6967796323824253`*^9, 
   3.6967797035428696`*^9}, {3.6967799683575687`*^9, 
   3.6967799687556276`*^9}, {3.6967800395745983`*^9, 3.696780053109579*^9}, 
   3.696835393186761*^9, {3.696836237480296*^9, 3.6968362392675734`*^9}, {
   3.6968929083885107`*^9, 3.6968929356041613`*^9}, {3.6968929693576655`*^9, 
   3.6968929693576655`*^9}, {3.69689320627384*^9, 3.6968932327219753`*^9}, {
   3.69689336289229*^9, 3.69689336289229*^9}, {3.6968935453715305`*^9, 
   3.696893592892313*^9}, {3.696893638787855*^9, 3.6968936502422156`*^9}, {
   3.696897075262924*^9, 3.696897075265933*^9}, {3.6968971053523235`*^9, 
   3.6968971194920197`*^9}, {3.6969016756205816`*^9, 3.696901904195009*^9}, {
   3.696902010368885*^9, 3.696902050263799*^9}, {3.7028216343809233`*^9, 
   3.702821634396553*^9}, {3.702821677820369*^9, 3.702821685020947*^9}, {
   3.702821722514183*^9, 3.702821729217602*^9}, {3.702992275484217*^9, 
   3.702992315861236*^9}, {3.7029924649316044`*^9, 
   3.702992515768547*^9}},ExpressionUUID->"ac607677-f02f-41a9-beba-\
c6bb43821444"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"c", " ", "x"}]], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", "+", "x"}], "2"], ")"}], "km"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", "-", "x"}], "2"], ")"}], "kp"]}]], " ", 
    RowBox[{"(", 
     RowBox[{"EqTeukolskyRadial", "/.", "anzatzS"}], ")"}]}], "//", 
   "Expand"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.702990576397579*^9, 
  3.7029905882298727`*^9}},ExpressionUUID->"508a9dcd-4c05-4a5d-9fc8-\
8bb2fc42d1b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["x", "2"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"km", "-", 
      SuperscriptBox["km", "2"], "+", "kp", "+", 
      RowBox[{"2", " ", "km", " ", "kp"}], "-", 
      SuperscriptBox["kp", "2"], "+", 
      SuperscriptBox["m", "2"], "-", "s", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["km", "2"], " ", "x"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["kp", "2"], " ", "x"}], "+", 
      RowBox[{"2", " ", "m", " ", "s", " ", "x"}], "-", 
      RowBox[{"km", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["km", "2"], " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"kp", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"2", " ", "km", " ", "kp", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["kp", "2"], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"s", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["s", "2"], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"A", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["x", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["x", "2"]}], ")"}]}], "-", 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"km", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", "x", "+", 
         RowBox[{"kp", " ", "x"}], "+", 
         RowBox[{"s", " ", "x"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"F", "[", "x", "]"}]}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"kp", "+", 
     RowBox[{"km", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", "x", "+", 
     RowBox[{"kp", " ", "x"}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["F", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["x", "2"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["F", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.7029904940701494`*^9, 3.702990503574688*^9}, {
   3.7029905800375814`*^9, 3.702990588593199*^9}, 3.7034233862605*^9, 
   3.7034240651299706`*^9, 3.703433319013175*^9, 3.703433841197631*^9, 
   3.7034363617415023`*^9, 3.703436943597466*^9, 3.703437822796522*^9, 
   3.7034442770776386`*^9, 3.70347604742246*^9, {3.703509061922039*^9, 
   3.7035090674873667`*^9}, 3.7035116926968164`*^9, 3.703512972512128*^9, 
   3.703586448533819*^9},ExpressionUUID->"710bb7b2-be17-4b7c-a8a6-\
08c0e48fe81d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eq1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"c", " ", "x"}]], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"1", "+", "x"}], "2"], ")"}], "km"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"1", "-", "x"}], "2"], ")"}], "kp"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"EqTeukolskyRadial", "/.", "anzatzS"}], ")"}]}], "//", 
       "Expand"}], ")"}], "/.", "ruleRemoveM"}], "/.", "ruleF"}], "//.", 
   "ruleSSjoin"}]}]], "Input",
 CellChangeTimes->{{3.696767986547374*^9, 3.6967680709134617`*^9}, {
   3.696768109725922*^9, 3.6967681187864485`*^9}, {3.696768148908242*^9, 
   3.696768151667014*^9}, {3.696768184519539*^9, 3.696768185549842*^9}, {
   3.6967683266364946`*^9, 3.6967684375297947`*^9}, {3.696768471595171*^9, 
   3.6967684733245277`*^9}, {3.6967685355987787`*^9, 3.696768536104594*^9}, {
   3.696769502191042*^9, 3.69676950417901*^9}, {3.6967695555802755`*^9, 
   3.6967695789915566`*^9}, {3.696769898746505*^9, 3.6967699445132365`*^9}, {
   3.696770002103326*^9, 3.696770009871063*^9}, {3.696770124094677*^9, 
   3.696770192662055*^9}, {3.6967710370685673`*^9, 3.696771079829609*^9}, {
   3.696771203018942*^9, 3.696771393138898*^9}, {3.696771438552272*^9, 
   3.6967714584396653`*^9}, {3.696771491514577*^9, 3.696771586906819*^9}, {
   3.6967716259455147`*^9, 3.6967716853934016`*^9}, 3.6967717462855597`*^9, {
   3.6967717848778477`*^9, 3.696771828970703*^9}, {3.6967719222251062`*^9, 
   3.6967719911576104`*^9}, {3.6967724055640745`*^9, 
   3.6967724080682487`*^9}, {3.6967725625179377`*^9, 
   3.6967726426361356`*^9}, {3.696772688290617*^9, 3.6967727326028285`*^9}, {
   3.696772778795331*^9, 3.69677281507802*^9}, {3.6967729982756715`*^9, 
   3.696773081932517*^9}, 3.6967732664810886`*^9, {3.696773308991*^9, 
   3.6967733444120803`*^9}, {3.696773385689627*^9, 3.6967734055181246`*^9}, {
   3.6967734487194595`*^9, 3.696773502670406*^9}, {3.6967735628398294`*^9, 
   3.696773582857174*^9}, {3.696773615992155*^9, 3.6967736722781906`*^9}, {
   3.696773708399027*^9, 3.6967737337263784`*^9}, {3.6967742312912836`*^9, 
   3.69677423213851*^9}, {3.696774857768043*^9, 3.6967748611390176`*^9}, {
   3.696774921855569*^9, 3.696774972234053*^9}, 3.696775107529479*^9, {
   3.6967768537066813`*^9, 3.696776886773656*^9}, 3.696778488841207*^9, 
   3.696778708137029*^9, 3.69677877748956*^9, {3.6967797410546837`*^9, 
   3.696779746170291*^9}, {3.696779806327354*^9, 3.6967798192642345`*^9}, {
   3.6967798832354784`*^9, 3.6967798841371336`*^9}, 3.696779976680742*^9, 
   3.696835267201972*^9, 3.6968929084041233`*^9, 3.6968929693576655`*^9, {
   3.696893206289467*^9, 3.6968932283934116`*^9}, 3.696893362907891*^9, {
   3.696893545387158*^9, 3.696893587047928*^9}, {3.696893638803481*^9, 
   3.696893650257844*^9}, 3.696897075282423*^9, {3.696897105370347*^9, 
   3.69689711950756*^9}, {3.696971286579402*^9, 3.6969713036771545`*^9}, 
   3.7028216344187107`*^9, {3.7028216778644524`*^9, 
   3.702821691302324*^9}},ExpressionUUID->"5230742f-801a-4865-8fa0-\
181a985263fc"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        RowBox[{"(", 
          RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}]}], " ", "p", " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], 
       RowBox[{
         RowBox[{"-", "1"}], "+", "p"}]], " ", 
      RowBox[{"a", "[", "p", "]"}]}],"p","2","\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], "+", 
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], "p"]}], " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{"-", "A"}], "-", 
          SuperscriptBox["c", "2"], "+", "km", "+", 
          SuperscriptBox["km", "2"], "+", "kp", "+", 
          RowBox[{"2", " ", "km", " ", "kp"}], "+", 
          SuperscriptBox["kp", "2"], "-", "s", "-", 
          SuperscriptBox["s", "2"], "+", 
          RowBox[{"2", " ", "c", " ", 
            RowBox[{"(", 
              RowBox[{"kp", "+", 
                RowBox[{"km", " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", "x", "+", 
                RowBox[{"kp", " ", "x"}], "+", 
                RowBox[{"s", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"a", "[", "p", "]"}]}],"p","0","\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], "+", 
  TemplateBox[{RowBox[{
      RowBox[{"-", "2"}], " ", "p", " ", 
      SuperscriptBox[
       RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], 
       RowBox[{
         RowBox[{"-", "1"}], "+", "p"}]], " ", 
      RowBox[{"(", 
        RowBox[{"kp", "+", 
          RowBox[{"km", " ", 
            RowBox[{"(", 
              RowBox[{
                RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", "x", "+", 
          RowBox[{"kp", " ", "x"}], "+", 
          RowBox[{"c", " ", 
            RowBox[{"(", 
              RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["x", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"a", "[", "p", "]"}]}],"p","1","\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.7028217674746313`*^9, 3.7028217776592245`*^9}, 
   3.702990915931118*^9, 3.7034233868137455`*^9, 3.7034240656259484`*^9, 
   3.7034333195942583`*^9, 3.703433841682263*^9, 3.70343636219102*^9, 
   3.703436944061124*^9, 3.70343782331318*^9, 3.7034442777589736`*^9, 
   3.7034760479066343`*^9, 3.703509068153782*^9, 3.703511693349553*^9, 
   3.7035129731708913`*^9, 
   3.7035864490606947`*^9},ExpressionUUID->"4988cfaf-a94f-4fae-976b-\
6486fe90f6a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eq2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Eq1", "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"x", "\[Rule]", 
           RowBox[{"\[ScriptCapitalU]", "-", "1"}]}], "}"}]}], "//", 
        "ExpandAll"}], ")"}], "//.", "ruleSSseparate"}], "/.", 
     RowBox[{"ruleShift", "[", "\[ScriptCapitalU]", "]"}]}], "//.", 
    "ruleSSjoin"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6967728851190805`*^9, 3.696772967210032*^9}, {
   3.696773087492292*^9, 3.6967730933720117`*^9}, {3.696773141161392*^9, 
   3.6967731993880796`*^9}, 3.6967732739487205`*^9, {3.696774153482585*^9, 
   3.6967741570717754`*^9}, {3.6967751209989567`*^9, 3.696775265528799*^9}, {
   3.696776210209077*^9, 3.6967762173921623`*^9}, {3.696777236479142*^9, 
   3.6967773708614273`*^9}, {3.696777444423151*^9, 3.696777458457489*^9}, {
   3.6967780358567934`*^9, 3.6967781805079017`*^9}, {3.6967782864949026`*^9, 
   3.6967784021014304`*^9}, {3.696778441233535*^9, 3.6967784483685174`*^9}, {
   3.696778512521209*^9, 3.696778537245329*^9}, {3.696778907902562*^9, 
   3.6967789177226906`*^9}, {3.696778981049184*^9, 3.6967790277502728`*^9}, {
   3.696779069934516*^9, 3.6967790806981587`*^9}, {3.6967791300374055`*^9, 
   3.6967791328850136`*^9}, {3.6967798886451244`*^9, 3.696779893493024*^9}, {
   3.69677994679222*^9, 3.6967799740236444`*^9}, {3.696780064637252*^9, 
   3.69678007227357*^9}, {3.696836443298374*^9, 3.6968365052270613`*^9}, {
   3.6968366242710176`*^9, 3.696836652401002*^9}, {3.7028216344655952`*^9, 
   3.7028216344812202`*^9}, {3.7028216778774867`*^9, 
   3.7028216778794923`*^9}},ExpressionUUID->"c4ef024f-3333-48cb-8c39-\
69eb8355c9b6"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        RowBox[{"(", 
          RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}]}], " ", 
      SuperscriptBox["\[ScriptCapitalU]", "p"], " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{"2", " ", "c", " ", 
            RowBox[{"a", "[", 
              RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], "]"}]}], "+", 
          RowBox[{"p", " ", 
            RowBox[{"a", "[", "p", "]"}]}]}], ")"}]}],"p","2","\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], "+", 
  TemplateBox[{RowBox[{
      SuperscriptBox["\[ScriptCapitalU]", "p"], " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{
            RowBox[{"(", 
              RowBox[{"A", "+", 
                SuperscriptBox["c", "2"], "+", 
                RowBox[{"2", " ", "c", " ", 
                  RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "km"}], "+", "s"}], ")"}]}], "-", 
                RowBox[{
                  RowBox[{"(", 
                    RowBox[{"km", "+", "kp", "-", "s"}], ")"}], " ", 
                  RowBox[{"(", 
                    RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], 
              ")"}], " ", 
            RowBox[{"a", "[", "p", "]"}]}], "+", 
          RowBox[{"2", " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", 
                RowBox[{"2", " ", "km"}]}], ")"}], " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", "p"}], ")"}], " ", 
            RowBox[{"a", "[", 
              RowBox[{"1", "+", "p"}], "]"}]}]}], ")"}]}],"p","0",
    "\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], "+", 
  TemplateBox[{RowBox[{"2", " ", 
      SuperscriptBox["\[ScriptCapitalU]", "p"], " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{
            RowBox[{"-", "c"}], " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}], " ", 
            RowBox[{"a", "[", 
              RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], "]"}]}], "+", 
          RowBox[{
            RowBox[{"(", 
              RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "c"}], "-", "km", "-", "kp"}], ")"}], " ", 
            "p", " ", 
            RowBox[{"a", "[", "p", "]"}]}], "+", 
          RowBox[{"p", " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", "p"}], ")"}], " ", 
            RowBox[{"a", "[", 
              RowBox[{"1", "+", "p"}], "]"}]}]}], ")"}]}],"p","1",
    "\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.702821785147314*^9, {3.702990994829084*^9, 3.702990999598625*^9}, 
   3.703423387555475*^9, 3.7034240663636074`*^9, 3.7034333203996906`*^9, 
   3.7034338423836427`*^9, 3.7034363627924366`*^9, 3.7034369446845865`*^9, 
   3.7034378239836392`*^9, 3.703444278662924*^9, 3.703476048523114*^9, 
   3.7035090690129933`*^9, 3.7035116943336787`*^9, 3.703512974200673*^9, 
   3.703586449904469*^9},ExpressionUUID->"b2c350e1-f850-4726-9a14-\
03843b0c5588"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eq3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxI", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"Eq2", ",", 
           RowBox[{
            TemplateBox[{"w_","p_","i_","j_"},
             "InactiveSum",
             DisplayFunction->(RowBox[{
                UnderoverscriptBox[
                 StyleBox["\[Sum]", "Inactive"], 
                 RowBox[{#2, "=", #3}], #4], #}]& ),
             InterpretationFunction->(RowBox[{
                RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
                RowBox[{#, ",", 
                  RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
            "\[Rule]", "i"}]}], "]"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Eq2", "/.", "\[VeryThinSpace]", 
       RowBox[{
        TemplateBox[{"w_","p","i_","\[Infinity]"},
         "InactiveSum",
         DisplayFunction->(RowBox[{
            UnderoverscriptBox[
             StyleBox["\[Sum]", "Inactive"], 
             RowBox[{#2, "=", #3}], #4], #}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
            RowBox[{#, ",", 
              RowBox[{"{", 
                RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"p", "=", "i"}], 
            RowBox[{"maxI", "-", "1"}]], "w"}], "+", 
          TemplateBox[{"w","p","maxI","\[Infinity]"},
           "InactiveSum",
           DisplayFunction->(RowBox[{
              UnderoverscriptBox[
               StyleBox["\[Sum]", "Inactive"], 
               RowBox[{#2, "=", #3}], #4], #}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
              RowBox[{#, ",", 
                RowBox[{"{", 
                  RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], "/;", 
         RowBox[{"i", "<", "maxI"}]}]}]}]}], "\[IndentingNewLine]", "]"}], "//.",
     "\[VeryThinSpace]", "ruleSSjoin"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.696779136016343*^9, 3.696779350669357*^9}, {
  3.6967794308125963`*^9, 3.6967794529705524`*^9}, {3.696779835225704*^9, 
  3.6967798435869837`*^9}, {3.6967798990327635`*^9, 3.696779908732572*^9}, {
  3.696780021442321*^9, 3.6967800218423853`*^9}, {3.696836209449325*^9, 
  3.696836209549353*^9}, {3.696836698881944*^9, 3.696836700169155*^9}, {
  3.7028216345189986`*^9, 3.7028216345346265`*^9}, {3.702821677893529*^9, 
  3.7028216778985424`*^9}, {3.702821722551281*^9, 3.7028217405411615`*^9}, {
  3.702821870977974*^9, 3.702821889521676*^9}, {3.7029910463216305`*^9, 
  3.7029910514490404`*^9}, {3.702991126876308*^9, 
  3.702991129216277*^9}},ExpressionUUID->"98d2d280-69ad-4c98-873d-\
46240746f7aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A", "+", 
     SuperscriptBox["c", "2"], "+", 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "km"}], "+", "s"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"km", "+", "kp", "-", "s"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "km"}]}], ")"}], " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{"2", " ", "\[ScriptCapitalU]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}], " ", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "km", "+", "kp"}], ")"}], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"\[ScriptCapitalU]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "+", 
        SuperscriptBox["c", "2"], "+", 
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "km"}], "+", "s"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"km", "+", "kp", "-", "s"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "km"}]}], ")"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], "+", 
  TemplateBox[{RowBox[{
      SuperscriptBox["\[ScriptCapitalU]", "p"], " ", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{
            RowBox[{"-", "2"}], " ", "c", " ", 
            RowBox[{"(", 
              RowBox[{"km", "+", "kp", "+", "p", "+", "s"}], ")"}], " ", 
            RowBox[{"a", "[", 
              RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], "]"}]}], "+", 
          RowBox[{
            RowBox[{"(", 
              RowBox[{"A", "+", 
                SuperscriptBox["c", "2"], "-", 
                RowBox[{
                  RowBox[{"(", 
                    RowBox[{"km", "+", "kp", "+", "p", "-", "s"}], ")"}], " ", 
                  RowBox[{"(", 
                    RowBox[{"1", "+", "km", "+", "kp", "+", "p", "+", "s"}], 
                    ")"}]}], "+", 
                RowBox[{"2", " ", "c", " ", 
                  RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "km"}], "+", 
                    RowBox[{"2", " ", "p"}], "+", "s"}], ")"}]}]}], ")"}], 
            " ", 
            RowBox[{"a", "[", "p", "]"}]}], "+", 
          RowBox[{"2", " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", "p"}], ")"}], " ", 
            RowBox[{"(", 
              RowBox[{"1", "+", 
                RowBox[{"2", " ", "km"}], "+", "p"}], ")"}], " ", 
            RowBox[{"a", "[", 
              RowBox[{"1", "+", "p"}], "]"}]}]}], ")"}]}],"p","2",
    "\[Infinity]"},
   "InactiveSum",
   DisplayFunction->(RowBox[{
      UnderoverscriptBox[
       StyleBox["\[Sum]", "Inactive"], 
       RowBox[{#2, "=", #3}], #4], #}]& ),
   InterpretationFunction->(RowBox[{
      RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
      RowBox[{#, ",", 
        RowBox[{"{", 
          RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.7028217900649147`*^9, {3.7028218771842623`*^9, 3.7028218996541476`*^9}, 
   3.7034233892859263`*^9, 3.703424067951273*^9, 3.7034333218694324`*^9, 
   3.7034338436372724`*^9, 3.703436364047332*^9, 3.7034369459324427`*^9, 
   3.7034378255470886`*^9, 3.703444280735943*^9, 3.7034760500247183`*^9, 
   3.703509070885471*^9, 3.703511697220352*^9, 3.703512976706747*^9, 
   3.7035864513774567`*^9},ExpressionUUID->"85d5e0cd-a205-4dfc-8f1b-\
2a88342b7abc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eq3", "/.", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"z_","y_"},
      "InactiveSum",
      DisplayFunction->(RowBox[{
         UnderscriptBox[
          StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", "z"}], "}"}]}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalU]", ",", 
       SuperscriptBox["\[ScriptCapitalU]", "p"]}], "}"}], ",", 
     RowBox[{"Framed", "@*", "FullSimplify"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.696780096486188*^9, 3.696780257003894*^9}, {
   3.696780292419132*^9, 3.696780414606052*^9}, {3.6968361854694133`*^9, 
   3.6968361873343797`*^9}, {3.696845008813895*^9, 3.6968450098607607`*^9}, 
   3.702821634581505*^9, 3.7028216779130993`*^9, {3.7028217225743833`*^9, 
   3.702821755381248*^9}, {3.7028217974235916`*^9, 3.702821800067108*^9}, 
   3.7029912804047146`*^9},ExpressionUUID->"f75f095a-009a-4b11-b413-\
aa673b8ac57e"],

Cell[BoxData[
 RowBox[{
  FrameBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "+", 
       SuperscriptBox["c", "2"], "+", 
       RowBox[{"2", " ", "c", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "km"}], "+", "s"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"km", "+", "kp", "-", "s"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "km"}]}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}]}],
   StripOnInput->False], "+", 
  RowBox[{"\[ScriptCapitalU]", " ", 
   FrameBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}], " ", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", "km"}], "+", "s"}], ")"}], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "km", "+", "kp", "-", "s"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "km"}], ")"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}]}],
    StripOnInput->False]}], "+", 
  RowBox[{
   SuperscriptBox["\[ScriptCapitalU]", "p"], " ", 
   FrameBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"km", "+", "kp", "+", "p", "+", "s"}], ")"}], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", "+", 
        SuperscriptBox["c", "2"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"km", "+", "kp", "+", "p", "-", "s"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "km", "+", "kp", "+", "p", "+", "s"}], ")"}]}], 
        "+", 
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "km"}], "+", 
           RowBox[{"2", " ", "p"}], "+", "s"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"a", "[", "p", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "p"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "km"}], "+", "p"}], ")"}], " ", 
      RowBox[{"a", "[", 
       RowBox[{"1", "+", "p"}], "]"}]}]}],
    StripOnInput->False]}]}]], "Output",
 CellChangeTimes->{3.702821801333077*^9, 3.7028219026005774`*^9, 
  3.7029912961120954`*^9, 3.7034233898638873`*^9, 3.703424068685725*^9, 
  3.7034333222723866`*^9, 3.703433844119114*^9, 3.703436364364251*^9, 
  3.7034369462855606`*^9, 3.703437826248622*^9, 3.7034442815190163`*^9, 
  3.7034760503972282`*^9, 3.7035090716144085`*^9, 3.7035116981438074`*^9, 
  3.703512977601626*^9, 
  3.703586451801259*^9},ExpressionUUID->"02f52239-8a01-4339-a069-\
3b93610eccca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EqsCoef", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "Eq3"}], "/.", 
       RowBox[{"{", "\[VeryThinSpace]", 
        RowBox[{
         TemplateBox[{"z_","y_"},
          "InactiveSum",
          DisplayFunction->(RowBox[{
             UnderscriptBox[
              StyleBox["\[Sum]", "Inactive"], #2], #}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Sum", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"z", "/.", "\[VeryThinSpace]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[ScriptCapitalU]", "p"], "\[Rule]", 
             "\[ScriptCapitalV]"}], "}"}]}], ")"}]}], "}"}]}], "//", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalU]", ",", "\[ScriptCapitalV]"}], "}"}]}], 
        "]"}], "&"}]}], "//", "Flatten"}], "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#1", ",", "0"}], "]"}], "&"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6967807643289557`*^9, 3.6967808807256584`*^9}, {
   3.6967809442967997`*^9, 3.696780962315743*^9}, {3.6967812232627916`*^9, 
   3.696781409962596*^9}, {3.696781449174023*^9, 3.696781601949494*^9}, {
   3.6968361216222305`*^9, 3.6968361254902363`*^9}, {3.696836162644422*^9, 
   3.6968361747262716`*^9}, {3.696836773489543*^9, 3.696836802966278*^9}, {
   3.696892829505123*^9, 3.696892855085903*^9}, {3.6968931110605865`*^9, 
   3.696893114904734*^9}, 3.702821634581505*^9, 3.7028216779191113`*^9, {
   3.7028217225793896`*^9, 3.702821744409428*^9}, {3.7028218089865637`*^9, 
   3.702821814535428*^9}, {3.702821854840871*^9, 3.702821858665577*^9}, {
   3.702821913803257*^9, 
   3.7028219388087687`*^9}},ExpressionUUID->"8eb6cffe-dd61-49c9-91c2-\
379dd4a6ed5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"A", "+", 
        SuperscriptBox["c", "2"], "+", 
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "km"}], "+", "s"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"km", "+", "kp", "-", "s"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}]}], 
     " ", 
     RowBox[{"a", "[", "0", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "km"}]}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "c", " ", 
     RowBox[{"(", 
      RowBox[{"km", "+", "kp", "+", "p", "+", "s"}], ")"}], " ", 
     RowBox[{"a", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "p"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "+", 
       SuperscriptBox["c", "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"km", "+", "kp", "+", "p", "-", "s"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "km", "+", "kp", "+", "p", "+", "s"}], ")"}]}], 
       "+", 
       RowBox[{"2", " ", "c", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "km"}], "+", 
          RowBox[{"2", " ", "p"}], "+", "s"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"a", "[", "p", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "p"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "km"}], "+", "p"}], ")"}], " ", 
     RowBox[{"a", "[", 
      RowBox[{"1", "+", "p"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "c", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "km", "+", "kp", "+", "s"}], ")"}], " ", 
     RowBox[{"a", "[", "0", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"2", " ", "c", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"2", " ", "km"}], "+", "s"}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "A"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "km", "+", "kp", "-", "s"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "km", "+", "kp", "+", "s"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "km"}], ")"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7028218415283628`*^9, 3.702821940004796*^9, 
  3.7029913267724113`*^9, 3.703423390589873*^9, 3.7034240692466173`*^9, 
  3.703433322872937*^9, 3.703433844676345*^9, 3.703436364895228*^9, 
  3.703436946833313*^9, 3.7034378269184885`*^9, 3.703444282458029*^9, 
  3.703476050916506*^9, 3.703509072314269*^9, 3.7035116990874634`*^9, 
  3.703512978590756*^9, 
  3.703586452369755*^9},ExpressionUUID->"7549b7f4-518e-46a5-afcf-\
574a106fbe69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeaverCoef", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "p_", "]"}], ",", 
       RowBox[{"\[Beta]", "[", "p_", "]"}], ",", 
       RowBox[{"\[Gamma]", "[", "p_", "]"}]}], "}"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{
           "EqsCoef", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"p", "+", "1"}], "]"}], ",", 
             RowBox[{"a", "[", "p", "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"p", "-", "1"}], "]"}]}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"Sequence", "@@", "#1"}], "\[RightDoubleBracket]"}], "&"}], 
       ")"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1"}], "}"}], "]"}]}]}], "//", "Thread"}],
    "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6967807643289557`*^9, 3.6967808807256584`*^9}, {
   3.6967809442967997`*^9, 3.696780962315743*^9}, {3.6967812232627916`*^9, 
   3.696781409962596*^9}, {3.696781449174023*^9, 3.696781601949494*^9}, {
   3.696892381790284*^9, 3.696892427435697*^9}, {3.6968924663306575`*^9, 
   3.6968925116949167`*^9}, {3.696892595735236*^9, 3.696892676087639*^9}, 
   3.6968927182483344`*^9, {3.696893092574217*^9, 3.696893145845578*^9}, {
   3.696897198597308*^9, 3.6968972006802626`*^9}, {3.703423331561321*^9, 
   3.703423336521844*^9}},ExpressionUUID->"3bb8ccdc-4b1b-4db1-b428-\
3bd124098e57"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", "[", "p_", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "p"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "km"}], "+", "p"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Beta]", "[", "p_", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "A"}], "-", 
     SuperscriptBox["c", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"km", "+", "kp", "+", "p", "-", "s"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "km", "+", "kp", "+", "p", "+", "s"}], ")"}]}], "-", 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "km"}], "+", 
        RowBox[{"2", " ", "p"}], "+", "s"}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"\[Gamma]", "[", "p_", "]"}], "\[Rule]", 
    RowBox[{"2", " ", "c", " ", 
     RowBox[{"(", 
      RowBox[{"km", "+", "kp", "+", "p", "+", "s"}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7028219438388147`*^9, 3.70299146243814*^9, 
  3.703423390675907*^9, 3.7034240693333263`*^9, 3.70343332292047*^9, 
  3.7034338447605886`*^9, 3.7034363649264545`*^9, 3.70343694688167*^9, 
  3.7034378269871297`*^9, 3.703444282519203*^9, 3.7034760509575434`*^9, 
  3.7035090723895235`*^9, 3.703511699150131*^9, 3.703512978646393*^9, 
  3.703586452399835*^9},ExpressionUUID->"9c0f36af-b7fd-4b86-a01e-\
eefe2b0e39f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Rule\[Kappa]pm", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kp", "\[Rule]", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"s", "+", "m"}], "]"}], "/", "2"}]}], ",", 
    RowBox[{"km", "\[Rule]", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"s", "-", "m"}], "]"}], "/", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7034239240681825`*^9, 
  3.703423982712702*^9}},ExpressionUUID->"a79f5db8-8238-491c-9eb5-\
2b0d3d11ac7e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kp", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"m", "+", "s"}], "]"}]}]}], ",", 
   RowBox[{"km", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"-", "m"}], "+", "s"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7034239833318715`*^9, 3.7034240693709297`*^9, 
  3.703433323004753*^9, 3.7034338447762203`*^9, 3.703436364943165*^9, 
  3.7034369468861814`*^9, 3.7034378270027885`*^9, 3.7034442825412407`*^9, 
  3.703476050969566*^9, 3.703509072405066*^9, 3.703511699166706*^9, 
  3.703512978662972*^9, 
  3.703586452458996*^9},ExpressionUUID->"1363203c-ab70-42b3-9e84-\
bcdf0d4b3b63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]", "[", "0", "]"}], 
        RowBox[{"a", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Beta]", "[", "0", "]"}], 
        RowBox[{"a", "[", "0", "]"}]}], "-", 
       RowBox[{"EqsCoef", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", "+", "p"}], "]"}], " ", 
         RowBox[{"\[Alpha]", "[", "p", "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "p", "]"}], 
         RowBox[{"\[Beta]", "[", "p", "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "p"}], "]"}], " ", 
         RowBox[{"\[Gamma]", "[", "p", "]"}]}], "-", 
        RowBox[{"EqsCoef", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "\[Equal]", "0"}], "/.", 
      RowBox[{"p", "\[Rule]", "1"}]}]}], "\[IndentingNewLine]", "]"}], "/.", 
   "LeaverCoef"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6968368341269736`*^9, 3.6968369368151073`*^9}, {
   3.6968371389802837`*^9, 3.6968372151909676`*^9}, {3.6968926820570426`*^9, 
   3.696892712825971*^9}, 
   3.703423348580608*^9},ExpressionUUID->"6d9bf075-6f2e-455f-838f-\
0dc479aea658"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.702821946297761*^9, {3.702991460071769*^9, 3.7029914690652227`*^9}, 
   3.7034233906959624`*^9, 3.703424069400009*^9, 3.7034338447918415`*^9, 
   3.70343636496426*^9, 3.7034369469333863`*^9, 3.7034378270340095`*^9, 
   3.703444282556279*^9, 3.7034760510165777`*^9, 3.7035090724166336`*^9, 
   3.7035116991852245`*^9, 3.7035129786779985`*^9, 
   3.70358645248958*^9},ExpressionUUID->"c47426c1-034a-4567-ad89-\
6803d66ab226"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"recurrSol", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "p_", "]"}], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Zeta]", "[", "p", "]"}], "/.", "\[VeryThinSpace]", 
       RowBox[{"First", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"0", "\[Equal]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Alpha]", "[", "p", "]"}], ",", 
              RowBox[{"\[Beta]", "[", "p", "]"}], ",", 
              RowBox[{"\[Gamma]", "[", "p", "]"}]}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Zeta]", "[", 
               RowBox[{"p", "+", "1"}], "]"}], ",", "1", ",", 
              FractionBox["1", 
               RowBox[{"\[Zeta]", "[", "p", "]"}]]}], "}"}]}]}], ",", 
          RowBox[{"\[Zeta]", "[", "p", "]"}]}], "]"}], "]"}]}], ")"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvertFraction", "[", 
     RowBox[{"r_Integer", "?", "Positive"}], "]"}], "[", "f_", "]"}], ":=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"ReplaceRepeated", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EQ", "[", 
         RowBox[{"x_", ",", 
          FractionBox["y_", 
           RowBox[{"z_", "+", "w_"}]]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{
           RowBox[{"w", "-", 
            FractionBox["y", "x"]}], ",", 
           RowBox[{"-", "z"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"x", ",", 
              RowBox[{"\[Beta]", "[", "0", "]"}]}], "]"}]}], "&&", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"z", ",", 
              RowBox[{"\[Zeta]", "[", "_", "]"}]}], "]"}]}]}], ")"}]}]}], 
       "}"}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "r"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenExpand", "[", "n_", "]"}], "=", 
   RowBox[{
    RowBox[{"#1", "/.", "\[VeryThinSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EQ", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"EQ", "@@", 
        RowBox[{"Normal", "@", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "/.", "\[VeryThinSpace]", 
            RowBox[{"A", "\[Rule]", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"p", "=", "0"}], 
               RowBox[{"n", "+", "1"}]], 
              RowBox[{
               RowBox[{"f", "[", "p", "]"}], " ", 
               SuperscriptBox["c", "p"]}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
    "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696896065842122*^9, 3.696896190680133*^9}, {
   3.696896249494781*^9, 3.69689647425898*^9}, {3.696897451151136*^9, 
   3.696897474359226*^9}, {3.696897531942464*^9, 3.6968975462030687`*^9}, 
   3.696897653709928*^9, {3.6968979961035185`*^9, 3.69689808560176*^9}, {
   3.6968982711015034`*^9, 3.6968983057267284`*^9}, 3.696898432767763*^9, {
   3.696898542008241*^9, 3.696898555822643*^9}, {3.6968985916018176`*^9, 
   3.696898616205806*^9}, {3.696898671148269*^9, 3.6968986927309036`*^9}, {
   3.696898736098136*^9, 3.6968987522849035`*^9}, {3.6968988275944386`*^9, 
   3.6968988321050515`*^9}, {3.6968989242787533`*^9, 3.696898930706545*^9}, {
   3.696899000928053*^9, 3.696899020953912*^9}, {3.6968990958579288`*^9, 
   3.696899137954218*^9}, {3.696899177258605*^9, 3.696899183032028*^9}, {
   3.696899419479806*^9, 3.6968996656357417`*^9}, {3.696902674542174*^9, 
   3.696902677933022*^9}, {3.6969727898493853`*^9, 3.696972807101246*^9}, {
   3.696972882548089*^9, 3.696972909584066*^9}, {3.6969736702934303`*^9, 
   3.696973672778096*^9}},ExpressionUUID->"f990333a-e03a-4819-b934-\
080d27093453"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", "4"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"R", "-", 
    RowBox[{"th", " ", "inversion"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "=", "3"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Max", " ", "coef", " ", "power"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7016095308935623`*^9, 3.7016095433515463`*^9}, {
  3.7016098473189945`*^9, 3.701609900996896*^9}, {3.7016100345569773`*^9, 
  3.7016100426230803`*^9}},ExpressionUUID->"ce445997-cc3f-4c30-945e-\
fc03fd417211"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Eq4", "=", 
  RowBox[{"Quiet", "@", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EQ", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "[", "0", "]"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"a", "[", "1", "]"}]}], 
         RowBox[{
          RowBox[{"\[Alpha]", "[", "0", "]"}], "/", 
          RowBox[{"a", "[", "0", "]"}]}]}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
         RowBox[{"\[Zeta]", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "\[Rule]", "1"}]}], "}"}]}], ",", 
     "recurrSol", ",", 
     RowBox[{"MaxIterations", "\[Rule]", "8"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Eq5", "=", 
  RowBox[{"Eq4", "//", 
   RowBox[{"InvertFraction", "[", "R", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6969025189709215`*^9, 3.696902554476632*^9}, {
   3.6969026337096677`*^9, 3.6969026709792833`*^9}, 3.6969029528848734`*^9, 
   3.696903274081896*^9, {3.696903853445148*^9, 3.6969038770518856`*^9}, {
   3.6969041230116935`*^9, 3.696904154570781*^9}, {3.6969049151374907`*^9, 
   3.6969049156840615`*^9}, 3.6969051305708914`*^9, 3.696972818446221*^9, 
   3.7016095517306747`*^9},ExpressionUUID->"64e202a8-bf3d-44b1-85e7-\
9467bf3312fa"],

Cell[BoxData[
 RowBox[{"EQ", "[", 
  RowBox[{
   RowBox[{"\[Beta]", "[", "0", "]"}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Alpha]", "[", "0", "]"}], " ", 
     RowBox[{"\[Gamma]", "[", "1", "]"}]}], 
    RowBox[{
     RowBox[{"\[Beta]", "[", "1", "]"}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Alpha]", "[", "1", "]"}], " ", 
       RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", "2", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Alpha]", "[", "2", "]"}], " ", 
         RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
        RowBox[{
         RowBox[{"\[Beta]", "[", "3", "]"}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[Alpha]", "[", "3", "]"}], " ", 
           RowBox[{"\[Gamma]", "[", "4", "]"}]}], 
          RowBox[{
           RowBox[{"\[Beta]", "[", "4", "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Alpha]", "[", "4", "]"}], " ", 
             RowBox[{"\[Gamma]", "[", "5", "]"}]}], 
            RowBox[{
             RowBox[{"\[Beta]", "[", "5", "]"}], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Alpha]", "[", "5", "]"}], " ", 
               RowBox[{"\[Gamma]", "[", "6", "]"}]}], 
              RowBox[{
               RowBox[{"\[Beta]", "[", "6", "]"}], "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Alpha]", "[", "6", "]"}], " ", 
                 RowBox[{"\[Gamma]", "[", "7", "]"}]}], 
                RowBox[{
                 RowBox[{"\[Beta]", "[", "7", "]"}], "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Alpha]", "[", "7", "]"}], " ", 
                   RowBox[{"\[Gamma]", "[", "8", "]"}]}], 
                  RowBox[{
                   RowBox[{"\[Beta]", "[", "8", "]"}], "+", 
                   RowBox[{
                    RowBox[{"\[Alpha]", "[", "8", "]"}], " ", 
                    RowBox[{
                    "\[Zeta]", "[", "9", "]"}]}]}]]}]]}]]}]]}]]}]]}]]}]]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.702821954567783*^9, 3.702991657229454*^9, 
  3.703423390757675*^9, 3.703423545797517*^9, 3.7034240695588903`*^9, 
  3.703433844907752*^9, 3.703436364995514*^9, 3.7034369470176263`*^9, 
  3.703437827102969*^9, 3.7034442826139364`*^9, 3.7034760511536856`*^9, 
  3.703509072455776*^9, 3.7035116992313476`*^9, 3.70351297871708*^9, 
  3.7035864525412364`*^9},ExpressionUUID->"581a188f-1841-4733-9c67-\
897877faf019"],

Cell[BoxData[
 RowBox[{"EQ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]", "[", "4", "]"}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Alpha]", "[", "3", "]"}], " ", 
      RowBox[{"\[Gamma]", "[", "4", "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", "3", "]"}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Alpha]", "[", "2", "]"}], " ", 
        RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
       RowBox[{
        RowBox[{"\[Beta]", "[", "2", "]"}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"\[Alpha]", "[", "1", "]"}], " ", 
          RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
         RowBox[{
          RowBox[{"\[Beta]", "[", "1", "]"}], "-", 
          FractionBox[
           RowBox[{
            RowBox[{"\[Alpha]", "[", "0", "]"}], " ", 
            RowBox[{"\[Gamma]", "[", "1", "]"}]}], 
           RowBox[{"\[Beta]", "[", "0", "]"}]]}]]}]]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Alpha]", "[", "4", "]"}], " ", 
     RowBox[{"\[Gamma]", "[", "5", "]"}]}], 
    RowBox[{
     RowBox[{"\[Beta]", "[", "5", "]"}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Alpha]", "[", "5", "]"}], " ", 
       RowBox[{"\[Gamma]", "[", "6", "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", "6", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Alpha]", "[", "6", "]"}], " ", 
         RowBox[{"\[Gamma]", "[", "7", "]"}]}], 
        RowBox[{
         RowBox[{"\[Beta]", "[", "7", "]"}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[Alpha]", "[", "7", "]"}], " ", 
           RowBox[{"\[Gamma]", "[", "8", "]"}]}], 
          RowBox[{
           RowBox[{"\[Beta]", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"\[Alpha]", "[", "8", "]"}], " ", 
            RowBox[{"\[Zeta]", "[", "9", "]"}]}]}]]}]]}]]}]]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.702821954567783*^9, 3.702991657229454*^9, 
  3.703423390757675*^9, 3.703423545797517*^9, 3.7034240695588903`*^9, 
  3.703433844907752*^9, 3.703436364995514*^9, 3.7034369470176263`*^9, 
  3.703437827102969*^9, 3.7034442826139364`*^9, 3.7034760511536856`*^9, 
  3.703509072455776*^9, 3.7035116992313476`*^9, 3.70351297871708*^9, 
  3.70358645254725*^9},ExpressionUUID->"0c1da078-9419-4400-bffb-f949166b8ef4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solCoef", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"EigenExpand", "[", "3", "]"}], "[", 
     RowBox[{"Eq5", "/.", "\[VeryThinSpace]", "LeaverCoef"}], "]"}], "//", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"Subtract", "@@", "#1"}], ",", "c"}], "]"}], "\[Equal]", 
          "0"}], "]"}], ",", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"f", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "P"}], "}"}]}], "]"}]}]}], "]"}]}], 
     "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696897693838826*^9, 3.6968978100229692`*^9}, {
   3.696897846028371*^9, 3.696897850093023*^9}, {3.6968978966253395`*^9, 
   3.696897930808184*^9}, {3.6968979787214346`*^9, 3.6968979897546473`*^9}, {
   3.696898313312232*^9, 3.6968983494104404`*^9}, {3.6968983955582523`*^9, 
   3.6968984655382347`*^9}, {3.696898701347123*^9, 3.6968987020642047`*^9}, {
   3.6968990509598217`*^9, 3.696899080689389*^9}, {3.6968992104689865`*^9, 
   3.6968993273379345`*^9}, {3.6968995302298803`*^9, 3.696899539164593*^9}, {
   3.696899656784519*^9, 3.6968997247589607`*^9}, {3.696899773276699*^9, 
   3.696899821604957*^9}, {3.696899938195272*^9, 3.6968999793475513`*^9}, {
   3.6969000142462425`*^9, 3.69690004550873*^9}, {3.6969001674004126`*^9, 
   3.6969002143194103`*^9}, {3.6969020934417152`*^9, 
   3.6969021105549097`*^9}, {3.696902207427966*^9, 3.6969022094594336`*^9}, {
   3.696902565337165*^9, 3.6969025764789906`*^9}, 3.6969026847306595`*^9, {
   3.69690291006787*^9, 3.6969029107397976`*^9}, {3.69690294749367*^9, 
   3.6969029628859534`*^9}, {3.6969030329095435`*^9, 3.696903129022656*^9}, {
   3.696903301678774*^9, 3.696903344620777*^9}, {3.6969035002470703`*^9, 
   3.696903544846188*^9}, {3.6969036820194845`*^9, 3.6969037090563364`*^9}, {
   3.696903744472954*^9, 3.696903744969306*^9}, {3.6969044243953075`*^9, 
   3.6969044276036034`*^9}, {3.6969048579040976`*^9, 3.696904861283284*^9}, {
   3.7016095867841578`*^9, 3.7016096222171173`*^9}, {3.7016098151920347`*^9, 
   3.701609815692335*^9}, 3.7016099177607803`*^9, 
   3.7034233722458396`*^9},ExpressionUUID->"90a15d28-4aa3-4364-a449-\
eae7a5603817"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptH]", "[", "l_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"l", "^", "2"}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"kp", "+", "km"}], ")"}], "2"]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"l", "^", "2"}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"kp", "-", "km"}], ")"}], "2"]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["l", "2"], "-", 
       SuperscriptBox["s", "2"]}], ")"}]}], 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["l", "2"], "-", 
       RowBox[{"1", "/", "4"}]}], ")"}], 
     SuperscriptBox["l", "3"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EigenCoef", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l", "+", 
      SuperscriptBox["l", "2"], "-", 
      RowBox[{"s", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "s"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "m", " ", 
       SuperscriptBox["s", "2"]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}]}]], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[ScriptH]", "[", 
       RowBox[{"l", "+", "1"}], "]"}], "-", 
      RowBox[{"\[ScriptH]", "[", "l", "]"}], "-", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"\[ScriptH]", "[", "l", "]"}], "m", " ", 
        SuperscriptBox["s", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "-", "1"}], ")"}], 
        SuperscriptBox["l", "2"], 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "1"}], "]"}], "m", " ", 
        SuperscriptBox["s", "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], "2"], "l", 
        RowBox[{"(", 
         RowBox[{"l", "+", "2"}], ")"}]}]]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["s", "4"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "4"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"4", " ", 
           RowBox[{"\[ScriptH]", "[", "l", "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", "l", ")"}], "4"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "2"]}]]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "2"}], ")"}], 
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "1"}], "]"}], 
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "2"}], "]"}]}], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l"}], "+", "3"}], ")"}]}]], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "1"}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"\[ScriptH]", "[", "l", "]"}], 
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "1"}], "]"}]}], 
       RowBox[{"2", "l", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[ScriptH]", "[", "l", "]"}], "2"], 
       RowBox[{"2", " ", "l"}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "-", "1"}], ")"}], 
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "-", "1"}], "]"}], 
        RowBox[{"\[ScriptH]", "[", "l", "]"}]}], 
       RowBox[{"2", "l", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l"}], "-", "1"}], ")"}]}]]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "3"], 
       SuperscriptBox["s", "6"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"8", " ", 
           RowBox[{"\[ScriptH]", "[", "l", "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "6"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "3"]}]], "-", 
         FractionBox[
          RowBox[{"8", " ", 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", "l", ")"}], "3"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "6"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "3"]}]]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["s", "2"], 
       RowBox[{"\[ScriptH]", "[", "l", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"\[ScriptH]", "[", 
             RowBox[{"l", "+", "1"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"7", " ", 
               SuperscriptBox["l", "2"]}], "+", 
              RowBox[{"7", "l"}], "+", "4"}], ")"}]}], 
           RowBox[{
            SuperscriptBox["l", "3"], 
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "3"], 
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}]}]]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "-", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "l"}], "-", "4"}], ")"}]}], 
          RowBox[{
           SuperscriptBox["l", "3"], 
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"l", "-", "2"}], ")"}]}]]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["s", "2"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "l"}], "+", "7"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "1"}], "]"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "2"}], "]"}]}], 
          RowBox[{"l", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], 
           RowBox[{"(", 
            RowBox[{"l", "+", "3"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "l"}], "+", "3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"\[ScriptH]", "[", 
             RowBox[{"l", "+", "1"}], "]"}], "2"]}], 
          RowBox[{"l", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], 
           RowBox[{"(", 
            RowBox[{"l", "+", "2"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"\[ScriptH]", "[", "l", "]"}], "2"]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "-", "1"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", "l", ")"}], "3"], 
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}]}]]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"16", " ", 
         SuperscriptBox["m", "4"], 
         SuperscriptBox["s", "8"]}], 
        RowBox[{
         SuperscriptBox["l", "4"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}], "4"]}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[ScriptH]", "[", 
           RowBox[{"l", "+", "1"}], "]"}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "4"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "4"]}]], "-", 
         FractionBox[
          RowBox[{"\[ScriptH]", "[", "l", "]"}], 
          RowBox[{
           SuperscriptBox["l", "4"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "4"]}]]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["m", "2"], 
         SuperscriptBox["s", "4"]}], 
        RowBox[{
         SuperscriptBox["l", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}], "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["l", "2"]}], "+", 
              RowBox[{"14", "l"}], "+", "17"}], ")"}], 
            RowBox[{"\[ScriptH]", "[", 
             RowBox[{"l", "+", "1"}], "]"}], 
            RowBox[{"\[ScriptH]", "[", 
             RowBox[{"l", "+", "2"}], "]"}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "3"], 
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "3"}], ")"}], "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l"}], "+", "3"}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"\[ScriptH]", "[", 
             RowBox[{"l", "+", "1"}], "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"\[ScriptH]", "[", "l", "]"}], "2"]}], 
          RowBox[{
           SuperscriptBox["l", "3"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "2"]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"11", " ", 
              SuperscriptBox["l", "4"]}], "+", 
             RowBox[{"22", " ", 
              SuperscriptBox["l", "3"]}], "+", 
             RowBox[{"31", 
              SuperscriptBox["l", "2"]}], "+", 
             RowBox[{"20", "l"}], "+", "6"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", "l", "]"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], 
           RowBox[{"(", 
            RowBox[{"l", "+", "2"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "3"}], ")"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "l"}], "+", "3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["l", "2"]}], "-", 
             RowBox[{"8", "l"}], "+", "6"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", "l", "]"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "-", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "3"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "2"}], ")"}], "2"], 
           RowBox[{"(", 
            RowBox[{"l", "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "l"}], "-", "1"}], ")"}]}]]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"\[ScriptH]", "[", 
          RowBox[{"l", "+", "1"}], "]"}], 
         RowBox[{"\[ScriptH]", "[", 
          RowBox[{"l", "+", "2"}], "]"}]}], 
        RowBox[{"4", 
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "l"}], "+", "3"}], ")"}], "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "+", "3"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "+", "3"}], "]"}]}], "3"], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"l", "+", "2"}], 
           RowBox[{"l", "+", "1"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "+", "2"}], ")"}], 
             RowBox[{"\[ScriptH]", "[", 
              RowBox[{"l", "+", "2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"7", "l"}], "+", "10"}], ")"}], 
             RowBox[{"\[ScriptH]", "[", 
              RowBox[{"l", "+", "1"}], "]"}]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", 
                 SuperscriptBox["l", "2"]}], "+", 
                RowBox[{"2", "l"}], "-", "3"}], ")"}], 
              RowBox[{"\[ScriptH]", "[", "l", "]"}]}], "l"]}], ")"}]}]}], 
        ")"}]}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[ScriptH]", "[", 
         RowBox[{"l", "+", "1"}], "]"}], "3"], 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], "2"]}]], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[ScriptH]", "[", "l", "]"}], "3"], 
       RowBox[{"2", 
        SuperscriptBox["l", "2"]}]], "+", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"\[ScriptH]", "[", "l", "]"}], 
         RowBox[{"\[ScriptH]", "[", 
          RowBox[{"l", "+", "1"}], "]"}]}], 
        RowBox[{"4", 
         SuperscriptBox["l", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}], "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             SuperscriptBox["l", "2"]}], "+", 
            RowBox[{"4", "l"}], "+", "3"}], ")"}], 
          RowBox[{"\[ScriptH]", "[", "l", "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             SuperscriptBox["l", "2"]}], "+", "1"}], ")"}], 
          RowBox[{"\[ScriptH]", "[", 
           RowBox[{"l", "+", "1"}], "]"}]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["l", "2"], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", 
              SuperscriptBox["l", "2"]}], "+", 
             RowBox[{"4", "l"}], "-", "2"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "-", "1"}], "]"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "l"}], "-", "1"}], ")"}], "2"]]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"\[ScriptH]", "[", 
          RowBox[{"l", "-", "1"}], "]"}], 
         RowBox[{"\[ScriptH]", "[", "l", "]"}]}], 
        RowBox[{"4", 
         SuperscriptBox["l", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "l"}], "-", "1"}], ")"}], "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"7", "l"}], "-", "3"}], ")"}], 
          RowBox[{"\[ScriptH]", "[", "l", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"l", "-", "1"}], ")"}], "2"], 
          RowBox[{"\[ScriptH]", "[", 
           RowBox[{"l", "-", "1"}], "]"}]}], "-", 
         FractionBox[
          RowBox[{"l", 
           RowBox[{"(", 
            RowBox[{"l", "-", "2"}], ")"}], 
           RowBox[{"\[ScriptH]", "[", 
            RowBox[{"l", "-", "2"}], "]"}]}], "3"]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6969011285519958`*^9, 3.6969011324935484`*^9}, {
   3.6969011659913445`*^9, 3.6969012202364473`*^9}, {3.696901327887189*^9, 
   3.6969015025811443`*^9}, {3.6969015693431063`*^9, 3.696901572984157*^9}, {
   3.6969026968100553`*^9, 3.6969027076549873`*^9}, 3.701609618051126*^9, {
   3.703423591881917*^9, 3.7034236704098473`*^9}, {3.7034238833120475`*^9, 
   3.7034238925828934`*^9}, {3.703424216506015*^9, 3.703424234390072*^9}, {
   3.703424334955464*^9, 3.703424354541221*^9}, {3.7034410732687063`*^9, 
   3.703441073768569*^9}, {3.7034427127387295`*^9, 3.7034427381535125`*^9}, {
   3.703442788140403*^9, 3.703442847234208*^9}, {3.7034428976362925`*^9, 
   3.703443126462391*^9}, {3.7034431863162613`*^9, 3.7034433036044436`*^9}, {
   3.70344339021253*^9, 3.703443485943907*^9}, {3.703443600245612*^9, 
   3.703443833301114*^9}, {3.703443880902014*^9, 
   3.7034442328631907`*^9}},ExpressionUUID->"6f7c3254-5678-4eef-ba1c-\
771ceca728fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"EigenCoef", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"P", "+", "1"}]}], "]"}], "]"}], "==", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"f", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "P"}], "}"}]}], "]"}]}], "/.", 
     "solCoef"}], ")"}], "//", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"#", "/.", 
        RowBox[{"{", 
         RowBox[{"l", "\[Rule]", 
          RowBox[{"R", "+", "km", "+", "kp"}]}], "}"}]}], "]"}], "/.", 
      "ruleRemoveM"}], ")"}], "&"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6969015883925395`*^9, 3.696901615582964*^9}, {
   3.6969019319655294`*^9, 3.6969019540302787`*^9}, {3.6969020656885834`*^9, 
   3.6969020886285596`*^9}, {3.6969021189019938`*^9, 
   3.6969021309397383`*^9}, {3.696902177061597*^9, 3.696902227761679*^9}, {
   3.696902264174205*^9, 3.696902314921118*^9}, {3.696902710030368*^9, 
   3.696902899973031*^9}, {3.696902996436449*^9, 3.696903009032114*^9}, {
   3.69690318331133*^9, 3.6969031862802477`*^9}, {3.696903357606527*^9, 
   3.696903386015975*^9}, {3.6969034889488506`*^9, 3.6969034941526423`*^9}, {
   3.6969036232677507`*^9, 3.696903663257097*^9}, {3.696904802891508*^9, 
   3.6969048147825193`*^9}, {3.6969048958594675`*^9, 3.6969049099783087`*^9}, 
   3.7016095958545732`*^9, {3.7016096275445366`*^9, 3.701609652034605*^9}, {
   3.7016097919713244`*^9, 3.7016098033782663`*^9}, {3.7016100259485483`*^9, 
   3.701610051365368*^9}, {3.7016102212676573`*^9, 3.701610227809352*^9}, 
   3.7034233791046653`*^9, 3.70342358145457*^9, {3.703424250395834*^9, 
   3.7034242736335287`*^9}},ExpressionUUID->"e26ece02-d7b2-43a4-8aa1-\
9a5a9ba4cf6a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.70282206508844*^9, 3.703423490807138*^9, 
  3.703423629784117*^9, 3.7034236744473658`*^9, 3.703433931793253*^9, 
  3.7034364612729826`*^9, 3.703437039163971*^9, 3.703437902764553*^9, 
  3.703444361812713*^9, 3.7034761366572104`*^9, 3.703509153845769*^9, 
  3.7035117870223885`*^9, 3.7035130612680798`*^9, 
  3.703586548285309*^9},ExpressionUUID->"1c71fc5c-0163-4daf-9588-\
1ca204f5542c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "@", "EigenLeaver"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EigenLeaver", "[", 
   RowBox[{"\[ScriptS]_Integer", ",", 
    RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
    "\[ScriptM]_Integer", ",", 
    RowBox[{"\[ScriptC]_Real", "?", "Negative"}], ",", 
    RowBox[{"M_Integer:", "150"}]}], "]"}], ":=", 
  RowBox[{"EigenLeaver", "[", 
   RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", 
    RowBox[{"-", "\[ScriptM]"}], ",", 
    RowBox[{"-", "\[ScriptC]"}], ",", "M"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EigenLeaver", "[", 
   RowBox[{
    RowBox[{"\[ScriptS]_Integer", "?", "Negative"}], ",", 
    RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
    "\[ScriptM]_Integer", ",", "\[ScriptC]_Real", ",", 
    RowBox[{"M_Integer:", "150"}]}], "]"}], ":=", 
  RowBox[{"EigenLeaver", "[", 
   RowBox[{
    RowBox[{"-", "\[ScriptS]"}], ",", "\[ScriptL]", ",", "\[ScriptM]", ",", 
    "\[ScriptC]", ",", "M"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenLeaver", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", "\[ScriptC]_Real", ",", 
     RowBox[{"M_Integer:", "150"}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
       RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ScriptS]", 
      RowBox[{"(", 
       RowBox[{"\[ScriptS]", "+", "1"}], ")"}]}], "+", "A"}], ")"}], "/.", 
   RowBox[{"Quiet", "@", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Fold", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]", "[", 
             RowBox[{"#2", "-", "1"}], "]"}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"\[Alpha]", "[", 
               RowBox[{"#2", "-", "1"}], "]"}], 
              RowBox[{"\[Gamma]", "[", "#2", "]"}]}], "#1"]}], ")"}], "&"}], 
         ",", "1", ",", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Range", "[", "M", "]"}]}]}], "]"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"LeaverCoef", "/.", "Rule\[Kappa]pm"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
           RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
           RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
           RowBox[{"c", "\[Rule]", "\[ScriptC]"}]}], "}"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["c", 
             RowBox[{"i", "-", "1"}]], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "EigenCoef"}]}], "}"}]}], "]"}], ".", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"EigenCoef", "/.", "Rule\[Kappa]pm"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
              RowBox[{"s", "\[Rule]", "\[ScriptS]"}]}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
           RowBox[{"c", "\[Rule]", "\[ScriptC]"}]}], "}"}]}]}], "}"}]}], 
     "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7034333272775865`*^9, 3.7034337085367956`*^9}, {
   3.7034337538324566`*^9, 3.7034338370078773`*^9}, {3.703433955824809*^9, 
   3.7034339859904723`*^9}, {3.703434036120545*^9, 3.703434055722438*^9}, {
   3.7034342907058*^9, 3.703434377924431*^9}, {3.7034344230764093`*^9, 
   3.703434428512546*^9}, {3.7034345693652644`*^9, 3.703434588389862*^9}, {
   3.703436070456457*^9, 3.703436095785615*^9}, {3.703436366629074*^9, 
   3.7034363925657835`*^9}, 3.703436865359313*^9, {3.703436931823924*^9, 
   3.7034369353837166`*^9}, {3.7034378046660256`*^9, 
   3.7034378120908146`*^9}, {3.7034379547906265`*^9, 3.703437987009841*^9}, {
   3.7034380726386514`*^9, 3.7034381151018*^9}, {3.703438145208186*^9, 
   3.703438149497014*^9}, {3.703438180665821*^9, 3.7034382157500887`*^9}, {
   3.7034386030567384`*^9, 3.703438605312915*^9}, {3.7034400727314754`*^9, 
   3.7034400729157596`*^9}, {3.7034401961576867`*^9, 3.703440198361365*^9}, {
   3.7034772743480344`*^9, 3.7034772762623453`*^9}, {3.703477308516965*^9, 
   3.7034773086852474`*^9}, {3.7034817042677937`*^9, 3.703481725815775*^9}, {
   3.7034817709268904`*^9, 3.7034817838542852`*^9}, {3.7034818572537966`*^9, 
   3.7034818784249787`*^9}, {3.703481908920104*^9, 3.7034819286675253`*^9}, {
   3.7034819945284095`*^9, 3.7034819982924786`*^9}, {3.703482127656019*^9, 
   3.7034821750530176`*^9}, {3.7034822100330553`*^9, 
   3.7034822567837663`*^9}, {3.7034822901233983`*^9, 3.703482300020621*^9}, {
   3.70348235225161*^9, 3.70348241590591*^9}, {3.7034824879563026`*^9, 
   3.7034824881720877`*^9}, {3.7034825541065364`*^9, 
   3.7034825698488884`*^9}, {3.7034826483859158`*^9, 3.703482650025302*^9}, {
   3.7034827276156187`*^9, 3.7034827320775356`*^9}, 3.703482791659976*^9, {
   3.7034828550978518`*^9, 3.7034829173842936`*^9}, {3.7034829813969336`*^9, 
   3.703482986798423*^9}, {3.7034841079129624`*^9, 3.703484108560174*^9}, {
   3.7035057840784063`*^9, 3.703505787751629*^9}, {3.7035065025502625`*^9, 
   3.7035065208943663`*^9}, {3.703506801807128*^9, 3.7035068096728067`*^9}, {
   3.7035069584363017`*^9, 3.703506959771234*^9}, {3.7035116314049854`*^9, 
   3.7035116350408063`*^9}, {3.7035124139731617`*^9, 
   3.7035124172415032`*^9}, {3.7035124476350145`*^9, 3.703512519526556*^9}, {
   3.7035125707516136`*^9, 
   3.7035126444675865`*^9}},ExpressionUUID->"0169d4d3-df79-4e3d-bf79-\
78c01b1e2afc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"CreateDirectory", "[", "\"\<Definitions\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteFile", "[", "\"\<Definitions/Eigenvalues.wl\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Save", "[", 
  RowBox[{"\"\<Definitions/Eigenvalues.wl\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\[ScriptH]", ",", "LeaverCoef", ",", "EigenCoef", ",", "Rule\[Kappa]pm", 
     ",", "EigenLeaver"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7034238427155776`*^9, 3.7034239113843813`*^9}, {
  3.7034239921738987`*^9, 3.703424039028339*^9}, {3.7034240948825045`*^9, 
  3.7034240978257227`*^9}, {3.703424206406002*^9, 3.7034242103768954`*^9}, {
  3.7034243312011733`*^9, 3.7034243572052746`*^9}, {3.703424501052042*^9, 
  3.703424505307171*^9}, {3.7034346039127693`*^9, 3.7034346116231747`*^9}, {
  3.703437053474764*^9, 3.703437055021116*^9}, {3.7035124885836487`*^9, 
  3.7035124918515425`*^9}},ExpressionUUID->"1673abef-997b-4132-a01f-\
86e5e08c11b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data0", "=", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"0", "\[Rule]", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptC]", ",", 
         RowBox[{"EigenLeaver", "[", 
          RowBox[{"0", ",", "0", ",", "0", ",", "\[ScriptC]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[ScriptC]", ",", "0", ",", "3.001", ",", "0.002"}], "}"}]}],
       "]"}]}], "\[RightAssociation]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"GetSWSHEigenFile", "[", 
     RowBox[{"0", ",", "0", ",", "0"}], "]"}], ",", 
    RowBox[{"data0", "[", "0", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.703506566387869*^9, 3.7035065795455694`*^9}, {
   3.703506613546652*^9, 3.7035066649878254`*^9}, {3.703506695715166*^9, 
   3.7035066965447645`*^9}, {3.70350675725056*^9, 3.7035068167428265`*^9}, 
   3.7035072331928015`*^9, {3.703507366683592*^9, 3.7035074579044437`*^9}, {
   3.7035075397854443`*^9, 3.7035075421216545`*^9}, {3.703508426736343*^9, 
   3.7035084353978643`*^9}, {3.7035086392932267`*^9, 
   3.7035086983971643`*^9}, {3.703508868709467*^9, 3.703508937969694*^9}, {
   3.7035116423579426`*^9, 3.7035116792808704`*^9}, 3.7035125005970793`*^9, {
   3.703512955469304*^9, 3.7035129673018856`*^9}, {3.703586411357026*^9, 
   3.70358641399065*^9}, 3.7035866726864796`*^9, {3.7035868330603695`*^9, 
   3.7035868407004194`*^9}, 3.7035869246892815`*^9, {3.7035872102370424`*^9, 
   3.7035872157246313`*^9}, 
   3.7035872975246553`*^9},ExpressionUUID->"075c59d5-3627-464e-9a5c-\
22d9c7996678"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "\[Rule]", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", 
          RowBox[{"EigenLeaver", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"+", "1"}], ",", "\[ScriptC]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", "0", ",", "3.001", ",", "0.002"}], 
         "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"0", "\[Rule]", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", 
          RowBox[{"EigenLeaver", "[", 
           RowBox[{"1", ",", "1", ",", "0", ",", "\[ScriptC]"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", "0", ",", "3.001", ",", "0.002"}], 
         "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "1"}], "\[Rule]", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", 
          RowBox[{"EigenLeaver", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "\[ScriptC]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ScriptC]", ",", "0", ",", "3.001", ",", "0.002"}], 
         "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "\[RightAssociation]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"GetSWSHEigenFile", "[", 
       RowBox[{"1", ",", "1", ",", "#"}], "]"}], ",", 
      RowBox[{"data1", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.703506566387869*^9, 3.7035065795455694`*^9}, {
   3.703506613546652*^9, 3.7035066649878254`*^9}, {3.703506695715166*^9, 
   3.7035066965447645`*^9}, {3.70350675725056*^9, 3.7035068167428265`*^9}, 
   3.7035072331928015`*^9, {3.703507366683592*^9, 3.7035074579044437`*^9}, {
   3.7035075397854443`*^9, 3.7035075421216545`*^9}, {3.703508426736343*^9, 
   3.7035084353978643`*^9}, {3.7035086392932267`*^9, 
   3.7035086983971643`*^9}, {3.703508868709467*^9, 3.703508937969694*^9}, {
   3.7035116423579426`*^9, 3.7035116792808704`*^9}, 3.7035125005970793`*^9, {
   3.703512955469304*^9, 3.7035129673018856`*^9}, {3.703586411357026*^9, 
   3.70358641399065*^9}, 3.7035866726864796`*^9, {3.703586852365508*^9, 
   3.7035868526993093`*^9}, {3.7035869079945693`*^9, 
   3.7035869232066464`*^9}},ExpressionUUID->"f808fafd-55f1-4e9e-8898-\
d9f8d4e1af56"]
},
WindowSize->{958, 966},
WindowMargins->{{Automatic, -8}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 526, 13, 66, "Input", "ExpressionUUID" -> \
"148e6e94-360f-40f5-8cb7-5d267bc278b3"],
Cell[1087, 35, 195, 4, 40, "Input", "ExpressionUUID" -> \
"4566e237-19ba-40ed-b56a-12762223c782"],
Cell[1285, 41, 2062, 55, 128, "Input", "ExpressionUUID" -> \
"97f9b131-065b-4c40-96f6-cccd3bf352cd"],
Cell[3350, 98, 9557, 242, 383, "Input", "ExpressionUUID" -> \
"ac607677-f02f-41a9-beba-c6bb43821444"],
Cell[CellGroupData[{
Cell[12932, 344, 668, 21, 84, "Input", "ExpressionUUID" -> \
"508a9dcd-4c05-4a5d-9fc8-8bb2fc42d1b5"],
Cell[13603, 367, 3218, 92, 160, "Output", "ExpressionUUID" -> \
"710bb7b2-be17-4b7c-a8a6-08c0e48fe81d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16858, 464, 3286, 59, 130, "Input", "ExpressionUUID" -> \
"5230742f-801a-4865-8fa0-181a985263fc"],
Cell[20147, 525, 3662, 96, 76, "Output", "ExpressionUUID" -> \
"4988cfaf-a94f-4fae-976b-6486fe90f6a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23846, 626, 1808, 34, 40, "Input", "ExpressionUUID" -> \
"c4ef024f-3333-48cb-8c39-69eb8355c9b6"],
Cell[25657, 662, 4043, 105, 144, "Output", "ExpressionUUID" -> \
"b2c350e1-f850-4726-9a14-03843b0c5588"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29737, 772, 2970, 68, 196, "Input", "ExpressionUUID" -> \
"98d2d280-69ad-4c98-873d-46240746f7aa"],
Cell[32710, 842, 4234, 114, 139, "Output", "ExpressionUUID" -> \
"85d5e0cd-a205-4dfc-8f1b-2a88342b7abc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36981, 961, 1132, 26, 67, "Input", "ExpressionUUID" -> \
"f75f095a-009a-4b11-b413-aa673b8ac57e"],
Cell[38116, 989, 3404, 98, 112, "Output", "ExpressionUUID" -> \
"02f52239-8a01-4339-a069-3b93610eccca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41557, 1092, 1956, 45, 67, "Input", "ExpressionUUID" -> \
"8eb6cffe-dd61-49c9-91c2-379dd4a6ed5b"],
Cell[43516, 1139, 3155, 90, 105, "Output", "ExpressionUUID" -> \
"7549b7f4-518e-46a5-afcf-574a106fbe69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46708, 1234, 1707, 41, 40, "Input", "ExpressionUUID" -> \
"3bb8ccdc-4b1b-4db1-b428-3bd124098e57"],
Cell[48418, 1277, 1486, 39, 45, "Output", "ExpressionUUID" -> \
"9c0f36af-b7fd-4b86-a01e-eefe2b0e39f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49941, 1321, 477, 14, 40, "Input", "ExpressionUUID" -> \
"a79f5db8-8238-491c-9eb5-2b0d3d11ac7e"],
Cell[50421, 1337, 766, 20, 65, "Output", "ExpressionUUID" -> \
"1363203c-ab70-42b3-9e84-bcdf0d4b3b63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51224, 1362, 1430, 39, 116, "Input", "ExpressionUUID" -> \
"6d9bf075-6f2e-455f-838f-0dc479aea658"],
Cell[52657, 1403, 479, 8, 40, "Output", "ExpressionUUID" -> \
"c47426c1-034a-4567-ad89-6803d66ab226"]
}, Open  ]],
Cell[53151, 1414, 4090, 102, 194, "Input", "ExpressionUUID" -> \
"f990333a-e03a-4819-b934-080d27093453"],
Cell[57244, 1518, 577, 15, 66, "Input", "ExpressionUUID" -> \
"ce445997-cc3f-4c30-945e-fc03fd417211"],
Cell[CellGroupData[{
Cell[57846, 1537, 1356, 34, 66, "Input", "ExpressionUUID" -> \
"64e202a8-bf3d-44b1-85e7-9467bf3312fa"],
Cell[59205, 1573, 2532, 63, 189, "Output", "ExpressionUUID" -> \
"581a188f-1841-4733-9c67-897877faf019"],
Cell[61740, 1638, 2306, 61, 117, "Output", "ExpressionUUID" -> \
"0c1da078-9419-4400-bffb-f949166b8ef4"]
}, Open  ]],
Cell[64061, 1702, 2406, 46, 91, "Input", "ExpressionUUID" -> \
"90a15d28-4aa3-4364-a449-eae7a5603817"],
Cell[66470, 1750, 18386, 546, 1188, "Input", "ExpressionUUID" -> \
"6f7c3254-5678-4eef-ba1c-771ceca728fe"],
Cell[CellGroupData[{
Cell[84881, 2300, 1837, 40, 66, "Input", "ExpressionUUID" -> \
"e26ece02-d7b2-43a4-8aa1-9a5a9ba4cf6a"],
Cell[86721, 2342, 440, 7, 40, "Output", "ExpressionUUID" -> \
"1c71fc5c-0163-4daf-9588-1ca204f5542c"]
}, Open  ]],
Cell[87176, 2352, 5957, 128, 363, "Input", "ExpressionUUID" -> \
"0169d4d3-df79-4e3d-bf79-78c01b1e2afc"],
Cell[93136, 2482, 1023, 20, 91, "Input", "ExpressionUUID" -> \
"1673abef-997b-4132-a01f-86e5e08c11b2"],
Cell[94162, 2504, 1635, 34, 66, "Input", "ExpressionUUID" -> \
"075c59d5-3627-464e-9a5c-22d9c7996678"],
Cell[95800, 2540, 2722, 63, 166, "Input", "ExpressionUUID" -> \
"f808fafd-55f1-4e9e-8898-d9f8d4e1af56"]
}
]
*)

