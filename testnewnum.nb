(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41760,       1002]
NotebookOptionsPosition[     38986,        931]
NotebookOutlinePosition[     39351,        947]
CellTagsIndexPosition[     39308,        944]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.7033627187934713`*^9, 
  3.7033627375920715`*^9}},ExpressionUUID->"635912c0-03e9-4381-afd0-\
4c505068a1c5"],

Cell[BoxData[{
 RowBox[{"Clear", "@", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702711036582342*^9, 3.70271104805758*^9}, {
   3.7027371697054696`*^9, 3.7027371821475344`*^9}, {3.7027959869031916`*^9, 
   3.7027959894965734`*^9}, 3.703025237991789*^9, {3.7063521189576783`*^9, 
   3.706352119834443*^9}, {3.7096437558345213`*^9, 
   3.7096437563200984`*^9}},ExpressionUUID->"6e182e77-3e32-4c82-b1e7-\
f2f42c604e1c"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<Definitions/IO.wl\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<Definitions/Teukolsky.wl\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<Definitions/SWSH.wl\>\""}]}], "Input",
 CellChangeTimes->{{3.7034261308962336`*^9, 3.7034261407476673`*^9}, {
  3.7096437510192585`*^9, 
  3.70964375172172*^9}},ExpressionUUID->"86ce71a9-e65b-4f70-95ca-\
70da6fcfdb9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation and and Eigenvalue function", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.70351515787132*^9, 
  3.703515163192911*^9}},ExpressionUUID->"d8f926b8-da75-401f-8d2f-\
516011e55937"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleRepresentationR", "=", 
   RowBox[{"{", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "+", "\[Tau]"}], ")"}], "x"}], ")"}], 
         RowBox[{
          RowBox[{"-", "s"}], "/", "2"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Tau]"}], ")"}], "+", 
           RowBox[{"x", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "x"}], ")"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], 
        RowBox[{"\[Psi]", "[", "x", "]"}]}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", "\[Tau]"}], ")"}], "+", 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "x"}], ")"}]}]}], ")"}], 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"x", "+", "\[Tau]"}], ")"}]}], ")"}], 
        RowBox[{"1", "+", 
         RowBox[{"s", "/", "2"}]}]], " ", "EqTeukolskyRadial"}], "/.", 
      "RuleKRadial"}], "/.", "RuleRepresentationR"}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Psi]", "'"}], "[", "x", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Psi]", "''"}], "[", "x", "]"}]}], "}"}], ",", 
       "FullSimplify"}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7098904460551405`*^9, 3.7098905712646604`*^9}, {
   3.7098906080835075`*^9, 3.709890643848914*^9}, {3.709890807513398*^9, 
   3.709890856422037*^9}, {3.7098908992492485`*^9, 3.709890956591057*^9}, 
   3.7098911756904907`*^9, {3.7099295221842003`*^9, 3.709929538796069*^9}, {
   3.7099310894490085`*^9, 
   3.709931122765605*^9}},ExpressionUUID->"66ecc3e1-f825-4077-927b-\
a0042f16a644"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "@", "\[ScriptCapitalE]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", 
     RowBox[{"\[ScriptC]_Real", "?", "Negative"}]}], "]"}], ":=", 
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", 
     RowBox[{"-", "\[ScriptM]"}], ",", 
     RowBox[{"-", "\[ScriptC]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{
     RowBox[{"\[ScriptS]_Integer", "?", "Negative"}], ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", "\[ScriptC]_Real"}], "]"}], ":=", 
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{
     RowBox[{"-", "\[ScriptS]"}], ",", "\[ScriptL]", ",", "\[ScriptM]", ",", 
     "\[ScriptC]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalE]", "[", 
     RowBox[{"\[ScriptS]_Integer", ",", 
      RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
      "\[ScriptM]_Integer", ",", "\[ScriptC]_Real"}], "]"}], "/;", 
    RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
       RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}]}], ":=", 
   RowBox[{"SpinWeightedSpheroidalHarmonicEigenvalue", "[", 
    RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]", ",", 
     RowBox[{"N", "@", "\[ScriptC]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7035151705022197`*^9, 3.7035151705042243`*^9}, {
   3.706879940453324*^9, 3.7068799443915544`*^9}, {3.706879974675466*^9, 
   3.706879989889987*^9}, 3.7068913269388695`*^9, {3.7071743767140055`*^9, 
   3.707174377267609*^9}, {3.7094166772475576`*^9, 3.7094167447906375`*^9}, {
   3.7094167998954697`*^9, 3.709416801270966*^9}, {3.709643805467862*^9, 
   3.709643847268909*^9}, {3.7097619491194663`*^9, 3.709761952446012*^9}, 
   3.709762355915002*^9, {3.709762604058507*^9, 3.709762648344144*^9}, {
   3.7099267603854322`*^9, 
   3.7099267611181316`*^9}},ExpressionUUID->"d0109ee9-535f-452a-9bb6-\
9fea8aa507ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter rules and equation simplification ", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 
  3.703362850927506*^9}},ExpressionUUID->"5357542e-ce2d-443a-88a6-\
76e88ae89865"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleNDS", "=", 
   RowBox[{"{", 
    RowBox[{"\[Psi]", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "s"}], "/", "2"}], "-", 
          RowBox[{"I", " ", 
           RowBox[{"\[Chi]", "/", "\[Tau]"}]}]}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "\[Tau]"}], ")"}], 
         RowBox[{
          RowBox[{"-", "s"}], "/", "2"}]], 
        RowBox[{"f", "[", "x", "]"}]}]}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EquationNDS", "=", 
    RowBox[{"PowerExpand", "@", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       SuperscriptBox["x", 
        RowBox[{
         RowBox[{"s", "/", "2"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"\[Chi]", "/", "\[Tau]"}]}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", "\[Tau]"}], ")"}], 
        RowBox[{"s", "/", "2"}]], 
       RowBox[{"(", 
        RowBox[{"Eq", "/.", "\[VeryThinSpace]", "RuleNDS"}], ")"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"all", " ", "params"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleBoundaryBH", "=", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptA]", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"\[ScriptB]", "[", "0", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[ScriptCapitalB]"}], " ", 
        SuperscriptBox["\[Tau]", "2"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"\[Tau]", "/", "2"}]}], "+", "\[Chi]"}], ")"}], " ", 
        "\[Chi]"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleParams", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Tau]", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}], 
       RowBox[{"1", "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]]}], ",", 
     RowBox[{
      OverscriptBox["\[CapitalOmega]", "_"], "\[Rule]", 
      FractionBox["\[ScriptCapitalJ]", "2"]}], ",", 
     RowBox[{"\[Chi]", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["\[Omega]", "_"], "-", 
         RowBox[{"m", " ", 
          OverscriptBox["\[CapitalOmega]", "_"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "\[Tau]"}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox["\[ScriptCapitalB]", "2"], "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", 
          RowBox[{"s", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], ")"}], "2"], "-", 
       RowBox[{"4", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\[ScriptCapitalJ]", " ", 
            OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"]}], "+", 
       RowBox[{"4", "m", " ", 
        FractionBox[
         RowBox[{"\[ScriptCapitalJ]", " ", 
          OverscriptBox["\[Omega]", "_"]}], "rp"]}]}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"], "-", 
       RowBox[{"2", "m", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}]}], "+", 
       RowBox[{"\[ScriptCapitalE]", "[", 
        RowBox[{"s", ",", "l", ",", "m", ",", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"]}], "]"}], "-", 
       RowBox[{"s", 
        RowBox[{"(", 
         RowBox[{"s", "+", "1"}], ")"}]}]}]}], ",", 
     RowBox[{"rp", "\[Rule]", 
      RowBox[{"1", "+", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, 3.7028161983950057`*^9, {3.702816611930849*^9, 
   3.7028166547282743`*^9}, {3.7028167501933465`*^9, 
   3.7028167732842445`*^9}, {3.7028168846283855`*^9, 3.70281688880552*^9}, {
   3.7029016974222364`*^9, 3.70290170884544*^9}, {3.702901862018824*^9, 
   3.702901864895048*^9}, {3.702901895399967*^9, 3.7029018989044437`*^9}, {
   3.7029019328300767`*^9, 3.7029019896379337`*^9}, {3.70290219926057*^9, 
   3.7029022007316165`*^9}, {3.7029022527030687`*^9, 
   3.7029022631707344`*^9}, {3.7029026136404552`*^9, 3.702902656213641*^9}, {
   3.702902690280937*^9, 3.7029026966091814`*^9}, {3.702902791524929*^9, 
   3.7029028268302794`*^9}, {3.702903355065157*^9, 3.702903357115694*^9}, {
   3.7030173782222605`*^9, 3.7030173785248013`*^9}, 3.7030177866537313`*^9, 
   3.703019752454656*^9, {3.7030261457916284`*^9, 3.703026153649619*^9}, {
   3.7030262182789373`*^9, 3.7030262384393153`*^9}, {3.7030269098741713`*^9, 
   3.7030269300308614`*^9}, {3.703248695988945*^9, 3.7032486981768*^9}, {
   3.7032490587471266`*^9, 3.7032490647165127`*^9}, {3.7032491331300306`*^9, 
   3.7032491362553654`*^9}, 3.70325293884263*^9, {3.7034260301987724`*^9, 
   3.7034260374598613`*^9}, {3.703426091848958*^9, 3.7034260963162436`*^9}, {
   3.70342775054784*^9, 3.7034277628785915`*^9}, {3.703437505984835*^9, 
   3.703437546210496*^9}, {3.7034384789541245`*^9, 3.703438490266443*^9}, {
   3.703438531005536*^9, 3.7034385704851694`*^9}, 3.703440345051608*^9, {
   3.7034407029817934`*^9, 3.703440753871106*^9}, {3.7034407999035163`*^9, 
   3.7034408048922586`*^9}, {3.703441172585015*^9, 3.7034413469052525`*^9}, {
   3.703441849285493*^9, 3.7034418979956007`*^9}, {3.7034452222292843`*^9, 
   3.703445231967746*^9}, {3.7034452635698233`*^9, 3.703445303262053*^9}, {
   3.7034549506555777`*^9, 3.703454999549732*^9}, {3.7035150330725317`*^9, 
   3.7035150530406065`*^9}, {3.703584173636782*^9, 3.703584176987528*^9}, {
   3.703584253544962*^9, 3.7035842655896163`*^9}, 3.703594307822569*^9, {
   3.7035945439798045`*^9, 3.7035945450474997`*^9}, 3.703594585154419*^9, {
   3.7053001977975283`*^9, 3.7053002084549417`*^9}, {3.705302602438243*^9, 
   3.7053026120557394`*^9}, {3.7053027545327373`*^9, 3.705302809651326*^9}, {
   3.7063517689403477`*^9, 3.7063517691047087`*^9}, 3.7063521683332767`*^9, {
   3.70635230650008*^9, 3.7063523073229294`*^9}, {3.7063523569412746`*^9, 
   3.706352403819934*^9}, {3.7063574957453365`*^9, 3.706357518043539*^9}, {
   3.7063580360651145`*^9, 3.70635806391311*^9}, {3.7063584251737013`*^9, 
   3.7063584439833603`*^9}, {3.706364468039626*^9, 3.706364496976085*^9}, {
   3.706365435818508*^9, 3.706365501378791*^9}, {3.7063655334872684`*^9, 
   3.7063656045317802`*^9}, {3.70636565331085*^9, 3.7063656880630655`*^9}, {
   3.706365755440624*^9, 3.7063657600538487`*^9}, {3.706366143182962*^9, 
   3.7063661880363865`*^9}, {3.706366272866685*^9, 3.7063662776184845`*^9}, {
   3.7063663950494766`*^9, 3.7063663954979725`*^9}, {3.7063971240420694`*^9, 
   3.7063971248973837`*^9}, {3.7069051354844966`*^9, 
   3.7069051395630426`*^9}, {3.7069055070076966`*^9, 3.706905509914116*^9}, {
   3.7069527977742033`*^9, 3.7069528003823204`*^9}, {3.7069541651485057`*^9, 
   3.706954191557438*^9}, {3.7069566433859797`*^9, 3.70695666058873*^9}, {
   3.706960389204192*^9, 3.7069604163412113`*^9}, {3.706962810612523*^9, 
   3.7069628236117983`*^9}, {3.706962869554888*^9, 3.7069628733452587`*^9}, {
   3.7069630024075537`*^9, 3.706963002579363*^9}, {3.7070294762193813`*^9, 
   3.7070295344861946`*^9}, {3.7070313639422135`*^9, 3.707031369783231*^9}, {
   3.7070354229540153`*^9, 3.7070354240322657`*^9}, {3.7071312339710283`*^9, 
   3.7071312342713757`*^9}, {3.70713128434179*^9, 3.7071315225895486`*^9}, {
   3.7071323666288457`*^9, 3.707132397394799*^9}, {3.707133252430051*^9, 
   3.7071333170605135`*^9}, {3.708442772386697*^9, 3.7084427788819046`*^9}, {
   3.7094151187140255`*^9, 3.7094151707244835`*^9}, {3.7094152229869776`*^9, 
   3.70941525111843*^9}, {3.7097719132237372`*^9, 3.7097719453096223`*^9}, 
   3.7097735647798996`*^9, {3.709773626125109*^9, 3.709773645529834*^9}, {
   3.709773915176819*^9, 3.70977400699382*^9}, {3.7097743392428155`*^9, 
   3.7097743450659924`*^9}, {3.7097747088722734`*^9, 3.709774717746506*^9}, {
   3.7097748935647373`*^9, 3.709774934298211*^9}, {3.709775041638034*^9, 
   3.70977512173031*^9}, {3.7097752956291695`*^9, 3.709775298430208*^9}, {
   3.709776085012175*^9, 3.70977608880139*^9}, {3.709776154841539*^9, 
   3.709776163786888*^9}, {3.709776724302682*^9, 3.709776724516577*^9}, {
   3.7098771722340984`*^9, 3.709877172659256*^9}, {3.7098911959486036`*^9, 
   3.709891212603451*^9}, {3.709891406824709*^9, 3.7098914112466617`*^9}, {
   3.7098914944353423`*^9, 3.7098915722237487`*^9}, {3.7098916036180277`*^9, 
   3.7098916282275534`*^9}, {3.7098946696982307`*^9, 
   3.7098946744906664`*^9}, {3.709895908210964*^9, 3.709895931724802*^9}, {
   3.7099268240644197`*^9, 3.7099268390512505`*^9}, {3.709927662618761*^9, 
   3.7099276654069443`*^9}, {3.709928627951497*^9, 3.7099286673953514`*^9}, {
   3.709928988136199*^9, 
   3.709928992697152*^9}},ExpressionUUID->"58c14dba-e858-47cb-b247-\
b37d99de45ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "replace", " ", "all", " ", "parameters", " ", 
    "accordingly"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceParams", "[", 
      RowBox[{
      "\[ScriptJ]_", ",", "\[ScriptS]_", ",", "\[ScriptL]_", ",", 
       "\[ScriptM]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"PowerExpand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", "/.", "RuleBoundaryBH"}], ")"}], "//.", 
         "\[VeryThinSpace]", "RuleParams"}], "/.", "\[VeryThinSpace]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
          RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
          RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
          RowBox[{"\[ScriptCapitalJ]", "\[Rule]", "\[ScriptJ]"}]}], "}"}]}], 
       "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceParams", "[", 
      RowBox[{
      "\[ScriptJ]_", ",", "\[ScriptS]_", ",", "\[ScriptL]_", ",", 
       "\[ScriptM]_", ",", "\[ScriptW]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"PowerExpand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", "/.", "RuleBoundaryBH"}], ")"}], "//.", 
         "\[VeryThinSpace]", "RuleParams"}], "/.", "\[VeryThinSpace]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
          RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
          RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
          RowBox[{"\[ScriptCapitalJ]", "\[Rule]", "\[ScriptJ]"}], ",", 
          RowBox[{
           OverscriptBox["\[Omega]", "_"], "\[Rule]", "\[ScriptW]"}]}], 
         "}"}]}], "]"}], "&"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, {3.7028161983950057`*^9, 3.702816273289017*^9}, {
   3.7028164165232286`*^9, 3.7028164168240695`*^9}, {3.7028165633803825`*^9, 
   3.7028165680451326`*^9}, {3.7028166679089003`*^9, 
   3.7028166719379597`*^9}, {3.7032487044743595`*^9, 
   3.7032487046304893`*^9}, {3.703437424003914*^9, 3.703437428647217*^9}, {
   3.703438316102044*^9, 3.7034383169655704`*^9}, {3.703440795846078*^9, 
   3.70344082474494*^9}, {3.7034413284656897`*^9, 3.703441337947645*^9}, {
   3.703445319218295*^9, 3.7034453518337355`*^9}, {3.703448381904971*^9, 
   3.7034484337781653`*^9}, {3.705303259634863*^9, 3.7053032834829473`*^9}, {
   3.7063657948408546`*^9, 3.7063657983103943`*^9}, {3.7063658311873536`*^9, 
   3.7063658801872916`*^9}, {3.706366010468115*^9, 3.706366012468909*^9}, {
   3.7063662082155504`*^9, 3.706366215306419*^9}, {3.706366376626693*^9, 
   3.7063663884239445`*^9}, {3.70690507162611*^9, 3.706905087549555*^9}, {
   3.707131240265911*^9, 3.707131241468474*^9}, {3.707131527797324*^9, 
   3.7071315373124523`*^9}, {3.707131602193593*^9, 3.7071316359462843`*^9}, {
   3.7094151284028697`*^9, 3.7094151306219754`*^9}, {3.709775238636135*^9, 
   3.7097752536445813`*^9}, {3.7097753155957747`*^9, 3.709775321643053*^9}, {
   3.7097753827487483`*^9, 
   3.7097753924855127`*^9}},ExpressionUUID->"e268e2a4-92c8-4b13-baa8-\
3309db1b42a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Coeficients", " ", "to", " ", "estimate", " ", "f", " ", "and", " ", 
     RowBox[{"f", "'"}], " ", "close", " ", "to", " ", "BH", " ", "horizon"}],
     ",", " ", 
    RowBox[{"takes", " ", "a", " ", "while", " ", "to", " ", "compute"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nCoefBH", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleBH", "=", 
     RowBox[{"{", 
      RowBox[{"f", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"n", "=", "0"}], "nCoefBH"], 
          RowBox[{
           RowBox[{"\[ScriptA]", "[", "n", "]"}], " ", 
           SuperscriptBox["x", "n"]}]}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeriesCoefBH", "=", 
     RowBox[{"First", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rest", "@", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"Series", "[", 
             RowBox[{
              RowBox[{"EquationNDS", "/.", "RuleBH"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "nCoefBH"}], "}"}]}], "]"}], ",", 
            "x"}], "]"}]}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[ScriptA]", "[", "n", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "nCoefBH"}], "}"}]}], "]"}], "//", 
         "Evaluate"}]}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.703595207592647*^9, 3.703595284800352*^9}, {
   3.706351828316347*^9, 3.706351830699242*^9}, {3.7063561189646482`*^9, 
   3.7063561201026*^9}, {3.7063656989209957`*^9, 3.706365772922082*^9}, {
   3.7069050955660315`*^9, 3.706905101230197*^9}, {3.7069051421258163`*^9, 
   3.706905145704314*^9}, {3.7071324034563055`*^9, 3.7071324503230133`*^9}, {
   3.707174392050458*^9, 3.7071744172485795`*^9}, {3.707449574275469*^9, 
   3.7074495914336395`*^9}, {3.709812232303706*^9, 3.709812272043584*^9}, {
   3.709813264439088*^9, 3.7098132657078323`*^9}, {3.7098164339142923`*^9, 
   3.7098164339142923`*^9}, {3.709891720131977*^9, 3.709891742357741*^9}, {
   3.7098918437962565`*^9, 3.709891989876543*^9}, {3.709892048238756*^9, 
   3.709892059542981*^9}, 3.7098920927782507`*^9, {3.7098921297144585`*^9, 
   3.7098921735803137`*^9}, {3.709892268098585*^9, 3.709892273746148*^9}, {
   3.7098946791309104`*^9, 3.7098946930235443`*^9}, {3.7098954547673955`*^9, 
   3.7098954712232637`*^9}, {3.70990092730542*^9, 3.709900956494689*^9}, {
   3.70990098974006*^9, 3.709901042078935*^9}, {3.7099011007799587`*^9, 
   3.7099011941636286`*^9}, {3.7099014131970615`*^9, 
   3.7099014133346744`*^9}, {3.7099032916900625`*^9, 
   3.7099033003036585`*^9}, {3.709931160177556*^9, 
   3.709931167288705*^9}},ExpressionUUID->"6ec526f9-a64a-4f55-92dc-\
54a586dc845c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Coeficients", " ", "to", " ", "estimate", " ", "f", " ", "and", " ", 
     RowBox[{"f", "'"}], " ", "at", " ", "infinity"}], ",", " ", 
    RowBox[{"takes", " ", "a", " ", "while", " ", "to", " ", "compute"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nCoefINF", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleInINF", "=", 
     RowBox[{"{", 
      RowBox[{"\[Psi]", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{
          SuperscriptBox["x", 
           RowBox[{"s", "+", 
            RowBox[{"I", " ", 
             OverscriptBox["\[Omega]", "_"], 
             RowBox[{"(", 
              RowBox[{"2", "-", "\[Tau]"}], ")"}]}]}]], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            OverscriptBox["\[Omega]", "_"], " ", "x"}], "]"}], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"n", "=", "0"}], "nCoefINF"], 
           RowBox[{
            RowBox[{"\[ScriptCapitalI]", "[", "n", "]"}], 
            SuperscriptBox["x", 
             RowBox[{"-", "n"}]]}]}]}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{"s", "+", 
          RowBox[{"I", 
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Tau]"}], ")"}]}]}]], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", 
          OverscriptBox["\[Omega]", "_"], " ", "x"}], "]"}], "Eq"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{
              RowBox[{"-", "s"}], "-", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{"2", "-", "\[Tau]"}], ")"}], 
               OverscriptBox["\[Omega]", "_"]}]}]], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], 
              OverscriptBox["\[Omega]", "_"], " ", "x"}], "]"}], 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"n", "=", "0"}], 
              RowBox[{"nCoefINF", "+", "5"}]], 
             RowBox[{
              RowBox[{"\[ScriptCapitalH]", "[", "n", "]"}], 
              SuperscriptBox["x", 
               RowBox[{"-", "n"}]]}]}]}]}], "]"}]}], "}"}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7098933160397873`*^9, 3.7098933611044436`*^9}, {
   3.709893393919269*^9, 3.7098934563163605`*^9}, {3.709893597052805*^9, 
   3.70989388397902*^9}, {3.7098939730337334`*^9, 3.709894061808755*^9}, {
   3.7098940951254272`*^9, 3.709894120751092*^9}, {3.709894152539246*^9, 
   3.709894423755141*^9}, {3.7098946986306167`*^9, 3.709894714169548*^9}, {
   3.709894824282845*^9, 3.7098948480706477`*^9}, {3.709902923733907*^9, 
   3.709902924434922*^9}, {3.70990309110283*^9, 3.709903100769591*^9}, 
   3.70990328604443*^9, {3.709930872506048*^9, 3.7099309085257163`*^9}, {
   3.7099309731419373`*^9, 3.709931068179596*^9}, {3.709931260147678*^9, 
   3.709931264605301*^9}, {3.709931386646351*^9, 3.7099316317093267`*^9}, {
   3.7099316853374557`*^9, 
   3.7099317828537493`*^9}},ExpressionUUID->"8a6689b3-6c01-4e61-8b80-\
ea4f2e83e26e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.709930979768916*^9, 3.709931024513054*^9, {3.7099310589358625`*^9, 
   3.7099310684955254`*^9}, 3.7099312180020385`*^9, 3.709931265409445*^9, 
   3.709931488245288*^9, 3.7099315351241565`*^9, {3.7099315779095173`*^9, 
   3.7099316309774156`*^9}, {3.709931677703784*^9, 3.7099317817205567`*^9}, 
   3.7099318316351333`*^9},ExpressionUUID->"1e50ccf1-618b-40fa-9218-\
b9a9b5dd426e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeriesCoefINF", "=", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["x", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            OverscriptBox["\[Omega]", "_"], 
            RowBox[{"(", 
             RowBox[{"2", "-", "\[Tau]"}], ")"}]}], "-", "s"}]], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", 
           OverscriptBox["\[Omega]", "_"], " ", "x"}], "]"}], "Eq"}], "/.", 
        "RuleInINF"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Infinity]", ",", "nCoefINF"}], "}"}]}], "]"}]}], 
    "//", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"#1", " ", 
             SuperscriptBox["x", "nCoefINF"]}], ",", "x"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"Expand", "[", "#1", "]"}], ",", "x"}], "]"}]}], ";;", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "\[Equal]", "0"}],
         ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[ScriptY]", "[", "n", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "nCoefINF"}], "}"}]}], "]"}], "//", 
         "Evaluate"}]}], "]"}]}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7098933160397873`*^9, 3.7098933611044436`*^9}, {
   3.709893393919269*^9, 3.7098934563163605`*^9}, {3.709893597052805*^9, 
   3.70989388397902*^9}, {3.7098939730337334`*^9, 3.709894061808755*^9}, {
   3.7098940951254272`*^9, 3.709894120751092*^9}, {3.709894152539246*^9, 
   3.709894423755141*^9}, {3.7098946986306167`*^9, 3.709894714169548*^9}, {
   3.709894824282845*^9, 3.7098948480706477`*^9}, {3.709902923733907*^9, 
   3.709902924434922*^9}, {3.70990309110283*^9, 3.709903100769591*^9}, 
   3.70990328604443*^9, {3.709930872506048*^9, 3.7099309085257163`*^9}, {
   3.7099309731419373`*^9, 
   3.709930977418276*^9}},ExpressionUUID->"5ee299ca-da00-4913-9563-\
2e8a84f25838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InOutCoef", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Psi]", "[", "x", "]"}], "/.", "RuleInINF"}], "/.", 
        "SeriesCoefINF"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           OverscriptBox["\[Omega]", "_"], "\[Rule]", 
           RowBox[{"-", 
            OverscriptBox["\[Omega]", "_"]}]}], ",", 
          RowBox[{"s", "\[Rule]", 
           RowBox[{"-", "s"}]}], ",", 
          RowBox[{"\[ScriptY]", "\[Rule]", "\[ScriptZ]"}]}], "}"}]}], "}"}]}],
      "//", "Total"}], "//", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[Equal]", 
            RowBox[{"\[Psi]", "[", "x", "]"}]}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"#", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"\[Psi]", "'"}], "[", "x", "]"}]}]}], "}"}], "/.", 
         RowBox[{"x", "\[Rule]", "xINF"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ScriptY]", "[", "0", "]"}], ",", 
          RowBox[{"\[ScriptZ]", "[", "0", "]"}]}], "}"}]}], "]"}]}], 
     "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.709894879265334*^9, 3.7098951159987717`*^9}, {
  3.7098951769729166`*^9, 3.709895246314171*^9}, {3.7098953126727095`*^9, 
  3.709895330521904*^9}, {3.7098976698678923`*^9, 3.7098977271477437`*^9}, {
  3.7098989787739444`*^9, 3.7098989822787848`*^9}, {3.709902876271391*^9, 
  3.7099028768946767`*^9}, {3.7099029092627745`*^9, 3.709902915324047*^9}, {
  3.7099033406152763`*^9, 
  3.7099033411627455`*^9}},ExpressionUUID->"c01d2386-bb92-4a59-9a40-\
11e31ec08c29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "12."}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xINF", ":=", 
   RowBox[{"2", "Pi", " ", "*", 
    FractionBox["500", 
     RowBox[{"Abs", "[", 
      OverscriptBox["\[Omega]", "_"], "]"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709900862175883*^9, 3.7099008695748897`*^9}, 
   3.7099015169860945`*^9, {3.709902881646243*^9, 3.7099028999192085`*^9}, 
   3.709903468854978*^9},ExpressionUUID->"113ab193-8bcc-4198-8db1-\
29c703b89cef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eq", ",", "bcs"}], "}"}], "=", 
   RowBox[{
    RowBox[{"ReplaceParams", "[", 
     RowBox[{"0.99", ",", "1", ",", "1", ",", "1", ",", 
      OverscriptBox["\[Omega]", "_"]}], "]"}], "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EquationNDS", "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", "x0", "]"}], ",", 
         RowBox[{
          RowBox[{"f", "'"}], "[", "x0", "]"}]}], "}"}], "\[Equal]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "[", "x0", "]"}], ",", 
            RowBox[{
             RowBox[{"f", "'"}], "[", "x0", "]"}]}], "}"}], "/.", "RuleBH"}], 
         "/.", "SeriesCoefBH"}], ")"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7098990008473244`*^9, 3.709899103878521*^9}, {
  3.7099008369806824`*^9, 3.7099008919165115`*^9}, {3.709901432217964*^9, 
  3.7099014652405367`*^9}, {3.7099015468906918`*^9, 3.7099015917714376`*^9}, {
  3.70990163272035*^9, 3.709901643205308*^9}, {3.709901679079169*^9, 
  3.70990170187512*^9}},ExpressionUUID->"b7581c31-d7df-43f0-a782-\
2b4fbecaeb40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"First", "@", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq", ",", "bcs"}], "}"}], "/.", 
       RowBox[{
        OverscriptBox["\[Omega]", "_"], "\[Rule]", "0.4"}]}], ",", "f", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", 
        FractionBox[
         RowBox[{"2", "Pi", " ", "500"}], "0.4"]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7099017166602063`*^9, 3.709901783596202*^9}, {
   3.709902173604885*^9, 3.709902183506174*^9}, 
   3.709902225289119*^9},ExpressionUUID->"052e8476-6526-4f0b-a025-\
105d37da9947"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zs", "=", 
  RowBox[{
   RowBox[{"ReplaceParams", "[", 
    RowBox[{"0.99", ",", "1", ",", "1", ",", "1", ",", "0.4"}], "]"}], "[", 
   RowBox[{"InOutCoef", "/.", "RuleNDS"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7099022606004286`*^9, 3.709902343177745*^9}, {
  3.7099033892058754`*^9, 
  3.709903389607136*^9}},ExpressionUUID->"6f714f93-b14f-4d17-aa20-\
6aacb51c207b"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll","reps",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"RuleNDS\\\", \\\"}\\\"}]\\) is neither \
a list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"",2,2,3,31876111834136095376,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7099023289915233`*^9, 
  3.7099023437094917`*^9}},ExpressionUUID->"bd62e8b4-e3de-490c-b790-\
c578929dd7e3"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll","reps",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"test\\\", \\\"}\\\"}]\\) is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing.\"",2,2,4,31876111834136095376,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7099023289915233`*^9, 
  3.709902343740786*^9}},ExpressionUUID->"85b1c067-b14f-41b2-ba70-\
34fd01d3d6fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceParams", "[", 
    RowBox[{"0.99`", ",", "1", ",", "1", ",", "1", ",", "0.4`"}], "]"}], "[", 
   RowBox[{"InOutCoef", "/.", "\[VeryThinSpace]", "RuleNDS"}], "]"}], "/.", 
  "\[VeryThinSpace]", "test"}]], "Output",
 CellChangeTimes->{{3.709902263036705*^9, 3.7099022889827785`*^9}, {
  3.70990232900715*^9, 
  3.7099023437563744`*^9}},ExpressionUUID->"1199e94d-073e-4c53-89e2-\
9465be193817"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceParams", "[", 
   RowBox[{"0.99", ",", "1", ",", "1", ",", "1", ",", "0.4"}], "]"}], "[", 
  RowBox[{"InOutCoef", "/.", "RuleNDS"}], "]"}]], "Input",
 CellChangeTimes->{{3.7099026752610216`*^9, 3.709902691179546*^9}, {
  3.709902722432065*^9, 
  3.7099027442980494`*^9}},ExpressionUUID->"e0146887-9a3b-49b5-8ebf-\
d29da84a4fb2"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.709902670105048*^9, 3.7099026963917418`*^9}, 
   3.7099027291167564`*^9, 
   3.7099029032680025`*^9},ExpressionUUID->"20542535-e930-4142-9390-\
d26cd5f19fb5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 966},
WindowMargins->{{Automatic, -8}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 154, 3, 80, "Section", "ExpressionUUID" -> \
"635912c0-03e9-4381-afd0-4c505068a1c5"],
Cell[737, 27, 635, 14, 66, "Input", "ExpressionUUID" -> \
"6e182e77-3e32-4c82-b1e7-f2f42c604e1c"],
Cell[1375, 43, 400, 7, 91, "Input", "ExpressionUUID" -> \
"86ce71a9-e65b-4f70-95ca-70da6fcfdb9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1812, 55, 233, 4, 80, "Section", "ExpressionUUID" -> \
"d8f926b8-da75-401f-8d2f-516011e55937"],
Cell[2048, 61, 2318, 68, 100, "Input", "ExpressionUUID" -> \
"66ecc3e1-f825-4077-927b-a0042f16a644"],
Cell[4369, 131, 2275, 49, 141, "Input", "ExpressionUUID" -> \
"d0109ee9-535f-452a-9bb6-9fea8aa507ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6681, 185, 242, 4, 80, "Section", "ExpressionUUID" -> \
"5357542e-ce2d-443a-88a6-76e88ae89865"],
Cell[6926, 191, 11133, 222, 393, "Input", "ExpressionUUID" -> \
"58c14dba-e858-47cb-b247-b37d99de45ed"],
Cell[18062, 415, 4822, 90, 176, "Input", "ExpressionUUID" -> \
"e268e2a4-92c8-4b13-baa8-3309db1b42a6"],
Cell[22887, 507, 3031, 67, 210, "Input", "ExpressionUUID" -> \
"6ec526f9-a64a-4f55-92dc-54a586dc845c"],
Cell[CellGroupData[{
Cell[25943, 578, 3579, 89, 304, "Input", "ExpressionUUID" -> \
"8a6689b3-6c01-4e61-8b80-ea4f2e83e26e"],
Cell[29525, 669, 439, 7, 40, "Output", "ExpressionUUID" -> \
"1e50ccf1-618b-40fa-9218-b9a9b5dd426e"]
}, Open  ]],
Cell[29979, 679, 2288, 58, 115, "Input", "ExpressionUUID" -> \
"5ee299ca-da00-4913-9563-2e8a84f25838"],
Cell[32270, 739, 1877, 51, 71, "Input", "ExpressionUUID" -> \
"c01d2386-bb92-4a59-9a40-11e31ec08c29"],
Cell[34150, 792, 544, 14, 99, "Input", "ExpressionUUID" -> \
"113ab193-8bcc-4198-8db1-29c703b89cef"],
Cell[34697, 808, 1222, 32, 71, "Input", "ExpressionUUID" -> \
"b7581c31-d7df-43f0-a782-2b4fbecaeb40"],
Cell[35922, 842, 667, 19, 65, "Input", "ExpressionUUID" -> \
"052e8476-6526-4f0b-a025-105d37da9947"],
Cell[CellGroupData[{
Cell[36614, 865, 397, 9, 40, "Input", "ExpressionUUID" -> \
"6f714f93-b14f-4d17-aa20-6aacb51c207b"],
Cell[37014, 876, 436, 9, 29, "Message", "ExpressionUUID" -> \
"bd62e8b4-e3de-490c-b790-c578929dd7e3"],
Cell[37453, 887, 431, 9, 29, "Message", "ExpressionUUID" -> \
"85b1c067-b14f-41b2-ba70-34fd01d3d6fa"],
Cell[37887, 898, 445, 10, 40, "Output", "ExpressionUUID" -> \
"1199e94d-073e-4c53-89e2-9465be193817"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38369, 913, 370, 8, 40, "Input", "ExpressionUUID" -> \
"e0146887-9a3b-49b5-8ebf-d29da84a4fb2"],
Cell[38742, 923, 216, 4, 40, "Output", "ExpressionUUID" -> \
"20542535-e930-4142-9390-d26cd5f19fb5"]
}, Open  ]]
}, Open  ]]
}
]
*)

