(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51805,       1353]
NotebookOptionsPosition[     48131,       1262]
NotebookOutlinePosition[     48496,       1278]
CellTagsIndexPosition[     48453,       1275]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.7033627187934713`*^9, 
  3.7033627375920715`*^9}},ExpressionUUID->"facc684c-df56-4a09-b8b5-\
3aeae6cfb887"],

Cell[BoxData[{
 RowBox[{"Clear", "@", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702711036582342*^9, 3.70271104805758*^9}, {
   3.7027371697054696`*^9, 3.7027371821475344`*^9}, {3.7027959869031916`*^9, 
   3.7027959894965734`*^9}, 
   3.703025237991789*^9},ExpressionUUID->"6d6ee29b-a060-4559-99d4-\
014009e87315"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetZFile", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\"\<Data/\>\"", "<>", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Z\>\"", ",", "\[ScriptS]", ",", "\[ScriptL]", ",", 
         "\[ScriptM]"}], "}"}], ",", "\"\<_\>\""}], "]"}], "<>", 
     "\"\<.csv\>\""}], "/;", 
    RowBox[{"\[ScriptL]", "\[GreaterEqual]", " ", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "@", "\[ScriptS]"}], ",", 
       RowBox[{"Abs", "@", "\[ScriptM]"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703343114029959*^9, 3.703343213355159*^9}, {
  3.7033433231090713`*^9, 3.703343327234497*^9}, {3.70336255586213*^9, 
  3.7033625643194075`*^9}, {3.7033626431839485`*^9, 3.703362647175323*^9}, {
  3.703363612069075*^9, 3.7033636150224495`*^9}, {3.7033637294755287`*^9, 
  3.7033637697297955`*^9}},ExpressionUUID->"a4d8dd29-e427-4ddc-9d08-\
5d19a371d27b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation and functions", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 
  3.7033627970613737`*^9}},ExpressionUUID->"8fa35250-fd08-448b-a5a9-\
eddb3b76c6d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "[", "r_", "]"}], "=", 
   RowBox[{
    SuperscriptBox["r", "2"], "-", 
    RowBox[{"2", " ", "M", " ", "r"}], "+", 
    SuperscriptBox["a", "2"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"r", "+", 
    RowBox[{"\[ImaginaryI]", " ", "a", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalK]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["a", "2"]}], ")"}], " ", "\[Omega]"}], "-", 
    RowBox[{"a", " ", "m"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7024501789158287`*^9, 3.702450179247703*^9}, {
   3.7024502470285254`*^9, 3.7024502484678707`*^9}, {3.702450324093417*^9, 
   3.7024503267132316`*^9}, {3.7024505296621456`*^9, 3.702450553663209*^9}, {
   3.702450609664097*^9, 3.702450750973497*^9}, {3.7024507819838047`*^9, 
   3.7024508831417017`*^9}, {3.7024509836877527`*^9, 3.702451089148628*^9}, {
   3.7024511285437355`*^9, 3.702451280213853*^9}, {3.7024513783411307`*^9, 
   3.70245142826882*^9}, {3.7024525999697638`*^9, 3.7024526030734844`*^9}, {
   3.7024526453491707`*^9, 3.702452665272485*^9}, {3.7024532990070496`*^9, 
   3.702453299261078*^9}, {3.702464624058112*^9, 3.702464654880009*^9}, 
   3.702816350040848*^9},ExpressionUUID->"095849e5-d626-470a-a4ae-\
7910c1e114aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ruleK", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "\[Rule]", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"Expand", "[", 
            RowBox[{"\[ScriptCapitalK]", "[", 
             RowBox[{"rp", "+", 
              RowBox[{"rp", " ", "x"}]}], "]"}], "]"}], "rp"], "/.", 
          "\[VeryThinSpace]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"c_", " ", 
              SuperscriptBox["a", "2"]}], "+", 
             RowBox[{"c_", " ", 
              SuperscriptBox["rp", "2"]}]}], "\[Rule]", 
            RowBox[{"c", " ", "2", " ", "M", " ", "rp"}]}], "}"}]}], "/.", 
         "\[VeryThinSpace]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "\[Rule]", 
            RowBox[{"2", " ", "M", " ", 
             OverscriptBox["\[CapitalOmega]", "_"]}]}], ",", 
           RowBox[{"\[Omega]", "\[Rule]", 
            FractionBox[
             OverscriptBox["\[Omega]", "_"], "rp"]}]}], "}"}]}], ",", "M", 
        ",", "Factor"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Omega]", "_"], "-", 
        RowBox[{"m", " ", 
         OverscriptBox["\[CapitalOmega]", "_"]}]}], "\[Rule]", 
       FractionBox[
        RowBox[{"\[Chi]", " ", "rp"}], 
        RowBox[{"2", " ", "M"}]]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eq0", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", 
        RowBox[{"(", 
         RowBox[{"x", "+", "\[Tau]"}], ")"}]}], ")"}], 
      RowBox[{"-", "s"}]], 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", 
           RowBox[{"(", 
            RowBox[{"x", "+", "\[Tau]"}], ")"}]}], ")"}], 
         RowBox[{"s", "+", "1"}]], 
        RowBox[{
         RowBox[{"R", "'"}], "[", "x", "]"}]}], ")"}]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Kappa]", "2"], "-", 
         RowBox[{"I", " ", "s", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "x"}], "+", "\[Tau]"}], ")"}], "\[Kappa]"}]}], 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"x", "+", "\[Tau]"}], ")"}]}]], "-", "\[Lambda]", "+", 
       RowBox[{"4", "I", " ", "s", " ", 
        OverscriptBox["\[Omega]", "_"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]}], ")"}], 
     RowBox[{"R", "[", "x", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "=", 
   RowBox[{"eq0", "/.", "ruleK"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7024501789158287`*^9, 3.702450179247703*^9}, {
   3.7024502470285254`*^9, 3.7024502484678707`*^9}, {3.702450324093417*^9, 
   3.7024503267132316`*^9}, {3.7024505296621456`*^9, 3.702450553663209*^9}, {
   3.702450609664097*^9, 3.702450750973497*^9}, {3.7024507819838047`*^9, 
   3.7024508831417017`*^9}, {3.7024509836877527`*^9, 3.702451089148628*^9}, {
   3.7024511285437355`*^9, 3.702451280213853*^9}, {3.7024513783411307`*^9, 
   3.70245142826882*^9}, {3.7024525999697638`*^9, 3.7024526030734844`*^9}, {
   3.7024526453491707`*^9, 3.702452665272485*^9}, {3.7024532990070496`*^9, 
   3.702453299261078*^9}, {3.702464624058112*^9, 3.702464654880009*^9}, {
   3.702816350040848*^9, 3.7028163537174234`*^9}, {3.702903260136524*^9, 
   3.70290326225555*^9}, {3.7030245941693416`*^9, 3.7030245958726187`*^9}, {
   3.7030246308224525`*^9, 3.7030246438883944`*^9}, 
   3.703026071290842*^9},ExpressionUUID->"c12c6fd2-5fc8-427d-a950-\
c21db82815c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 
  3.703362816729743*^9}},ExpressionUUID->"01110265-b306-43a3-8267-\
e4c809dee703"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", "l_", "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"kp", "+", "km"}], ")"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"kp", "-", "km"}], ")"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l", "2"], "-", 
        SuperscriptBox["s", "2"]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l", "2"], "-", 
        FractionBox["1", "4"]}], ")"}], " ", 
      SuperscriptBox["l", "3"]}]], "/.", "\[VeryThinSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"kp", "+", "km"}], "\[Rule]", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Abs", "[", "s", "]"}], ",", 
         RowBox[{"Abs", "[", "l", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"kp", "-", "km"}], "\[Rule]", 
       FractionBox[
        RowBox[{"s", " ", "m"}], 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "s", "]"}], ",", 
          RowBox[{"Abs", "[", "l", "]"}]}], "]"}]]}]}], "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"EigenCoef", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"l", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}]}], "-", 
      RowBox[{"s", 
       RowBox[{"(", 
        RowBox[{"s", "+", "1"}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "m", " ", 
        SuperscriptBox["s", "2"]}], 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "l"}], ")"}]}]]}], ",", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"l", "+", "1"}], "]"}], "-", 
      RowBox[{"h", "[", "l", "]"}], "-", "1"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"h", "[", "l", "]"}], " ", "m", " ", 
        SuperscriptBox["s", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "-", "1"}], ")"}], " ", 
        SuperscriptBox["l", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"l", "+", "1"}], "]"}], " ", "m", " ", 
        SuperscriptBox["s", "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], "2"], " ", "l", " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "2"}], ")"}]}]]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["s", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           RowBox[{"h", "[", 
            RowBox[{"l", "+", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"4", " ", 
           RowBox[{"h", "[", "l", "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "2"], " ", 
           SuperscriptBox["l", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "2"]}]]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "2"}], ")"}], " ", 
        RowBox[{"h", "[", 
         RowBox[{"l", "+", "1"}], "]"}], " ", 
        RowBox[{"h", "[", 
         RowBox[{"l", "+", "2"}], "]"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "l"}], "+", "3"}], ")"}]}]], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"h", "[", 
         RowBox[{"l", "+", "1"}], "]"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"h", "[", "l", "]"}], " ", 
        RowBox[{"h", "[", 
         RowBox[{"l", "+", "1"}], "]"}]}], 
       RowBox[{"2", " ", "l", " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}]], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"h", "[", "l", "]"}], "2"], 
       RowBox[{"2", " ", "l"}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "-", "1"}], ")"}], " ", 
        RowBox[{"h", "[", 
         RowBox[{"l", "-", "1"}], "]"}], " ", 
        RowBox[{"h", "[", "l", "]"}]}], 
       RowBox[{"2", " ", "l", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "l"}], "-", "1"}], ")"}]}]]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "3"], " ", 
       SuperscriptBox["s", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"8", " ", 
           RowBox[{"h", "[", "l", "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "6"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}], "3"]}]], "-", 
         FractionBox[
          RowBox[{"8", " ", 
           RowBox[{"h", "[", 
            RowBox[{"l", "+", "1"}], "]"}]}], 
          RowBox[{
           SuperscriptBox["l", "3"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "6"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], "3"]}]]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["s", "2"], " ", 
       RowBox[{"h", "[", "l", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"h", "[", 
             RowBox[{"l", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"7", " ", 
               SuperscriptBox["l", "2"]}], "+", 
              RowBox[{"7", " ", "l"}], "+", "4"}], ")"}]}], 
           RowBox[{
            SuperscriptBox["l", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"l", "+", "2"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "3"], " ", 
            RowBox[{"(", 
             RowBox[{"l", "-", "1"}], ")"}]}]]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"l", "-", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "l"}], "-", "4"}], ")"}]}], 
          RowBox[{
           SuperscriptBox["l", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "-", "1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"l", "-", "2"}], ")"}]}]]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["s", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "l"}], "+", "7"}], ")"}], " ", 
           RowBox[{"h", "[", 
            RowBox[{"l", "+", "1"}], "]"}], " ", 
           RowBox[{"h", "[", 
            RowBox[{"l", "+", "2"}], "]"}]}], 
          RowBox[{"l", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{"l", "+", "3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l"}], "+", "3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"h", "[", 
             RowBox[{"l", "+", "1"}], "]"}], "2"]}], 
          RowBox[{"l", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{"l", "+", "2"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"h", "[", "l", "]"}], "2"]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "-", "1"}], ")"}], " ", 
           SuperscriptBox["l", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}]}]]}], ")"}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453686407221*^9, 3.702453704443742*^9}, {
   3.7024537783557587`*^9, 3.7024537821919346`*^9}, 3.7029032718072605`*^9, {
   3.7030260741605453`*^9, 
   3.7030260901243095`*^9}},ExpressionUUID->"290fc53f-6336-4b21-b330-\
2de5574509d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter rules and equation simplification ", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 
  3.703362850927506*^9}},ExpressionUUID->"4e5227e8-100f-4251-a9d8-\
296535fcbc93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleR", "=", 
   RowBox[{"{", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["x", "\[Tau]"], ")"}], 
         RowBox[{
          RowBox[{"-", "s"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"\[Chi]", "/", "\[Tau]"}]}]}]], 
        RowBox[{"f", "[", "x", "]"}]}]}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nCoef", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleF", "=", 
   RowBox[{"{", 
    RowBox[{"f", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"n", "=", "0"}], "nCoef"], 
        RowBox[{
         RowBox[{"\[ScriptA]", "[", "n", "]"}], " ", 
         SuperscriptBox["x", "n"]}]}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquationF", "=", 
   RowBox[{"PowerExpand", "@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["x", "\[Tau]"], ")"}], 
       RowBox[{"s", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"\[Chi]", "/", "\[Tau]"}]}]}]], "x", " ", 
      RowBox[{"(", 
       RowBox[{"x", "+", "\[Tau]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Eq", "/.", "\[VeryThinSpace]", "RuleR"}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleParams", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Tau]", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}], 
       RowBox[{"1", "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]]}], ",", 
     RowBox[{
      OverscriptBox["\[CapitalOmega]", "_"], "\[Rule]", 
      FractionBox["\[ScriptCapitalJ]", "2"]}], ",", 
     RowBox[{"\[Chi]", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["\[Omega]", "_"], "-", 
         RowBox[{"m", " ", 
          OverscriptBox["\[CapitalOmega]", "_"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "\[Tau]"}], ")"}]}]}], ",", 
     RowBox[{"rp", "\[Rule]", 
      RowBox[{"1", "+", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]}], ",", 
     RowBox[{"\[ScriptCapitalB]", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Lambda]", "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"s", "+", "1"}], ")"}]}]}], ")"}], "2"], "-", 
        RowBox[{"4", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"\[ScriptCapitalJ]", " ", 
             OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"]}], "+", 
        RowBox[{"4", "m", " ", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"]}]}], "]"}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\[ScriptCapitalJ]", " ", 
            OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"], "-", 
        RowBox[{"2", "m", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\[ScriptCapitalJ]", " ", 
            OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}]}], "+", 
        RowBox[{"EigenCoef", ".", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"\[ScriptCapitalJ]", " ", 
               OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "n"], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{
              RowBox[{"Length", "[", "EigenCoef", "]"}], "-", "1"}]}], 
            "}"}]}], "]"}]}]}]}], "/.", "\[VeryThinSpace]", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"l", "+", "\[Epsilon]"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, 3.7028161983950057`*^9, {3.702816611930849*^9, 
   3.7028166547282743`*^9}, {3.7028167501933465`*^9, 
   3.7028167732842445`*^9}, {3.7028168846283855`*^9, 3.70281688880552*^9}, {
   3.7029016974222364`*^9, 3.70290170884544*^9}, {3.702901862018824*^9, 
   3.702901864895048*^9}, {3.702901895399967*^9, 3.7029018989044437`*^9}, {
   3.7029019328300767`*^9, 3.7029019896379337`*^9}, {3.70290219926057*^9, 
   3.7029022007316165`*^9}, {3.7029022527030687`*^9, 
   3.7029022631707344`*^9}, {3.7029026136404552`*^9, 3.702902656213641*^9}, {
   3.702902690280937*^9, 3.7029026966091814`*^9}, {3.702902791524929*^9, 
   3.7029028268302794`*^9}, {3.702903355065157*^9, 3.702903357115694*^9}, {
   3.7030173782222605`*^9, 3.7030173785248013`*^9}, 3.7030177866537313`*^9, 
   3.703019752454656*^9, {3.7030261457916284`*^9, 3.703026153649619*^9}, {
   3.7030262182789373`*^9, 3.7030262384393153`*^9}, {3.7030269098741713`*^9, 
   3.7030269300308614`*^9}, {3.703248695988945*^9, 3.7032486981768*^9}, {
   3.7032490587471266`*^9, 3.7032490647165127`*^9}, {3.7032491331300306`*^9, 
   3.7032491362553654`*^9}, 
   3.70325293884263*^9},ExpressionUUID->"4628c533-75d7-4e4a-8f78-\
7b17bf99ebfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleBoundaryBHole", "=", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptA]", "[", "0", "]"}], "\[Rule]", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceParams", "[", 
    RowBox[{
    "\[ScriptS]_", ",", "\[ScriptL]_", ",", "\[ScriptM]_", ",", 
     "\[ScriptJ]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"PowerExpand", "[", 
       RowBox[{
        RowBox[{"#1", "//.", "\[VeryThinSpace]", "RuleParams"}], "/.", 
        "\[VeryThinSpace]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
          RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
          RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
          RowBox[{"\[ScriptCapitalJ]", "\[Rule]", "\[ScriptJ]"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, {3.7028161983950057`*^9, 3.702816273289017*^9}, {
   3.7028164165232286`*^9, 3.7028164168240695`*^9}, {3.7028165633803825`*^9, 
   3.7028165680451326`*^9}, {3.7028166679089003`*^9, 
   3.7028166719379597`*^9}, {3.7032487044743595`*^9, 
   3.7032487046304893`*^9}},ExpressionUUID->"9d6c6f5c-c311-4998-94e8-\
bf68fb824698"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation solver definition ", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 3.703362850927506*^9}, {3.7033628873014746`*^9, 
  3.703362901731254*^9}},ExpressionUUID->"2093726c-6042-449e-966d-\
12c658089baa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "14."}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xM", ":=", 
   RowBox[{"4000", "/", 
    OverscriptBox["\[Omega]", "_"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omega", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0.001", ",", "0.55", ",", "0.004"}], "]"}], ",", 
     RowBox[{
      RowBox[{"ReplaceParams", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0.9"}], "]"}], "[", 
      RowBox[{"m", " ", 
       OverscriptBox["\[CapitalOmega]", "_"]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spin", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "0.9", ",", "0.99", ",", 
     "0.999"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032486522344265`*^9, 3.7032486524688106`*^9}, {
  3.7032489270761104`*^9, 3.7032489516256003`*^9}, {3.703249858354682*^9, 
  3.703249880919569*^9}},ExpressionUUID->"399de46d-9855-4ac4-b294-\
14b5a051c165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "Solve\[Omega]F"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve\[Omega]F", "[", 
   RowBox[{
    RowBox[{"\[ScriptS]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptL]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptM]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptJ]", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"__", "?", "NumberQ"}], "}"}], "|", 
      RowBox[{"\[ScriptJ]_", "?", "NumberQ"}]}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve\[Omega]F", "[", 
     RowBox[{
     "\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]", ",", "#", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0.001", ",", "0.55", ",", "0.004"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[ScriptJ]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve\[Omega]F", "[", 
     RowBox[{
      RowBox[{"\[ScriptS]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptL]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptM]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptJ]", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"__", "?", "NumberQ"}], "}"}], "|", 
        RowBox[{"\[ScriptJ]_", "?", "NumberQ"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"omega__", "?", "NumberQ"}], "}"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"Thread", "[", 
       RowBox[{"0", "<", "\[ScriptJ]", "<", "1"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{"Abs", "[", "\[ScriptS]", "]"}], "\[Equal]", "1"}], "&&", 
     RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
        RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<\[ScriptS] = \>\"", ",", "\[ScriptS]", ",", 
           "\"\<; \[ScriptCapitalJ] = \>\"", ",", "#1"}], "]"}], ";", "#1"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "CoefList", ",", "SolCoef", ",", "SolF", ",", "eqF", ",", 
            "\[Omega]list"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Omega]list", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"{", "omega", "}"}], ",", 
              RowBox[{
               RowBox[{"ReplaceParams", "[", 
                RowBox[{
                "\[ScriptS]", ",", "\[ScriptM]", ",", "\[ScriptL]", ",", 
                 "#1"}], "]"}], "[", 
               RowBox[{"m", " ", 
                OverscriptBox["\[CapitalOmega]", "_"]}], "]"}]}], "]"}]}], 
           ";", 
           RowBox[{"eqF", "=", 
            RowBox[{
             RowBox[{"ReplaceParams", "[", 
              RowBox[{
              "\[ScriptS]", ",", "\[ScriptM]", ",", "\[ScriptL]", ",", "#1"}],
               "]"}], "[", "EquationF", "]"}]}], ";", 
           RowBox[{"CoefList", "=", 
            RowBox[{"Rationalize", "[", 
             RowBox[{
              RowBox[{"CoefficientList", "[", 
               RowBox[{
                RowBox[{"eqF", "/.", "\[VeryThinSpace]", "RuleF"}], ",", 
                "x"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"nCoef", "+", "1"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", 
           RowBox[{"SolCoef", "=", 
            RowBox[{"Rationalize", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{"First", "[", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"CoefList", "\[Equal]", "0"}], ",", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"\[ScriptA]", "[", "n", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", "nCoef"}], "}"}]}], "]"}], 
                  "]"}]}], "]"}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"SolF", "=", 
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"NDSolve", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"eqF", "\[Equal]", "0"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "[", "x0", "]"}], ",", 
                    RowBox[{
                    SuperscriptBox["f", "\[Prime]",
                    MultilineFunction->None], "[", "x0", "]"}]}], "}"}], 
                    "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "[", "x0", "]"}], ",", 
                    RowBox[{
                    SuperscriptBox["f", "\[Prime]",
                    MultilineFunction->None], "[", "x0", "]"}]}], "}"}], "/.",
                     "\[VeryThinSpace]", "RuleF"}], "/.", "\[VeryThinSpace]", 
                    "SolCoef"}], "/.", "\[VeryThinSpace]", 
                    "RuleBoundaryBHole"}], ")"}]}]}], "}"}], ",", "f", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "x0", ",", "xM"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                OverscriptBox["\[Omega]", "_"], ",", "\[Omega]list"}], 
               "}"}]}], "]"}]}], ";", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thread", "[", 
               RowBox[{
                OverscriptBox["\[Omega]", "_"], "\[Rule]", "\[Omega]list"}], 
               "]"}], ",", 
              RowBox[{"First", "/@", "SolF"}]}], "}"}], "]"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "&"}], ")"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "\[ScriptJ]", "}"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032479911953154`*^9, 3.703247996555267*^9}, {
   3.7032480751429873`*^9, 3.7032480854878054`*^9}, {3.7032481957662406`*^9, 
   3.703248520441369*^9}, {3.7032485561014185`*^9, 3.7032486722365575`*^9}, {
   3.7032487151159787`*^9, 3.703248835316387*^9}, {3.7032488851965933`*^9, 
   3.7032489068239746`*^9}, {3.703248963001816*^9, 3.7032490312278147`*^9}, {
   3.703249061434952*^9, 3.7032494954966574`*^9}, {3.7032495303910027`*^9, 
   3.7032495577063985`*^9}, {3.703249661248683*^9, 3.703249661561182*^9}, {
   3.7032501776207466`*^9, 3.7032502610672064`*^9}, {3.7032503561397767`*^9, 
   3.7032503957220106`*^9}, {3.7032504610259376`*^9, 3.703250633983*^9}, {
   3.7032506691586294`*^9, 3.7032508425207057`*^9}, {3.70325087411078*^9, 
   3.703251038985026*^9}, {3.7032510828335433`*^9, 3.703251096037957*^9}, {
   3.703251150903144*^9, 3.70325118529745*^9}, {3.7032512337252235`*^9, 
   3.7032515506146297`*^9}, {3.7032516159652867`*^9, 
   3.7032516178248596`*^9}, {3.7032516478593383`*^9, 3.703251656657111*^9}, {
   3.7032518043453827`*^9, 3.7032519215669413`*^9}, 3.703251976666548*^9, {
   3.7032520130141706`*^9, 3.70325207322369*^9}, {3.7032521269168873`*^9, 
   3.7032522198798704`*^9}, {3.703252420962175*^9, 3.703252484078147*^9}, {
   3.703252528190548*^9, 3.7032525454579735`*^9}, {3.7032526444907727`*^9, 
   3.703252700979662*^9}, {3.7032527576950035`*^9, 3.7032528562696886`*^9}, {
   3.7032529734135237`*^9, 3.703252974929412*^9}, {3.70325308947402*^9, 
   3.703253107085228*^9}},ExpressionUUID->"9aa09165-7d07-4ff5-9efd-\
84926cd5a4fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Start calculation and export data", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 3.703362850927506*^9}, {3.7033628873014746`*^9, 
  3.7033629351261253`*^9}},ExpressionUUID->"2a83e9bf-31f4-429d-8b31-\
68c978e649e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sol\[Omega]F0", "=", 
   RowBox[{"Solve\[Omega]F", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "Spin", ",", "Omega"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sol\[Omega]F2", "=", 
   RowBox[{"Solve\[Omega]F", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "Spin", ",", "Omega"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032495599880333`*^9, 3.70324958797538*^9}, {
  3.7032496340896277`*^9, 3.703249641981083*^9}, {3.70324967865678*^9, 
  3.7032496801881976`*^9}, {3.703249756511135*^9, 3.7032497599465265`*^9}, {
  3.7032498884413643`*^9, 3.703249891059541*^9}, {3.7032500688146286`*^9, 
  3.7032500809721713`*^9}, {3.7032502098586264`*^9, 3.703250213515272*^9}, {
  3.703250251378665*^9, 3.7032502685679893`*^9}, {3.7032529059955187`*^9, 
  3.7032529072768855`*^9}, {3.70334347531857*^9, 
  3.7033435499167356`*^9}},ExpressionUUID->"1458e40a-375f-4e99-9aae-\
84e2e8522855"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.2`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.2],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.70339616278129*^9},ExpressionUUID->"c6b642e9-0653-4244-9aa3-01b18c535a63"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.4`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.4],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033962117393026`*^9},ExpressionUUID->"315815ad-b438-45e6-9761-\
8765f2acbf24"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.6`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.6],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033962659134254`*^9},ExpressionUUID->"0aeed0a1-5df1-43f6-92f9-\
9017d3daa4f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.8`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.8],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033963217261524`*^9},ExpressionUUID->"79965a21-282e-4b20-89c0-\
0a500de568f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.9`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.9],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033963846751804`*^9},ExpressionUUID->"4e7ba711-9a47-460a-94e8-\
8f14cfcfb835"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.99`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.99],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033964506274333`*^9},ExpressionUUID->"e33d40a7-aa1b-42ec-af29-\
1b6ace516614"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", "\[InvisibleSpace]",
    "0.999`"}],
  SequenceForm["\[ScriptS] = ", 1, "; \[ScriptCapitalJ] = ", 0.999],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.703396520097365*^9},ExpressionUUID->"53ec13a1-fd0f-4558-bdb4-\
50b32c35076a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.2`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.2],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033965807440825`*^9},ExpressionUUID->"b3e28d0a-4680-4d41-9ad5-\
ceaa2e26c6c0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.4`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.4],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033966440440784`*^9},ExpressionUUID->"908fe496-dfc2-45de-9fbd-\
23b7c2e11f8f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.6`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.6],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.703396707819085*^9},ExpressionUUID->"ed604202-4610-4c87-ba74-\
ddbb91b43be8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.8`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.8],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033967696571565`*^9},ExpressionUUID->"aafc5ff6-d0de-452f-b7b0-\
21f1d4046e5f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.9`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.9],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033968328465204`*^9},ExpressionUUID->"3316de63-4195-464e-884c-\
ca752c42bd08"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.99`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.99],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.703396901507434*^9},ExpressionUUID->"f3f70098-e013-4853-9496-\
73ed5db19b60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[ScriptS] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], "\[InvisibleSpace]", "\<\"; \[ScriptCapitalJ] = \"\>", 
   "\[InvisibleSpace]", "0.999`"}],
  SequenceForm["\[ScriptS] = ", -1, "; \[ScriptCapitalJ] = ", 0.999],
  Editable->False]], "Print",
 CellChangeTimes->{3.7032529486561747`*^9, 3.7032531128671155`*^9, 
  3.703342369561612*^9, 
  3.7033969663188295`*^9},ExpressionUUID->"c1656999-6b77-4024-ad82-\
48174da5c127"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Data0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", 
          OverscriptBox["\[Omega]", "_"], ",", 
          RowBox[{
           RowBox[{"ReplaceParams", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "#1"}], "]"}], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              OverscriptBox["\[Omega]", "_"], " ", 
              RowBox[{"rp", "/", 
               RowBox[{"(", 
                RowBox[{"4", "\[Chi]"}], ")"}]}]}], 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{"f", "[", "xM", "]"}], "]"}], "2"]]}], "]"}]}], "}"}], 
        "/.", "#2"}], "&"}], ")"}], "@@@", "Sol\[Omega]F0"}], "//", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Data2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", 
          OverscriptBox["\[Omega]", "_"], ",", 
          RowBox[{
           RowBox[{"ReplaceParams", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "#1"}], "]"}], "[", 
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{"1", "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["\[ScriptCapitalB]", "2"], 
               SuperscriptBox["\[Tau]", "8"], 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"f", "[", "xM", "]"}], "]"}], "2"]}], 
              RowBox[{
               OverscriptBox["\[Omega]", "_"], " ", "\[Chi]", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Tau]", "2"], "+", 
                 SuperscriptBox["\[Chi]", "2"]}], ")"}]}]]}]], "]"}]}], "}"}],
         "/.", "#2"}], "&"}], ")"}], "@@@", "Sol\[Omega]F2"}], "//", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"GetZFile", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", "Data0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"GetZFile", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], ",", "Data2"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7033435523232307`*^9, 3.703343713642764*^9}, {
  3.7033607478395014`*^9, 3.703360859557466*^9}, {3.7033624626181936`*^9, 
  3.7033625243827434`*^9}, {3.70336362477488*^9, 3.7033636257758822`*^9}, {
  3.7033971083276653`*^9, 3.703397192047014*^9}, {3.703397382517873*^9, 
  3.703397392692007*^9}, {3.7033974269560003`*^9, 3.703397458040635*^9}, {
  3.7033989518096895`*^9, 
  3.7033989741803985`*^9}},ExpressionUUID->"aae2d33d-daed-42b8-b4a8-\
2a1fa6d7e26d"]
}, Open  ]]
},
WindowSize->{958, 966},
WindowMargins->{{Automatic, -8}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 154, 3, 80, "Section", "ExpressionUUID" -> \
"facc684c-df56-4a09-b8b5-3aeae6cfb887"],
Cell[737, 27, 533, 13, 66, "Input", "ExpressionUUID" -> \
"6d6ee29b-a060-4559-99d4-014009e87315"],
Cell[1273, 42, 1098, 26, 66, "Input", "ExpressionUUID" -> \
"a4d8dd29-e427-4ddc-9d08-5d19a371d27b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2408, 73, 171, 3, 80, "Section", "ExpressionUUID" -> \
"8fa35250-fd08-448b-a5a9-eddb3b76c6d2"],
Cell[2582, 78, 1811, 45, 121, "Input", "ExpressionUUID" -> \
"095849e5-d626-470a-a4ae-7910c1e114aa"],
Cell[4396, 125, 3737, 99, 244, "Input", "ExpressionUUID" -> \
"c12c6fd2-5fc8-427d-a950-c21db82815c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8170, 229, 158, 3, 80, "Section", "ExpressionUUID" -> \
"01110265-b306-43a3-8267-e4c809dee703"],
Cell[8331, 234, 9284, 282, 601, "Input", "ExpressionUUID" -> \
"290fc53f-6336-4b21-b330-2de5574509d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17652, 521, 242, 4, 80, "Section", "ExpressionUUID" -> \
"4e5227e8-100f-4251-a9d8-296535fcbc93"],
Cell[17897, 527, 7067, 165, 478, "Input", "ExpressionUUID" -> \
"4628c533-75d7-4e4a-8f78-7b17bf99ebfc"],
Cell[24967, 694, 2953, 56, 91, "Input", "ExpressionUUID" -> \
"9d6c6f5c-c311-4998-94e8-bf68fb824698"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27957, 755, 273, 4, 80, "Section", "ExpressionUUID" -> \
"2093726c-6042-449e-966d-12c658089baa"],
Cell[28233, 761, 1073, 30, 123, "Input", "ExpressionUUID" -> \
"399de46d-9855-4ac4-b294-14b5a051c165"],
Cell[29309, 793, 7821, 178, 538, "Input", "ExpressionUUID" -> \
"9aa09165-7d07-4ff5-9efd-84926cd5a4fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37167, 976, 281, 4, 80, "Section", "ExpressionUUID" -> \
"2a83e9bf-31f4-429d-8b31-68c978e649e6"],
Cell[CellGroupData[{
Cell[37473, 984, 977, 20, 66, "Input", "ExpressionUUID" -> \
"1458e40a-375f-4e99-9aae-84e2e8522855"],
Cell[CellGroupData[{
Cell[38475, 1008, 457, 9, 29, "Print", "ExpressionUUID" -> \
"c6b642e9-0653-4244-9aa3-01b18c535a63"],
Cell[38935, 1019, 462, 10, 29, "Print", "ExpressionUUID" -> \
"315815ad-b438-45e6-9761-8765f2acbf24"],
Cell[39400, 1031, 462, 10, 29, "Print", "ExpressionUUID" -> \
"0aeed0a1-5df1-43f6-92f9-9017d3daa4f5"],
Cell[39865, 1043, 462, 10, 29, "Print", "ExpressionUUID" -> \
"79965a21-282e-4b20-89c0-0a500de568f9"],
Cell[40330, 1055, 462, 10, 29, "Print", "ExpressionUUID" -> \
"4e7ba711-9a47-460a-94e8-8f14cfcfb835"],
Cell[40795, 1067, 464, 10, 29, "Print", "ExpressionUUID" -> \
"e33d40a7-aa1b-42ec-af29-1b6ace516614"],
Cell[41262, 1079, 464, 10, 29, "Print", "ExpressionUUID" -> \
"53ec13a1-fd0f-4558-bdb4-50b32c35076a"],
Cell[41729, 1091, 478, 10, 29, "Print", "ExpressionUUID" -> \
"b3e28d0a-4680-4d41-9ad5-ceaa2e26c6c0"],
Cell[42210, 1103, 478, 10, 29, "Print", "ExpressionUUID" -> \
"908fe496-dfc2-45de-9fbd-23b7c2e11f8f"],
Cell[42691, 1115, 476, 10, 29, "Print", "ExpressionUUID" -> \
"ed604202-4610-4c87-ba74-ddbb91b43be8"],
Cell[43170, 1127, 478, 10, 29, "Print", "ExpressionUUID" -> \
"aafc5ff6-d0de-452f-b7b0-21f1d4046e5f"],
Cell[43651, 1139, 478, 10, 29, "Print", "ExpressionUUID" -> \
"3316de63-4195-464e-884c-ca752c42bd08"],
Cell[44132, 1151, 478, 10, 29, "Print", "ExpressionUUID" -> \
"f3f70098-e013-4853-9496-73ed5db19b60"],
Cell[44613, 1163, 482, 10, 29, "Print", "ExpressionUUID" -> \
"c1656999-6b77-4024-ad82-48174da5c127"]
}, Open  ]]
}, Open  ]],
Cell[45122, 1177, 2993, 82, 299, "Input", "ExpressionUUID" -> \
"aae2d33d-daed-42b8-b4a8-2a1fa6d7e26d"]
}, Open  ]]
}
]
*)

