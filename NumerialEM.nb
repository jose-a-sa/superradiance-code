(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63023,       1440]
NotebookOptionsPosition[     60076,       1364]
NotebookOutlinePosition[     60445,       1380]
CellTagsIndexPosition[     60402,       1377]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.7033627187934713`*^9, 
  3.7033627375920715`*^9}},ExpressionUUID->"facc684c-df56-4a09-b8b5-\
3aeae6cfb887"],

Cell[BoxData[{
 RowBox[{"Clear", "@", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702711036582342*^9, 3.70271104805758*^9}, {
   3.7027371697054696`*^9, 3.7027371821475344`*^9}, {3.7027959869031916`*^9, 
   3.7027959894965734`*^9}, 3.703025237991789*^9, {3.7063521189576783`*^9, 
   3.706352119834443*^9}},ExpressionUUID->"6d6ee29b-a060-4559-99d4-\
014009e87315"],

Cell[BoxData[
 RowBox[{"<<", "\"\<Definitions/IO.wl\>\""}]], "Input",
 CellChangeTimes->{{3.7034261308962336`*^9, 
  3.7034261407476673`*^9}},ExpressionUUID->"b3c3c122-f34b-44f5-b41a-\
8acfc3b6c881"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation and and Eigenvalue function", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.70351515787132*^9, 
  3.703515163192911*^9}},ExpressionUUID->"8fa35250-fd08-448b-a5a9-\
eddb3b76c6d2"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<Definitions/Teukolsky.wl\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<Definitions/Eigenvalues.wl\>\""}]}], "Input",
 CellChangeTimes->{{3.7024501789158287`*^9, 3.702450179247703*^9}, {
   3.7024502470285254`*^9, 3.7024502484678707`*^9}, {3.702450324093417*^9, 
   3.7024503267132316`*^9}, {3.7024505296621456`*^9, 3.702450553663209*^9}, {
   3.702450609664097*^9, 3.702450750973497*^9}, {3.7024507819838047`*^9, 
   3.7024508831417017`*^9}, {3.7024509836877527`*^9, 3.702451089148628*^9}, {
   3.7024511285437355`*^9, 3.702451280213853*^9}, {3.7024513783411307`*^9, 
   3.70245142826882*^9}, {3.7024525999697638`*^9, 3.7024526030734844`*^9}, {
   3.7024526453491707`*^9, 3.702452665272485*^9}, {3.7024532990070496`*^9, 
   3.702453299261078*^9}, {3.702464624058112*^9, 3.702464654880009*^9}, 
   3.702816350040848*^9, {3.703425869936352*^9, 3.7034259016860514`*^9}, {
   3.703438617456894*^9, 
   3.7034386177726545`*^9}},ExpressionUUID->"095849e5-d626-470a-a4ae-\
7910c1e114aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eq", "=", 
   RowBox[{"EqRadial", "/.", "RuleKRadial"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7024501789158287`*^9, 3.702450179247703*^9}, {
   3.7024502470285254`*^9, 3.7024502484678707`*^9}, {3.702450324093417*^9, 
   3.7024503267132316`*^9}, {3.7024505296621456`*^9, 3.702450553663209*^9}, {
   3.702450609664097*^9, 3.702450750973497*^9}, {3.7024507819838047`*^9, 
   3.7024508831417017`*^9}, {3.7024509836877527`*^9, 3.702451089148628*^9}, {
   3.7024511285437355`*^9, 3.702451280213853*^9}, {3.7024513783411307`*^9, 
   3.70245142826882*^9}, {3.7024525999697638`*^9, 3.7024526030734844`*^9}, {
   3.7024526453491707`*^9, 3.702452665272485*^9}, {3.7024532990070496`*^9, 
   3.702453299261078*^9}, {3.702464624058112*^9, 3.702464654880009*^9}, {
   3.702816350040848*^9, 3.7028163537174234`*^9}, {3.702903260136524*^9, 
   3.70290326225555*^9}, {3.7030245941693416`*^9, 3.7030245958726187`*^9}, {
   3.7030246308224525`*^9, 3.7030246438883944`*^9}, 3.703026071290842*^9, {
   3.7034083669267545`*^9, 3.7034083989524007`*^9}, {3.703425888071787*^9, 
   3.7034259100351286`*^9}, {3.703425943850057*^9, 
   3.703425986321912*^9}},ExpressionUUID->"c12c6fd2-5fc8-427d-a950-\
c21db82815c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", 
     RowBox[{"\[ScriptC]_Real", "?", "Negative"}]}], "]"}], ":=", 
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", 
     RowBox[{"-", "\[ScriptM]"}], ",", 
     RowBox[{"-", "\[ScriptC]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{
     RowBox[{"\[ScriptS]_Integer", "?", "Negative"}], ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", "\[ScriptC]_Real"}], "]"}], ":=", 
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{
     RowBox[{"-", "\[ScriptS]"}], ",", "\[ScriptL]", ",", "\[ScriptM]", ",", 
     "\[ScriptC]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer", ",", "\[ScriptC]_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[ScriptCapitalE]", "[", 
     RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "[",
     "\[ScriptC]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]_Integer", ",", 
     RowBox[{"\[ScriptL]_Integer", "?", "NonNegative"}], ",", 
     "\[ScriptM]_Integer"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
       RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}], ")"}]}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalE]", "[", 
    RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Import", "@", 
     RowBox[{"GetSWSHEigenFile", "[", 
      RowBox[{"\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]"}], "]"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7035151705022197`*^9, 
  3.7035151705042243`*^9}},ExpressionUUID->"7028e78c-7816-4a27-94c0-\
3251f994db6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter rules and equation simplification ", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 
  3.703362850927506*^9}},ExpressionUUID->"4e5227e8-100f-4251-a9d8-\
296535fcbc93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleR", "=", 
   RowBox[{"{", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["x", "\[Tau]"], ")"}], 
         RowBox[{"-", "s"}]], 
        SuperscriptBox["x", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"\[Chi]", "/", "\[Tau]"}]}]], 
        RowBox[{"f", "[", "x", "]"}]}]}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nCoef", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleF", "=", 
   RowBox[{"{", 
    RowBox[{"f", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"n", "=", "0"}], "nCoef"], 
        RowBox[{
         RowBox[{"\[ScriptA]", "[", "n", "]"}], " ", 
         SuperscriptBox["x", "n"]}]}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleBoundaryBHole", "=", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ScriptA]", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"\[ScriptB]", "[", "0", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[ScriptCapitalB]"}], " ", 
        SuperscriptBox["\[Tau]", "4"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"\[Tau]", "/", "2"}]}], "+", "\[Chi]"}], ")"}], " ", 
        "\[Chi]"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquationF", "=", 
   RowBox[{"PowerExpand", "@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["x", "\[Tau]"], ")"}], "s"], 
      SuperscriptBox["x", 
       RowBox[{"I", " ", 
        RowBox[{"\[Chi]", "/", "\[Tau]"}]}]], "x", " ", 
      RowBox[{"(", 
       RowBox[{"x", "+", "\[Tau]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Eq", "/.", "\[VeryThinSpace]", "RuleR"}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleParams", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Tau]", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}], 
       RowBox[{"1", "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]]}], ",", 
     RowBox[{
      OverscriptBox["\[CapitalOmega]", "_"], "\[Rule]", 
      FractionBox["\[ScriptCapitalJ]", "2"]}], ",", 
     RowBox[{"\[Chi]", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["\[Omega]", "_"], "-", 
         RowBox[{"m", " ", 
          OverscriptBox["\[CapitalOmega]", "_"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "\[Tau]"}], ")"}]}]}], ",", 
     RowBox[{"rp", "\[Rule]", 
      RowBox[{"1", "+", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalJ]", "2"]}]]}]}], ",", 
     RowBox[{"\[ScriptCapitalB]", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Lambda]", "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"s", "+", "1"}], ")"}]}]}], ")"}], "2"], "-", 
        RowBox[{"4", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"\[ScriptCapitalJ]", " ", 
             OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"]}], "+", 
        RowBox[{"4", "m", " ", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"]}]}], "]"}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], "2"], "-", 
       RowBox[{"2", "m", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[ScriptCapitalJ]", " ", 
           OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}]}], "+", 
       "\[GothicCapitalE]", "-", 
       RowBox[{"s", 
        RowBox[{"(", 
         RowBox[{"s", "+", "1"}], ")"}]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleEigenParamCoef", "=", 
   RowBox[{"{", 
    RowBox[{"\[GothicCapitalE]", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"EigenCoef", "/.", "Rule\[Kappa]pm"}], ")"}], ".", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"\[ScriptCapitalJ]", " ", 
             OverscriptBox["\[Omega]", "_"]}], "rp"], ")"}], 
          RowBox[{"n", "-", "1"}]], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "@", "EigenCoef"}]}], "}"}]}], "]"}]}], "+", 
      RowBox[{"s", 
       RowBox[{"(", 
        RowBox[{"s", "+", "1"}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleEigenParamLeaver", "=", 
   RowBox[{"{", 
    RowBox[{"\[GothicCapitalE]", "\[Rule]", 
     RowBox[{"EigenLeaver", "[", 
      RowBox[{"s", ",", "l", ",", "m", ",", 
       FractionBox[
        RowBox[{"\[ScriptCapitalJ]", " ", 
         OverscriptBox["\[Omega]", "_"]}], "rp"]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleEigenParam", "=", 
   RowBox[{"{", 
    RowBox[{"\[GothicCapitalE]", "\[Rule]", 
     RowBox[{"\[ScriptCapitalE]", "[", 
      RowBox[{"s", ",", "l", ",", "m", ",", 
       FractionBox[
        RowBox[{"\[ScriptCapitalJ]", " ", 
         OverscriptBox["\[Omega]", "_"]}], "rp"]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RuleAllParams", "=", 
   RowBox[{"RuleParams", "~", "Join", "~", "RuleEigenParam"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, 3.7028161983950057`*^9, {3.702816611930849*^9, 
   3.7028166547282743`*^9}, {3.7028167501933465`*^9, 
   3.7028167732842445`*^9}, {3.7028168846283855`*^9, 3.70281688880552*^9}, {
   3.7029016974222364`*^9, 3.70290170884544*^9}, {3.702901862018824*^9, 
   3.702901864895048*^9}, {3.702901895399967*^9, 3.7029018989044437`*^9}, {
   3.7029019328300767`*^9, 3.7029019896379337`*^9}, {3.70290219926057*^9, 
   3.7029022007316165`*^9}, {3.7029022527030687`*^9, 
   3.7029022631707344`*^9}, {3.7029026136404552`*^9, 3.702902656213641*^9}, {
   3.702902690280937*^9, 3.7029026966091814`*^9}, {3.702902791524929*^9, 
   3.7029028268302794`*^9}, {3.702903355065157*^9, 3.702903357115694*^9}, {
   3.7030173782222605`*^9, 3.7030173785248013`*^9}, 3.7030177866537313`*^9, 
   3.703019752454656*^9, {3.7030261457916284`*^9, 3.703026153649619*^9}, {
   3.7030262182789373`*^9, 3.7030262384393153`*^9}, {3.7030269098741713`*^9, 
   3.7030269300308614`*^9}, {3.703248695988945*^9, 3.7032486981768*^9}, {
   3.7032490587471266`*^9, 3.7032490647165127`*^9}, {3.7032491331300306`*^9, 
   3.7032491362553654`*^9}, 3.70325293884263*^9, {3.7034260301987724`*^9, 
   3.7034260374598613`*^9}, {3.703426091848958*^9, 3.7034260963162436`*^9}, {
   3.70342775054784*^9, 3.7034277628785915`*^9}, {3.703437505984835*^9, 
   3.703437546210496*^9}, {3.7034384789541245`*^9, 3.703438490266443*^9}, {
   3.703438531005536*^9, 3.7034385704851694`*^9}, 3.703440345051608*^9, {
   3.7034407029817934`*^9, 3.703440753871106*^9}, {3.7034407999035163`*^9, 
   3.7034408048922586`*^9}, {3.703441172585015*^9, 3.7034413469052525`*^9}, {
   3.703441849285493*^9, 3.7034418979956007`*^9}, {3.7034452222292843`*^9, 
   3.703445231967746*^9}, {3.7034452635698233`*^9, 3.703445303262053*^9}, {
   3.7034549506555777`*^9, 3.703454999549732*^9}, {3.7035150330725317`*^9, 
   3.7035150530406065`*^9}, {3.703584173636782*^9, 3.703584176987528*^9}, {
   3.703584253544962*^9, 3.7035842655896163`*^9}, 3.703594307822569*^9, {
   3.7035945439798045`*^9, 3.7035945450474997`*^9}, 3.703594585154419*^9, {
   3.7053001977975283`*^9, 3.7053002084549417`*^9}, {3.705302602438243*^9, 
   3.7053026120557394`*^9}, {3.7053027545327373`*^9, 3.705302809651326*^9}, {
   3.7063517689403477`*^9, 3.7063517691047087`*^9}, 3.7063521683332767`*^9, {
   3.70635230650008*^9, 3.7063523073229294`*^9}, {3.7063523569412746`*^9, 
   3.706352403819934*^9}, {3.7063574957453365`*^9, 3.706357518043539*^9}, {
   3.7063580360651145`*^9, 3.70635806391311*^9}, {3.7063584251737013`*^9, 
   3.7063584439833603`*^9}, {3.706364468039626*^9, 3.706364496976085*^9}, {
   3.706365435818508*^9, 3.706365501378791*^9}, {3.7063655334872684`*^9, 
   3.7063656045317802`*^9}, {3.70636565331085*^9, 3.7063656880630655`*^9}, {
   3.706365755440624*^9, 3.7063657600538487`*^9}, {3.706366143182962*^9, 
   3.7063661880363865`*^9}, {3.706366272866685*^9, 3.7063662776184845`*^9}, {
   3.7063663950494766`*^9, 3.7063663954979725`*^9}, {3.7063971240420694`*^9, 
   3.7063971248973837`*^9}},ExpressionUUID->"4628c533-75d7-4e4a-8f78-\
7b17bf99ebfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceParams", "[", 
    RowBox[{
    "\[ScriptS]_", ",", "\[ScriptL]_", ",", "\[ScriptM]_", ",", 
     "\[ScriptJ]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PowerExpand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#1", "/.", "RuleBoundaryBHole"}], ")"}], "//.", 
       "\[VeryThinSpace]", "RuleAllParams"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
        RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
        RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
        RowBox[{"\[ScriptCapitalJ]", "\[Rule]", "\[ScriptJ]"}]}], "}"}]}], 
     "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceParams", "[", 
    RowBox[{
    "\[ScriptS]_", ",", "\[ScriptL]_", ",", "\[ScriptM]_", ",", "\[ScriptJ]_",
      ",", "\[ScriptW]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PowerExpand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#1", "/.", "RuleBoundaryBHole"}], ")"}], "//.", 
       "\[VeryThinSpace]", "RuleAllParams"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "\[Rule]", "\[ScriptS]"}], ",", 
        RowBox[{"l", "\[Rule]", "\[ScriptL]"}], ",", 
        RowBox[{"m", "\[Rule]", "\[ScriptM]"}], ",", 
        RowBox[{"\[ScriptCapitalJ]", "\[Rule]", "\[ScriptJ]"}], ",", 
        RowBox[{
         OverscriptBox["\[Omega]", "_"], "\[Rule]", "\[ScriptW]"}]}], "}"}]}],
      "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702453320689039*^9, 3.702453351361938*^9}, {
   3.7024534091408744`*^9, 3.7024534570470533`*^9}, {3.7024535326846795`*^9, 
   3.7024535904144454`*^9}, {3.702453797280878*^9, 3.702453860063058*^9}, {
   3.7024645791090827`*^9, 3.7024645832973194`*^9}, {3.7024646737992067`*^9, 
   3.7024649899653363`*^9}, {3.70246503571766*^9, 3.7024651259153013`*^9}, 
   3.702465172634999*^9, {3.7024652326900187`*^9, 3.7024653308878794`*^9}, {
   3.702465399116948*^9, 3.7024654156507998`*^9}, {3.7024664462783513`*^9, 
   3.7024664574712157`*^9}, {3.7024664925616865`*^9, 3.702466621817746*^9}, {
   3.7024667297090063`*^9, 3.702466748905449*^9}, {3.7024672279723167`*^9, 
   3.7024672439815426`*^9}, {3.702471084299986*^9, 3.7024710858129344`*^9}, {
   3.702473789841436*^9, 3.70247379516366*^9}, {3.702474823929513*^9, 
   3.7024748633460093`*^9}, {3.7024784358345327`*^9, 
   3.7024784374007015`*^9}, {3.702479050082479*^9, 3.7024790521449966`*^9}, {
   3.7027161950385003`*^9, 3.702716197489009*^9}, {3.7027318899018416`*^9, 
   3.7027320980016403`*^9}, {3.7027321623339214`*^9, 
   3.7027321923348083`*^9}, {3.702737211576818*^9, 3.7027372308510647`*^9}, {
   3.702795978073827*^9, 3.7027959996095085`*^9}, {3.702796099919592*^9, 
   3.702796108651952*^9}, {3.7027968124303913`*^9, 3.702796815777197*^9}, {
   3.7027968768453407`*^9, 3.7027968823759813`*^9}, {3.7027973253388553`*^9, 
   3.702797340111969*^9}, 3.7027973891984854`*^9, {3.7027974412256136`*^9, 
   3.702797444747754*^9}, {3.70279782645781*^9, 3.7027978579494195`*^9}, 
   3.7028027724724293`*^9, 3.7028029031782117`*^9, 3.702802973422025*^9, 
   3.7028035818054037`*^9, {3.7028161983950057`*^9, 3.702816273289017*^9}, {
   3.7028164165232286`*^9, 3.7028164168240695`*^9}, {3.7028165633803825`*^9, 
   3.7028165680451326`*^9}, {3.7028166679089003`*^9, 
   3.7028166719379597`*^9}, {3.7032487044743595`*^9, 
   3.7032487046304893`*^9}, {3.703437424003914*^9, 3.703437428647217*^9}, {
   3.703438316102044*^9, 3.7034383169655704`*^9}, {3.703440795846078*^9, 
   3.70344082474494*^9}, {3.7034413284656897`*^9, 3.703441337947645*^9}, {
   3.703445319218295*^9, 3.7034453518337355`*^9}, {3.703448381904971*^9, 
   3.7034484337781653`*^9}, {3.705303259634863*^9, 3.7053032834829473`*^9}, {
   3.7063657948408546`*^9, 3.7063657983103943`*^9}, {3.7063658311873536`*^9, 
   3.7063658801872916`*^9}, {3.706366010468115*^9, 3.706366012468909*^9}, {
   3.7063662082155504`*^9, 3.706366215306419*^9}, {3.706366376626693*^9, 
   3.7063663884239445`*^9}},ExpressionUUID->"9d6c6f5c-c311-4998-94e8-\
bf68fb824698"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FSeriesCoef", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"First", "@", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"EquationF", "/.", "RuleF"}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"nCoef", "+", "1"}]}], "]"}], "]"}], "\[Equal]", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[ScriptA]", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "nCoef"}], "}"}]}], "]"}], "//", 
        "Evaluate"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703595207592647*^9, 3.703595284800352*^9}, {
  3.706351828316347*^9, 3.706351830699242*^9}, {3.7063561189646482`*^9, 
  3.7063561201026*^9}, {3.7063656989209957`*^9, 
  3.706365772922082*^9}},ExpressionUUID->"3d4c3d97-4518-4168-8d2a-\
29bad5322460"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation solver definition ", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 3.703362850927506*^9}, {3.7033628873014746`*^9, 
  3.703362901731254*^9}},ExpressionUUID->"2093726c-6042-449e-966d-\
12c658089baa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "14."}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xM", ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], 
     RowBox[{"Abs", "[", 
      OverscriptBox["\[Omega]", "_"], "]"}]], "*", "700"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032486522344265`*^9, 3.7032486524688106`*^9}, {
   3.7032489270761104`*^9, 3.7032489516256003`*^9}, {3.703249858354682*^9, 
   3.703249880919569*^9}, {3.7034409952555046`*^9, 3.703441000664761*^9}, 
   3.7035922862895617`*^9, {3.703592920838398*^9, 3.7035929230090084`*^9}, 
   3.703680779826338*^9, {3.7063571338092384`*^9, 3.706357133989753*^9}, {
   3.706362759691209*^9, 3.706362768017998*^9}, 3.706362865347412*^9, {
   3.706396742289168*^9, 3.7063967652225475`*^9}, {3.7064372063136096`*^9, 
   3.7064372070044465`*^9}, {3.7064793907327533`*^9, 3.706479391153875*^9}, {
   3.706479464537466*^9, 3.7064794647158875`*^9}, {3.7064796535141644`*^9, 
   3.7064796557181835`*^9}, {3.7065735597094526`*^9, 3.706573563038085*^9}, {
   3.7065736024483995`*^9, 
   3.706573609308622*^9}},ExpressionUUID->"399de46d-9855-4ac4-b294-\
14b5a051c165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "Solve\[Omega]F"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IncreasePrecision", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecisionGoal", "\[Rule]", "12"}], ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "15"}], ",", 
     RowBox[{"MaxSteps", "\[Rule]", "Automatic"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve\[Omega]F", "[", 
   RowBox[{
    RowBox[{"\[ScriptS]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptL]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptM]_", "?", "IntegerQ"}], ",", 
    RowBox[{"\[ScriptJ]_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Solve\[Omega]F", "[", 
   RowBox[{
   "\[ScriptS]", ",", "\[ScriptL]", ",", "\[ScriptM]", ",", "\[ScriptJ]", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"0.0001", ",", "0.65", ",", "0.004"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve\[Omega]F", "[", 
     RowBox[{
      RowBox[{"\[ScriptS]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptL]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptM]_", "?", "IntegerQ"}], ",", 
      RowBox[{"\[ScriptJ]_", "?", "NumberQ"}], ",", 
      RowBox[{"{", 
       RowBox[{"omega__", "?", "NumberQ"}], "}"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"0", "<", "\[ScriptJ]", "<", "1"}], "&&", 
     RowBox[{
      RowBox[{"Abs", "[", "\[ScriptS]", "]"}], "\[Equal]", "1"}], "&&", 
     RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
        RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqF", ",", "del\[Omega]", ",", "ics", ",", "fInf", ",", 
       RowBox[{"k", "=", "0"}], ",", "last", ",", "olist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "k", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{
        RowBox[{"last", "=", 
         RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
        RowBox[{"localk", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eqF", ",", "del\[Omega]", ",", "ics", ",", "fInf"}], "}"}], 
       "=", 
       RowBox[{
        RowBox[{"ReplaceParams", "[", 
         RowBox[{
         "\[ScriptS]", ",", "\[ScriptM]", ",", "\[ScriptL]", ",", 
          "\[ScriptJ]"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"EquationF", ",", 
          RowBox[{"m", " ", 
           OverscriptBox["\[CapitalOmega]", "_"]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"f", "[", "x0", "]"}], ",", 
                RowBox[{
                 SuperscriptBox["f", "\[Prime]",
                  MultilineFunction->None], "[", "x0", "]"}]}], "}"}], "/.", 
              "\[VeryThinSpace]", "RuleF"}], "/.", "\[VeryThinSpace]", 
             "FSeriesCoef"}], ")"}], "/.", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[ScriptS]", "<", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[ScriptA]", "\[Rule]", "\[ScriptB]"}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"f", "[", "xM", "]"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ScriptS]", 
                OverscriptBox["\[Omega]", "_"], " ", "xM"}], "-", 
               RowBox[{
                RowBox[{"\[Chi]", "/", "\[Tau]"}], " ", 
                RowBox[{"Log", "[", "xM", "]"}]}]}], ")"}]}]]}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"olist", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"{", "omega", "}"}], ",", "del\[Omega]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"localk", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "]"}], "-", "last"}], ">", "1"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"last", "=", 
               RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
              RowBox[{"k", "+=", "localk"}], ";", 
              RowBox[{"localk", "=", "0"}]}]}], "]"}], ";", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[ScriptJ]", ",", 
              OverscriptBox["\[Omega]", "_"], ",", "fInf"}], "}"}], "/.", 
            RowBox[{"First", "@", 
             RowBox[{"NDSolve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqF", "\[Equal]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "[", "x0", "]"}], ",", 
                    RowBox[{
                    SuperscriptBox["f", "\[Prime]",
                    MultilineFunction->None], "[", "x0", "]"}]}], "}"}], 
                  "\[Equal]", "ics"}]}], "}"}], ",", "f", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "x0", ",", "xM"}], "}"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"{", "opts", "}"}], ",", " ", 
                  RowBox[{"Options", "[", "NDSolve", "]"}]}], "]"}]}]}], 
              "]"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            OverscriptBox["\[Omega]", "_"], ",", "olist"}], "}"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "@", "olist"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032479911953154`*^9, 3.703247996555267*^9}, {
   3.7032480751429873`*^9, 3.7032480854878054`*^9}, {3.7032481957662406`*^9, 
   3.703248520441369*^9}, {3.7032485561014185`*^9, 3.7032486722365575`*^9}, {
   3.7032487151159787`*^9, 3.703248835316387*^9}, {3.7032488851965933`*^9, 
   3.7032489068239746`*^9}, {3.703248963001816*^9, 3.7032490312278147`*^9}, {
   3.703249061434952*^9, 3.7032494954966574`*^9}, {3.7032495303910027`*^9, 
   3.7032495577063985`*^9}, {3.703249661248683*^9, 3.703249661561182*^9}, {
   3.7032501776207466`*^9, 3.7032502610672064`*^9}, {3.7032503561397767`*^9, 
   3.7032503957220106`*^9}, {3.7032504610259376`*^9, 3.703250633983*^9}, {
   3.7032506691586294`*^9, 3.7032508425207057`*^9}, {3.70325087411078*^9, 
   3.703251038985026*^9}, {3.7032510828335433`*^9, 3.703251096037957*^9}, {
   3.703251150903144*^9, 3.70325118529745*^9}, {3.7032512337252235`*^9, 
   3.7032515506146297`*^9}, {3.7032516159652867`*^9, 
   3.7032516178248596`*^9}, {3.7032516478593383`*^9, 3.703251656657111*^9}, {
   3.7032518043453827`*^9, 3.7032519215669413`*^9}, 3.703251976666548*^9, {
   3.7032520130141706`*^9, 3.70325207322369*^9}, {3.7032521269168873`*^9, 
   3.7032522198798704`*^9}, {3.703252420962175*^9, 3.703252484078147*^9}, {
   3.703252528190548*^9, 3.7032525454579735`*^9}, {3.7032526444907727`*^9, 
   3.703252700979662*^9}, {3.7032527576950035`*^9, 3.7032528562696886`*^9}, {
   3.7032529734135237`*^9, 3.703252974929412*^9}, {3.70325308947402*^9, 
   3.703253107085228*^9}, {3.703439169032401*^9, 3.7034391727080903`*^9}, {
   3.703439219741864*^9, 3.703439262965007*^9}, {3.7034393601789913`*^9, 
   3.703439371755516*^9}, {3.703439431885885*^9, 3.703439468696843*^9}, {
   3.7034395444494195`*^9, 3.7034396295999794`*^9}, {3.7034398684292974`*^9, 
   3.7034399079948196`*^9}, {3.7034401641528325`*^9, 3.703440176110317*^9}, 
   3.7034403125837383`*^9, {3.703440890712477*^9, 3.703440970878158*^9}, {
   3.703441140779724*^9, 3.7034411476235914`*^9}, {3.703441372198664*^9, 
   3.703441392886749*^9}, {3.703441630536874*^9, 3.7034416332408333`*^9}, {
   3.7034416819864483`*^9, 3.7034416894412093`*^9}, {3.703441784640492*^9, 
   3.703441791755392*^9}, 3.7035922946687098`*^9, {3.7035923258316507`*^9, 
   3.703592349604534*^9}, {3.703592412445154*^9, 3.7035924139477444`*^9}, {
   3.703592865850735*^9, 3.703592880288189*^9}, 3.703594188683025*^9, {
   3.7035949341306705`*^9, 3.703594994915739*^9}, {3.703680556175576*^9, 
   3.703680567207687*^9}, {3.7036806121028013`*^9, 3.7036806191753826`*^9}, {
   3.703681207949263*^9, 3.7036812082762814`*^9}, {3.7036815319041595`*^9, 
   3.7036815739339695`*^9}, {3.703683150130017*^9, 3.7036831520513124`*^9}, {
   3.70530030780923*^9, 3.705300312419084*^9}, {3.705302993388293*^9, 
   3.705303064483638*^9}, 3.705303255071862*^9, {3.70635745369534*^9, 
   3.706357454896655*^9}, {3.7063621425824976`*^9, 3.70636226589053*^9}, {
   3.7063623241049795`*^9, 3.7063623491557612`*^9}, {3.706366328710255*^9, 
   3.7063663671826563`*^9}, {3.706366564329916*^9, 3.7063665863954678`*^9}, {
   3.706366654632304*^9, 3.706366655855893*^9}, {3.706366755183197*^9, 
   3.7063667568330483`*^9}, {3.7063669407557087`*^9, 
   3.7063669423213663`*^9}, {3.7063669908051586`*^9, 3.706366990957624*^9}, {
   3.706564367583295*^9, 3.7065644033528533`*^9}, {3.706564722390547*^9, 
   3.70656475166516*^9}, {3.706565253258112*^9, 3.706565263524843*^9}, 
   3.706566135666058*^9, {3.7065694849769473`*^9, 3.7065694886492395`*^9}, {
   3.7065718165429783`*^9, 3.7065718209339404`*^9}, {3.7065718671889906`*^9, 
   3.7065718813622417`*^9}, {3.706572008907193*^9, 3.706572160595066*^9}, {
   3.706572290327571*^9, 3.706572294343772*^9}, {3.7065726758351326`*^9, 
   3.7065727403577414`*^9}, {3.7065727916288605`*^9, 3.706572872231002*^9}, {
   3.706572903593709*^9, 3.7065730151762085`*^9}, {3.7065730642752604`*^9, 
   3.706573084121194*^9}, {3.7065732125878105`*^9, 3.706573237715481*^9}, {
   3.7065733045885925`*^9, 3.7065733989268956`*^9}, {3.706573566850977*^9, 
   3.7065735982916775`*^9}, {3.7066134524079313`*^9, 
   3.7066134559949365`*^9}},ExpressionUUID->"9aa09165-7d07-4ff5-9efd-\
84926cd5a4fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ScriptCapitalB]", "2"], " ", 
     SuperscriptBox["\[Tau]", "2"]}], 
    RowBox[{"16", " ", 
     OverscriptBox["\[Omega]", "_"], " ", "\[Chi]", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Tau]", "2"], "4"], "+", 
       SuperscriptBox["\[Chi]", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"\[ScriptB]", "[", "0", "]"}], "]"}], "2"]}]], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptB]", "[", "0", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[ScriptCapitalB]"}], " ", 
       SuperscriptBox["\[Tau]", "4"], 
       RowBox[{"\[ScriptA]", "[", "0", "]"}]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Tau]", "/", "2"}]}], "+", "\[Chi]"}], ")"}], " ", 
       "\[Chi]"}]]}], "}"}]}], "//", "ComplexExpand"}]], "Input",ExpressionUUI\
D->"06985337-9dfa-46bc-83d8-6d18ab84ab09"],

Cell[BoxData[
 FractionBox["\[Chi]", 
  RowBox[{
   SuperscriptBox["\[Tau]", "6"], " ", 
   OverscriptBox["\[Omega]", "_"], " ", 
   SuperscriptBox[
    RowBox[{"\[ScriptA]", "[", "0", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7066059319368095`*^9, 3.706606071724432*^9, 
  3.7066134415469418`*^9},ExpressionUUID->"e7794f29-ab4d-4bdd-8f84-\
a39163a3853e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FormatZ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalJ]", ",", 
        OverscriptBox["\[Omega]", "_"], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           OverscriptBox["\[Omega]", "_"], " ", 
           SuperscriptBox["\[Tau]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{"\[ScriptA]", "[", "0", "]"}], "]"}], "2"]}], 
          RowBox[{"\[Chi]", " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "#3", "]"}], "2"]}]]}], ",", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           FractionBox[
            RowBox[{"\[Chi]", " ", 
             SuperscriptBox[
              RowBox[{"Abs", "[", "#4", "]"}], "2"]}], 
            RowBox[{
             SuperscriptBox["\[Tau]", "6"], " ", 
             OverscriptBox["\[Omega]", "_"], " ", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{"\[ScriptA]", "[", "0", "]"}], "]"}], "2"]}]]}]]}], 
        ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           FractionBox["#4", 
            RowBox[{"#3", " ", 
             SuperscriptBox["\[Tau]", "2"]}]], "]"}], "2"], "-", "1"}]}], 
       "}"}], "//", 
      RowBox[{"ReplaceParams", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "#1", ",", "#2"}], 
       "]"}]}], ")"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Format\[Phi]", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2", ",", 
        RowBox[{"rp", " ", "\[Tau]", " ", 
         RowBox[{"Re", "@", "#3"}]}], ",", 
        RowBox[{"rp", " ", "\[Tau]", " ", 
         RowBox[{"Im", "@", "#3"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"rp", " ", "\[Tau]", " "}]], 
         RowBox[{"Re", "@", "#4"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"rp", " ", "\[Tau]", " "}]], 
         RowBox[{"Im", "@", "#4"}]}]}], "}"}], "//", 
      RowBox[{"ReplaceParams", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "#1", ",", "#2"}], 
       "]"}]}], ")"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7036820689789276`*^9, 3.7036821232171173`*^9}, {
   3.7036823658058944`*^9, 3.703682404242482*^9}, {3.703682473742774*^9, 
   3.7036824744483633`*^9}, 3.7036825083254995`*^9, {3.7036830280748253`*^9, 
   3.7036830317214594`*^9}, {3.703683511645869*^9, 3.7036835328824015`*^9}, {
   3.7036838472080727`*^9, 3.7036838651748767`*^9}, {3.7036884894433928`*^9, 
   3.703688498414929*^9}, {3.7036894276730037`*^9, 3.703689429832308*^9}, {
   3.7036895787961736`*^9, 3.7036895955010157`*^9}, {3.7036916385020275`*^9, 
   3.703691638986832*^9}, {3.703691720405348*^9, 3.703691731141308*^9}, {
   3.7036919869055033`*^9, 3.7036919872663603`*^9}, 3.7036920850955367`*^9, 
   3.7036926996474285`*^9, {3.7036929152399015`*^9, 3.7036929749173746`*^9}, {
   3.7038304559295616`*^9, 3.7038305206083646`*^9}, {3.7038305611282816`*^9, 
   3.7038305817740498`*^9}, {3.703831510836725*^9, 3.703831522041003*^9}, {
   3.7038316111285725`*^9, 3.703831615863457*^9}, 3.7038317614537735`*^9, {
   3.705300098458987*^9, 3.705300126915119*^9}, 3.70530017060714*^9, {
   3.7053035053292446`*^9, 3.7053035131738358`*^9}, {3.706363124875147*^9, 
   3.7063632902841034`*^9}, {3.7063634833652487`*^9, 
   3.7063635006791325`*^9}, {3.706363982491045*^9, 3.706364048577293*^9}, {
   3.7063640985712976`*^9, 3.7063641041611753`*^9}, {3.7063641357389717`*^9, 
   3.706364153770547*^9}, {3.70636421490446*^9, 3.706364242412177*^9}, {
   3.7063643113228984`*^9, 3.7063643398819246`*^9}, {3.7063643750542*^9, 
   3.7063643844947042`*^9}, {3.706364436570529*^9, 3.7063644474534144`*^9}, {
   3.706364515911289*^9, 3.7063645459078627`*^9}, 3.706364601529312*^9, {
   3.706364881307993*^9, 3.7063648932107973`*^9}, {3.706364923760295*^9, 
   3.706364948090023*^9}, {3.7063650257836485`*^9, 3.7063650528695765`*^9}, {
   3.706366983804334*^9, 3.7063670067192707`*^9}, {3.706367101538171*^9, 
   3.7063671015401754`*^9}, {3.7063671406344676`*^9, 3.70636714569337*^9}, {
   3.706367641189551*^9, 3.7063676691911964`*^9}, {3.7063677452344613`*^9, 
   3.7063678430215464`*^9}, {3.7066057638891177`*^9, 3.7066058150648704`*^9}, 
   3.7066058458298397`*^9, {3.7066060304360533`*^9, 
   3.706606034480236*^9}},ExpressionUUID->"8d80de38-236e-4066-a03d-\
6d36b36be3df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Start calculation and export data", "Section",
 CellChangeTimes->{{3.7033627642611322`*^9, 3.7033627970613737`*^9}, {
  3.703362834288005*^9, 3.703362850927506*^9}, {3.7033628873014746`*^9, 
  3.7033629351261253`*^9}},ExpressionUUID->"2a83e9bf-31f4-429d-8b31-\
68c978e649e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Spin", "=", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"0.01", ",", "0.99", ",", "0.01"}], "]"}], "\[Union]", 
    RowBox[{"{", 
     RowBox[{"0.995", ",", "0.999", ",", "0.9995", ",", "0.9999"}], "}"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.706571163106142*^9, 3.706571198875736*^9}, {
  3.706573774231578*^9, 
  3.7065737768412*^9}},ExpressionUUID->"a48b86f6-bfaf-48c1-8c88-7e037575f035"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Omega", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"\[ScriptJ]", ",", 
     RowBox[{"0.0001", "+", 
      RowBox[{"Range", "@@", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[ScriptJ]", "2"]}]]}], ")"}], " ", "0.6"}], 
           ",", "0.05"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "450"], " ", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   SuperscriptBox["\[ScriptJ]", "2"]}]]}], ")"}], " ", 
               "0.6"}], ",", "0.05"}], "]"}]}], ",", "0.0005"}], "]"}]}], 
        "}"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaDetailed", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"\[ScriptJ]", ",", 
     RowBox[{"0.0001", "+", 
      RowBox[{"Range", "@@", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"First", "@", 
          RowBox[{"TakeSmallest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[ScriptJ]", ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[ScriptJ]", "2"]}]]}], ")"}], " ", 
                 "0.6"}], ",", "0.05"}], "]"}]}], "}"}], ",", "1"}], "]"}]}], 
         ",", 
         RowBox[{"First", "@", 
          RowBox[{"TakeSmallest", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"0.01", "\[ScriptJ]"}], ",", "0.0001"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", "450"], " ", 
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SqrtBox[
                    RowBox[{"1", "-", 
                    SuperscriptBox["\[ScriptJ]", "2"]}]]}], ")"}], " ", 
                    "0.6"}], ",", "0.05"}], "]"}]}], ",", "0.0005"}], "]"}]}],
              "}"}], ",", "1"}], "]"}]}]}], "}"}]}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7036820689789276`*^9, 3.7036821232171173`*^9}, {
   3.7036823658058944`*^9, 3.703682404242482*^9}, {3.703682473742774*^9, 
   3.7036824744483633`*^9}, 3.7036825083254995`*^9, {3.7036830280748253`*^9, 
   3.7036830317214594`*^9}, {3.703683511645869*^9, 3.7036835328824015`*^9}, {
   3.7036838472080727`*^9, 3.7036838651748767`*^9}, {3.7036884894433928`*^9, 
   3.703688498414929*^9}, {3.7036894276730037`*^9, 3.703689429832308*^9}, {
   3.7036895787961736`*^9, 3.7036895955010157`*^9}, {3.7036916385020275`*^9, 
   3.703691638986832*^9}, {3.703691720405348*^9, 3.703691731141308*^9}, {
   3.7036919869055033`*^9, 3.7036919872663603`*^9}, 3.7036920850955367`*^9, 
   3.7036926996474285`*^9, {3.7036929152399015`*^9, 3.7036929749173746`*^9}, {
   3.7038304559295616`*^9, 3.7038305206083646`*^9}, {3.7038305611282816`*^9, 
   3.7038305817740498`*^9}, {3.703831510836725*^9, 3.703831522041003*^9}, {
   3.7038316111285725`*^9, 3.703831615863457*^9}, {3.7038317614537735`*^9, 
   3.703831762938445*^9}, {3.7063680655590973`*^9, 3.7063680892830906`*^9}, {
   3.706567044919056*^9, 
   3.7065670890800047`*^9}},ExpressionUUID->"04c785dd-b996-41b6-b674-\
ce28e32a80dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"PutAppendCSV", ",", "ExportAllCSV"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PutAppendCSV", "[", 
    RowBox[{"file_", ",", 
     RowBox[{"data_", "?", "ArrayQ"}]}], "]"}], ":=", 
   RowBox[{"WriteString", "[", 
    RowBox[{"file", ",", 
     RowBox[{"ExportString", "[", 
      RowBox[{"data", ",", "\"\<CSV\>\""}], "]"}], ",", "\"\<\\n\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportAllCSV", "[", 
    RowBox[{
     RowBox[{"\[ScriptS]_", "?", "IntegerQ"}], ",", 
     RowBox[{"\[ScriptL]_", "?", "IntegerQ"}], ",", 
     RowBox[{"\[ScriptM]_", "?", "IntegerQ"}], ",", 
     RowBox[{"\[ScriptJ]", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", "?", "NumberQ"}], "}"}], "|", 
       RowBox[{"\[ScriptJ]_", "?", "NumberQ"}]}]}], ",", "OmegaF_Function", 
     ",", 
     RowBox[{"eof_String:", "\"\<\>\""}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"And", "@@", 
     RowBox[{"Thread", "[", 
      RowBox[{"0", "<", "\[ScriptJ]", "<", "1"}], "]"}]}], "&&", 
    RowBox[{
     RowBox[{"Abs", "[", "\[ScriptS]", "]"}], "\[Equal]", "1"}], "&&", 
    RowBox[{"\[ScriptL]", "\[GreaterEqual]", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "\[ScriptS]", "]"}], ",", 
       RowBox[{"Abs", "[", "\[ScriptM]", "]"}]}], "]"}]}]}]}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dataP", ",", "dataM", ",", "tmpPrint", ",", 
      RowBox[{"spins", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "\[ScriptJ]", "}"}], "]"}]}], ",", "Ns", ",", "spin", 
      ",", "time", ",", "timeList", ",", "fileZ", ",", "file\[Phi]"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ns", "=", 
      RowBox[{"Length", "@", "spins"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fileZ", "=", 
      RowBox[{"GetZFile", "[", 
       RowBox[{
        RowBox[{"Abs", "@", "\[ScriptS]"}], ",", "\[ScriptL]", ",", 
        "\[ScriptM]", ",", "eof"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"file\[Phi]", "=", 
      RowBox[{"Get\[Phi]File", "[", 
       RowBox[{
        RowBox[{"Abs", "@", "\[ScriptS]"}], ",", "\[ScriptL]", ",", 
        "\[ScriptM]", ",", "eof"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"DeleteFile", "[", 
       RowBox[{"{", 
        RowBox[{"fileZ", ",", "file\[Phi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"time", "=", 
      RowBox[{"First", "@", 
       RowBox[{"AbsoluteTiming", "@", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tmpPrint", "=", 
            RowBox[{"PrintTemporary", "@", 
             RowBox[{"StringRiffle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<\[ScriptS] = +\>\"", ",", 
                 RowBox[{"Abs", "@", "\[ScriptS]"}], ",", 
                 "\"\<, \[ScriptCapitalJ] = \>\"", ",", 
                 RowBox[{
                 "spins", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "\"\<  (\>\"", ",", 
                 RowBox[{
                  RowBox[{"2", "i"}], "-", "1"}], ",", "\"\< of \>\"", ",", 
                 RowBox[{"2", "Ns"}], ",", "\"\<)\>\""}], "}"}], ",", 
               "\"\<\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dataP", "=", 
            RowBox[{"Solve\[Omega]F", "[", 
             RowBox[{
              RowBox[{"Abs", "@", "\[ScriptS]"}], ",", "\[ScriptL]", ",", 
              "\[ScriptM]", ",", 
              RowBox[{
              "spins", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{"OmegaF", "@", 
               RowBox[{
               "spins", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ",", "opts"}], "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"NotebookDelete", "[", "tmpPrint", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpPrint", "=", 
            RowBox[{"PrintTemporary", "@", 
             RowBox[{"StringRiffle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<\[ScriptS] = \>\"", ",", 
                 RowBox[{"-", 
                  RowBox[{"Abs", "[", "\[ScriptS]", "]"}]}], ",", 
                 "\"\<, \[ScriptCapitalJ] = \>\"", ",", 
                 RowBox[{
                 "spins", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "\"\<  (\>\"", ",", 
                 RowBox[{"2", " ", "i"}], ",", "\"\< of \>\"", ",", 
                 RowBox[{"2", " ", "Ns"}], ",", "\"\<)\>\""}], "}"}], ",", 
               "\"\<\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dataM", "=", 
            RowBox[{"Solve\[Omega]F", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Abs", "@", "\[ScriptS]"}]}], ",", "\[ScriptL]", ",", 
              "\[ScriptM]", ",", 
              RowBox[{
              "spins", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{"OmegaF", "@", 
               RowBox[{
               "spins", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ",", "opts"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PutAppendCSV", "[", 
            RowBox[{"fileZ", ",", 
             RowBox[{"FormatZ", "@@@", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"dataP", ",", "dataM"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "2", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PutAppendCSV", "[", 
            RowBox[{"file\[Phi]", ",", 
             RowBox[{"Format\[Phi]", "@@@", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"dataP", ",", "dataM"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "2", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NotebookDelete", "[", "tmpPrint", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "Ns"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Quiet", "@*", "Close"}], "/@", 
      RowBox[{"{", 
       RowBox[{"fileZ", ",", "file\[Phi]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"timeList", "=", 
      RowBox[{"First", "@", 
       RowBox[{"QuantityMagnitude", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"Quantity", "[", 
           RowBox[{
            RowBox[{"Round", "@", "time"}], ",", "\"\<Seconds\>\""}], "]"}], 
          ",", 
          RowBox[{"MixedUnit", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hours\>\"", ",", "\"\<Minutes\>\"", ",", "\"\<Seconds\>\""}],
             "}"}], "]"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"StringRiffle", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Completed\>\"", ",", "eof", ",", 
          "\"\<files with (\[ScriptS],\[ScriptL],m)=\>\""}], "}"}], "]"}], "<>", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Abs", "@", "\[ScriptS]"}], ",", "\[ScriptL]", ",", 
           "\[ScriptM]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<(\>\"", ",", "\"\<,\>\"", ",", "\"\<)\>\""}], "}"}]}], 
        "]"}], "<>", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{"{", 
         RowBox[{"\"\< for\>\"", ",", "Ns", ",", "\"\<spin(s)\>\""}], "}"}], 
        "]"}], "<>", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\< in \>\"", ",", "\"\<h \>\"", ",", "\"\<m \>\"", ",", 
            "\"\<s\>\""}], "}"}], ",", 
          RowBox[{"ToString", "/@", 
           RowBox[{"MapAt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IntegerString", "[", 
               RowBox[{"#", ",", "10", ",", "2"}], "]"}], "&"}], ",", 
             "timeList", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "2", "}"}], ",", 
               RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7036820689789276`*^9, 3.7036821232171173`*^9}, {
   3.7036823658058944`*^9, 3.703682404242482*^9}, {3.703682473742774*^9, 
   3.7036824744483633`*^9}, 3.7036825083254995`*^9, {3.7036830280748253`*^9, 
   3.7036830317214594`*^9}, {3.703683511645869*^9, 3.7036835328824015`*^9}, {
   3.7036838472080727`*^9, 3.7036838651748767`*^9}, {3.7036884894433928`*^9, 
   3.703688498414929*^9}, {3.7036894276730037`*^9, 3.703689429832308*^9}, {
   3.7036895787961736`*^9, 3.7036895955010157`*^9}, {3.7036916385020275`*^9, 
   3.703691638986832*^9}, {3.703691720405348*^9, 3.703691731141308*^9}, {
   3.7036919869055033`*^9, 3.7036919872663603`*^9}, 3.7036920850955367`*^9, 
   3.7036926996474285`*^9, {3.7036929152399015`*^9, 3.7036929749173746`*^9}, {
   3.7038304559295616`*^9, 3.7038305206083646`*^9}, {3.7038305611282816`*^9, 
   3.7038305817740498`*^9}, {3.703831510836725*^9, 3.703831522041003*^9}, {
   3.7038316111285725`*^9, 3.703831615863457*^9}, {3.7038317614537735`*^9, 
   3.703831762938445*^9}, {3.703832244234212*^9, 3.703832373440891*^9}, {
   3.703832426441241*^9, 3.703832610541958*^9}, {3.7038326569515495`*^9, 
   3.7038326589673944`*^9}, {3.7038327206629314`*^9, 
   3.7038327217880945`*^9}, {3.7038328292052345`*^9, 3.703832832221182*^9}, {
   3.7063687900356054`*^9, 3.7063688595487776`*^9}, {3.706368904576688*^9, 
   3.7063689560657787`*^9}, {3.7064742901006575`*^9, 3.706474291419943*^9}, {
   3.706474330487915*^9, 3.7064743615482707`*^9}, {3.7065148052197633`*^9, 
   3.7065148257063503`*^9}, {3.7065657665654516`*^9, 
   3.7065658737798014`*^9}, {3.70656593759924*^9, 3.706565995261608*^9}, {
   3.706566030890278*^9, 3.7065660988184175`*^9}, {3.706566148464429*^9, 
   3.7065661602311616`*^9}, {3.706566195781955*^9, 3.7065662196751227`*^9}, {
   3.7065662531318016`*^9, 3.706566314903989*^9}, {3.706566390927549*^9, 
   3.706566449949583*^9}, {3.70656648579714*^9, 3.7065665553045244`*^9}, {
   3.7065665883547783`*^9, 3.706566693444213*^9}, {3.706566729869955*^9, 
   3.706566891074582*^9}, {3.7065669212026634`*^9, 3.7065669304223766`*^9}, 
   3.706567116207889*^9, {3.706567148320533*^9, 3.706567149461319*^9}, {
   3.706567210155366*^9, 3.706567218265478*^9}, {3.7065676731766176`*^9, 
   3.7065680178381233`*^9}, {3.7065680614678664`*^9, 3.70656809172109*^9}, {
   3.7065682881166706`*^9, 3.7065684286314726`*^9}, {3.7065684886222534`*^9, 
   3.7065686204330997`*^9}, {3.7065686592341003`*^9, 3.706568816641453*^9}, {
   3.7065690652303653`*^9, 3.706569066511785*^9}, {3.7065700534838133`*^9, 
   3.706570054358877*^9}, {3.7065707104955487`*^9, 3.706570717918367*^9}, {
   3.706570756953766*^9, 3.7065708806855087`*^9}, {3.706571240583256*^9, 
   3.7065712628356357`*^9}, {3.706571812823704*^9, 3.706571813183149*^9}, {
   3.706571857266096*^9, 3.7065718613290157`*^9}, {3.7065732710851727`*^9, 
   3.706573285727244*^9}, {3.7066064551903353`*^9, 3.7066064627121572`*^9}, 
   3.706606609910313*^9, {3.7066083490222425`*^9, 3.7066083510903397`*^9}, {
   3.706610302223364*^9, 3.706610344428008*^9}, {3.706610387670802*^9, 
   3.7066104322056675`*^9}, {3.7066104756313925`*^9, 3.706610475778283*^9}, {
   3.7066105837205276`*^9, 3.706610734324541*^9}, {3.7066109526139336`*^9, 
   3.7066109553173075`*^9}, {3.7066110375474167`*^9, 
   3.7066111048811083`*^9}, {3.7066114398948727`*^9, 3.7066114799047823`*^9}, 
   3.7066123088841696`*^9, {3.70661255606288*^9, 3.7066125628042617`*^9}, {
   3.706612764025735*^9, 3.7066127653800774`*^9}, {3.7066133316443586`*^9, 
   3.706613337651805*^9}},ExpressionUUID->"1986d385-9ed3-47d1-99a7-\
1686bfbb1d5f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExportAllCSV", "[", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "0.995", ",", "Omega", ",", "\"\<test2\>\""}],
   "]"}]], "Input",
 CellChangeTimes->{{3.7066060004739227`*^9, 3.7066060056825027`*^9}, {
  3.706610359232029*^9, 3.706610368947516*^9}, {3.706610749049761*^9, 
  3.7066107493819685`*^9}},ExpressionUUID->"db9d1d06-f5b6-4939-9fa4-\
55b64cf78cd6"],

Cell[BoxData["\<\"Completed test2 files with \
(\[ScriptS],\[ScriptL],m)=(1,1,1) for 1 spin(s) in 0h 05m 08s\"\>"], "Print",
 CellChangeTimes->{3.7066106427564025`*^9, 3.706612615088789*^9, 
  3.7066130436772327`*^9, 
  3.7066137494022436`*^9},ExpressionUUID->"f51e70d1-4f56-44bb-9057-\
f3a26563eaae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ExportAllCSV", "[", 
   RowBox[{"1", ",", "1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"0.995", ",", "0.999", ",", "0.9995", ",", "0.9999"}], "}"}], 
    ",", "Omega", ",", "\"\<precision\>\"", ",", "IncreasePrecision"}], "]"}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.706566944189598*^9, 3.706567026104581*^9}, {
   3.706567182511801*^9, 3.7065671996698713`*^9}, {3.7065672735371056`*^9, 
   3.7065672747558403`*^9}, 3.7065673775637836`*^9, {3.706569325452587*^9, 
   3.706569326796479*^9}, {3.7065695369513626`*^9, 3.706569601864396*^9}, {
   3.7065703433961515`*^9, 3.70657036772686*^9}, {3.7065709418952837`*^9, 
   3.70657096681966*^9}, {3.7065710055269003`*^9, 3.7065710065426493`*^9}, {
   3.7065710474377627`*^9, 3.7065710485941286`*^9}, {3.7065711389942064`*^9, 
   3.7065711403851347`*^9}, 3.706571205454571*^9, {3.7065749363038254`*^9, 
   3.7065749493074636`*^9}, {3.7065750002085643`*^9, 3.706575111737417*^9}, {
   3.706605958400421*^9, 3.7066059834490166`*^9}, {3.706613439289242*^9, 
   3.706613481613043*^9}},ExpressionUUID->"868ffe9c-66b8-402c-bc9c-\
b1c716488156"]
}, Open  ]]
},
WindowSize->{1920, 986},
WindowMargins->{{1911, Automatic}, {Automatic, -9}},
CellContext->Notebook,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 154, 3, 80, "Section", "ExpressionUUID" -> \
"facc684c-df56-4a09-b8b5-3aeae6cfb887"],
Cell[737, 27, 581, 13, 66, "Input", "ExpressionUUID" -> \
"6d6ee29b-a060-4559-99d4-014009e87315"],
Cell[1321, 42, 199, 4, 40, "Input", "ExpressionUUID" -> \
"b3c3c122-f34b-44f5-b41a-8acfc3b6c881"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1557, 51, 233, 4, 80, "Section", "ExpressionUUID" -> \
"8fa35250-fd08-448b-a5a9-eddb3b76c6d2"],
Cell[1793, 57, 1021, 15, 66, "Input", "ExpressionUUID" -> \
"095849e5-d626-470a-a4ae-7910c1e114aa"],
Cell[2817, 74, 1227, 19, 40, "Input", "ExpressionUUID" -> \
"c12c6fd2-5fc8-427d-a950-c21db82815c2"],
Cell[4047, 95, 2201, 55, 116, "Input", "ExpressionUUID" -> \
"7028e78c-7816-4a27-94c0-3251f994db6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6285, 155, 242, 4, 80, "Section", "ExpressionUUID" -> \
"4e5227e8-100f-4251-a9d8-296535fcbc93"],
Cell[6530, 161, 10699, 244, 652, "Input", "ExpressionUUID" -> \
"4628c533-75d7-4e4a-8f78-7b17bf99ebfc"],
Cell[17232, 407, 4147, 78, 71, "Input", "ExpressionUUID" -> \
"9d6c6f5c-c311-4998-94e8-bf68fb824698"],
Cell[21382, 487, 1002, 27, 40, "Input", "ExpressionUUID" -> \
"3d4c3d97-4518-4168-8d2a-29bad5322460"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22421, 519, 300, 5, 80, "Section", "ExpressionUUID" -> \
"2093726c-6042-449e-966d-12c658089baa",
 InitializationCell->True],
Cell[22724, 526, 1182, 24, 99, "Input", "ExpressionUUID" -> \
"399de46d-9855-4ac4-b294-14b5a051c165"],
Cell[23909, 552, 10512, 218, 499, "Input", "ExpressionUUID" -> \
"9aa09165-7d07-4ff5-9efd-84926cd5a4fa"],
Cell[CellGroupData[{
Cell[34446, 774, 1066, 31, 88, "Input", "ExpressionUUID" -> \
"06985337-9dfa-46bc-83d8-6d18ab84ab09"],
Cell[35515, 807, 361, 9, 68, "Output", "ExpressionUUID" -> \
"e7794f29-ab4d-4bdd-8f84-a39163a3853e"]
}, Open  ]],
Cell[35891, 819, 4551, 98, 173, "Input", "ExpressionUUID" -> \
"8d80de38-236e-4066-a03d-6d36b36be3df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40479, 922, 281, 4, 80, "Section", "ExpressionUUID" -> \
"2a83e9bf-31f4-429d-8b31-68c978e649e6"],
Cell[40763, 928, 443, 11, 40, "Input", "ExpressionUUID" -> \
"a48b86f6-bfaf-48c1-8c88-7e037575f035"],
Cell[41209, 941, 3880, 94, 144, "Input", "ExpressionUUID" -> \
"04c785dd-b996-41b6-b674-ce28e32a80dc"],
Cell[45092, 1037, 13109, 283, 595, "Input", "ExpressionUUID" -> \
"1986d385-9ed3-47d1-99a7-1686bfbb1d5f"],
Cell[CellGroupData[{
Cell[58226, 1324, 381, 8, 40, "Input", "ExpressionUUID" -> \
"db9d1d06-f5b6-4939-9fa4-55b64cf78cd6"],
Cell[58610, 1334, 301, 5, 29, "Print", "ExpressionUUID" -> \
"f51e70d1-4f56-44bb-9057-f3a26563eaae"]
}, Open  ]],
Cell[58926, 1342, 1134, 19, 40, "Input", "ExpressionUUID" -> \
"868ffe9c-66b8-402c-bc9c-b1c716488156"]
}, Open  ]]
}
]
*)

